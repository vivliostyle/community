# 2022-10-08

|Time (UTC)|Icon|Name|Message|
|---|---|---|---|
|00:01|![](https://avatars.slack-edge.com/2019-05-15/624511073651_25909952cd7a069ceed2_72.png)|akabeko|現在の VFM 課題まとめ<br>• remark 13 移行により実装の大幅な書き直しが必要<br>• remark 14 以降やいくつかの npm 用に ESM 移行が必要<br>• VFM を ESM 移行した場合、npm として参照している Vivliostyle プロダクト (CLI など) も ESM 移行が必要|
|00:01|![](https://avatars.slack-edge.com/2021-08-02/2324149410423_2aa7423c4133ecb9f168_72.png)|Kiara : Translation 100+ Languages|🇬🇧: Summary of Current VFM Issues<br>• remark 13 migration requires major rewrite of implementation<br>• Need ESM migration for remark 14+ and some npm<br>• If VFM is migrated to ESM, Vivliostyle products (such as CLI) referenced as npm also need to be migrated to ESM.|
|00:03|![](https://avatars.slack-edge.com/2019-05-15/624511073651_25909952cd7a069ceed2_72.png)|akabeko|remark 13 (or 14 以降) は別途検討するとして、まずは ESM 移行するのがよさそうです<br>前述のようにこれは remark とは独立して実施可能です|
|00:03|![](https://avatars.slack-edge.com/2021-08-02/2324149410423_2aa7423c4133ecb9f168_72.png)|Kiara : Translation 100+ Languages|🇬🇧: Considering remark 13 (or 14 or later) separately, it seems good to first migrate to ESM<br>As mentioned above this can be done independently of remark|
|00:12|![](https://avatars.slack-edge.com/2019-05-15/624511073651_25909952cd7a069ceed2_72.png)|akabeko|`@shinyu`<br>ここまでの前提で工数として私が実施する場合…<br>• ESM 移行は他のプロダクトを考えないのであれば人日で 5 日ほど<br>    ◦ 実際は 1 日もかからないかもしれませんが、問題発生も考慮しての見積もりです<br>    ◦ 私がフルタイムの人日をとれるのは休日のみで、他のコミュニティー活動なども含めると「工数ではなく期日」を出すのは難しいです<br>    ◦ 他プロダクトとの足並みを考慮して着手自体を見送っていました<br>• remark 13 移行は未知数<br>    ◦ 見積もりのための micromark 書き換え調査が必要です<br>    ◦ 以前、これを実施しようとして断念しています<br>    ◦ VFM 拡張構文としてコンパクトな ruby で調べるのがよいと思います<br>    ◦ ここを私以外が実施、例えば ruby の micromark 版サンプルを作っていただければ、現行実装との差分から移行工数を算出できそうです<br>    ◦ micromark 移行は最初の一歩が重く、ここを超えれば機械的な移植で済みそうという想定です<br>という感じです|
|00:12|![](https://avatars.slack-edge.com/2021-08-02/2324149410423_2aa7423c4133ecb9f168_72.png)|Kiara : Translation 100+ Languages|🇬🇧: `@shinyu`<br>If I implement it as a man-hour on the premise so far...<br>• ESM migration takes about 5 man-days if you don't consider other products<br>    ◦ It may take less than a day, but it is an estimate considering the occurrence of problems.<br>    ◦ I can only take full-time man-days on holidays, and when other community activities are included, it is difficult to give a deadline rather than a man-hour.<br>    ◦ Considering keeping pace with other products, we postponed the launch itself<br>• remark 13 migration is unknown<br>    ◦ Requires micromark rewriting survey for quote<br>    ◦ I have tried to do this before and gave up<br>    ◦ I think that it is better to check with compact ruby as VFM extended syntax<br>    ◦ If someone other than me can do this, for example, if you create a micromark version sample of ruby, it seems that you can calculate the migration man-hours from the difference with the current implementation<br>    ◦ The first step of migrating to micromark is heavy, and it is assumed that once it is over, it will be a mechanical port.<br>It feels like|
|00:13|![](https://avatars.slack-edge.com/2019-05-15/624511073651_25909952cd7a069ceed2_72.png)|akabeko|補足: この連休では現行 remark のままに section 関連の軽微な変更を実施する予定です|
|00:13|![](https://avatars.slack-edge.com/2021-08-02/2324149410423_2aa7423c4133ecb9f168_72.png)|Kiara : Translation 100+ Languages|🇬🇧: Supplement: During this consecutive holidays, we plan to carry out minor section-related changes while keeping the current remark.|
|01:42|![](https://avatars.slack-edge.com/2018-04-27/354445776386_e258f5ed5ba887b08668_72.jpg)|shinyu|`@akabeko` ありがとうございます。<br><br><blockquote>• micromark 移行は最初の一歩が重く、ここを超えれば機械的な移植で済みそうという想定です</blockquote>ということは、ESM化・micromark移行を後回しにしてVFM機能追加を先にしても、ESM化・micromark移行後にその追加した機能を移植するのは機械的にできそうなので、必ずしも二度手間にはならないということですね。<br><br>では次の2段階で移行を行うのではいかがでしょう。<br><br>V2でsection関連のVFM仕様の変更・追加（見出しの属性の扱いなどV1と非互換な変更を含む）<br><br>V3でESM化・micromark移行。VFMに依存するCLI、Vivliostyle PubなどもESM化。<br><br>V2を今年中（できれば11月のイベントで発表できるとよい）、V3を来年にでどうでしょう。|
|01:42|![](https://avatars.slack-edge.com/2021-08-02/2324149410423_2aa7423c4133ecb9f168_72.png)|Kiara : Translation 100+ Languages|🇬🇧: `@akabeko` Thank you.<br><br><blockquote>• Micromark migration is a heavy first step, and it is assumed that it will be a mechanical port after this point</blockquote>In other words, even if the ESM conversion/micromark migration is postponed and the VFM function is added first, it seems that the added function can be ported mechanically after the ESM conversion/micromark migration, so it does not necessarily have to be done twice. It doesn't mean that it won't.<br><br>So why not make the transition in two stages?<br><br>Changes/additions to section-related VFM specifications in V2 (including changes that are incompatible with V1, such as handling of heading attributes)<br><br>Converted to ESM and migrated to micromark in V3. CLI, Vivliostyle Pub, etc. that depend on VFM are also converted to ESM.<br><br>What about V2 later this year (hopefully at an event in November) and V3 next year?|
