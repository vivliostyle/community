# 2021-05-01

|Time (UTC)|Icon|Name|Message|
|---|---|---|---|
|07:55|![](https://avatars.slack-edge.com/2018-04-27/354445776386_e258f5ed5ba887b08668_72.jpg)|shinyu|`@akabeko`<br><https://github.com/vivliostyle/vfm/issues/30#issuecomment-830186656><br>について、検討お願いします。これが解決しないと vivliostyle-cli の新リリースができません。<br>あるいは、vivliostyle-cli で使用する vfm を 1.0.0-alpha.18 に戻すかですね。（vfm 1.0.0-alpha.18 まではデフォルトで katex による数式が有効でした。このまま alpha.19 または 20 にすると今まで使えた数式が使えなくなります）<br><blockquote><https://github.com/akabekobeko|@akabekobeko> <https://github.com/spring-raining|@spring-raining> (<https://github.com/vivliostyle/vivliostyle-cli/pull/182#issuecomment-829985914|vivliostyle/vivliostyle-cli#182 (comment)> に関連して)<br><br>mathをデフォルトで有効にするほうがよいのでないかと思いはじめています。<br><br>mathをデフォルトで無効にしたのは `$`...`$` が意図せず数式として扱われてしまう問題があるだろうということでしたが、pandoc と同様の `$`...`$` を数式扱いする条件が実装されたので、その問題はだいぶ解消しています。<br><br>ただし数式が使われていないHTMLでもMathJaxがロードされたり、その処理がされるのは効率的ではないので、実際にMarkdownに `$`...`$` または `$$`...`$$` の数式が出現した場合にかぎり  <br>`&lt;script async src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.9/MathJax.js?config=TeX-MML-AM_CHTML"&gt;&lt;/script&gt;`  <br>と `data-math-typeset="true"` を出力するのがよいと思います。</blockquote>|
|07:55|![](https://avatars.slack-edge.com/2021-03-01/1807880975282_5c8ad89e782096649baa_72.png)|Kiara : Language Translation Bot|🇬🇧: <br><https://github.com/vivliostyle/vfm/issues/30#issuecomment-830186656><br>Please consider about. If this is not resolved, a new release of vivliostyle-cli will not be possible.<br>Or maybe you want to revert vfm used by vivliostyle-cli back to 1.0.0-alpha.18. (Until vfm 1.0.0-alpha.18, the formula by katex was enabled by default. If you set alpha.19 or 20 as it is, the formula that you can use until now will not be usable)|
|08:57|![](https://avatars.slack-edge.com/2019-05-15/624511073651_25909952cd7a069ceed2_72.png)|akabeko|`@shinyu` Issue に見解をコメントしました|
|08:57|![](https://avatars.slack-edge.com/2021-03-01/1807880975282_5c8ad89e782096649baa_72.png)|Kiara : Language Translation Bot|🇬🇧:  Commented on Issue|
|09:35|![](https://avatars.slack-edge.com/2019-05-15/624511073651_25909952cd7a069ceed2_72.png)|akabeko|vivliostyle-cli として VFM の `math` オプションをどう扱うのか？は別途検討するとして VFM が数式をデフォルト有効にするための検討用 Issue を用意しました。ここに調査内容などを書いてゆきます。<br><br>spec: math をデフォルト有効とする · Issue #93 · vivliostyle/vfm<br><https://github.com/vivliostyle/vfm/issues/93><br><blockquote>*Goals*<br><br><https://github.com/vivliostyle/vfm/issues/37|#37> 対応により数式以外で `$` が含まれる文があっても `$5` などには反応しなくなったので `math` をデフォルト有効にしてもよいのでは？と <https://github.com/vivliostyle/vfm/issues/30|#30> にあった。<br><br><blockquote><https://github.com/akabekobeko|@akabekobeko> <https://github.com/spring-raining|@spring-raining> (<https://github.com/vivliostyle/vivliostyle-cli/pull/182#issuecomment-829985914|vivliostyle/vivliostyle-cli#182 (comment)> に関連して)<br><br>mathをデフォルトで有効にするほうがよいのでないかと思いはじめています。<br><br>mathをデフォルトで無効にしたのは `$`...`$` が意図せず数式として扱われてしまう問題があるだろうということでしたが、pandoc と同様の `$`...`$` を数式扱いする条件が実装されたので、その問題はだいぶ解消しています。<br><br>ただし数式が使われていないHTMLでもMathJaxがロードされたり、その処理がされるのは効率的ではないので、実際にMarkdownに `$`...`$` または `$$`...`$$` の数式が出現した場合にかぎり  <br>`&lt;script async src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.9/MathJax.js?config=TeX-MML-AM_CHTML"&gt;&lt;/script&gt;`  <br>と `data-math-typeset="true"` を出力するのがよいと思います。</blockquote>これを踏まえて対応を検討する。<br><br>*Prior Art*<br><br>なし<br><br>*Discussion*<br><br><https://github.com/vivliostyle/vfm/issues/30|#30> に書いた私の見解を転載。<br><br>ざっと調べたメモ。<br><br>• `math` のデフォルト有効は容易、オプションの扱いを変更するだけでよい<br>• `math` が処理された場合のみ hast 実行は難しそう<br>    • remark-parse 対応した場合の mdast は `Plugin` 型としているが、これの引数に `VFile` を取れないようだ<br>    • mdast から hast に情報伝達する手段として `VFile` を利用できない<br>    • hast の前にある handler は `VFile` を取れないようだ<br>    • グローバル変数が必要になるかもしれない<br><br>インターフェース変更して `VFile` を受け渡せるか、それともグローバル変数などの代替手段にするかを継続調査 &amp; 検討する。</blockquote>|
|09:35|![](https://avatars.slack-edge.com/2021-03-01/1807880975282_5c8ad89e782096649baa_72.png)|Kiara : Language Translation Bot|🇬🇧: How to handle VFM's `math` option as vivliostyle-cli? Has prepared an issue for consideration for VFM to enable formulas by default as a separate consideration. I will write the contents of the survey here.<br><br>spec: math is enabled by default · Issue # 93 · vivliostyle / vfm<br><https://github.com/vivliostyle/vfm/issues/93><br><blockquote>*Goals*<br><br><https://github.com/vivliostyle/vfm/issues/37|#37> 対応により数式以外で `$` が含まれる文があっても `$5` などには反応しなくなったので `math` をデフォルト有効にしてもよいのでは？と <https://github.com/vivliostyle/vfm/issues/30|#30> にあった。<br><br><blockquote><https://github.com/akabekobeko|@akabekobeko> <https://github.com/spring-raining|@spring-raining> (<https://github.com/vivliostyle/vivliostyle-cli/pull/182#issuecomment-829985914|vivliostyle/vivliostyle-cli#182 (comment)> に関連して)<br><br>mathをデフォルトで有効にするほうがよいのでないかと思いはじめています。<br><br>mathをデフォルトで無効にしたのは `$`...`$` が意図せず数式として扱われてしまう問題があるだろうということでしたが、pandoc と同様の `$`...`$` を数式扱いする条件が実装されたので、その問題はだいぶ解消しています。<br><br>ただし数式が使われていないHTMLでもMathJaxがロードされたり、その処理がされるのは効率的ではないので、実際にMarkdownに `$`...`$` または `$$`...`$$` の数式が出現した場合にかぎり  <br>`&lt;script async src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.9/MathJax.js?config=TeX-MML-AM_CHTML"&gt;&lt;/script&gt;`  <br>と `data-math-typeset="true"` を出力するのがよいと思います。</blockquote>これを踏まえて対応を検討する。<br><br>*Prior Art*<br><br>なし<br><br>*Discussion*<br><br><https://github.com/vivliostyle/vfm/issues/30|#30> に書いた私の見解を転載。<br><br>ざっと調べたメモ。<br><br>• `math` のデフォルト有効は容易、オプションの扱いを変更するだけでよい<br>• `math` が処理された場合のみ hast 実行は難しそう<br>    • remark-parse 対応した場合の mdast は `Plugin` 型としているが、これの引数に `VFile` を取れないようだ<br>    • mdast から hast に情報伝達する手段として `VFile` を利用できない<br>    • hast の前にある handler は `VFile` を取れないようだ<br>    • グローバル変数が必要になるかもしれない<br><br>インターフェース変更して `VFile` を受け渡せるか、それともグローバル変数などの代替手段にするかを継続調査 &amp; 検討する。</blockquote>|
|11:26|![](https://avatars.slack-edge.com/2019-05-15/624511073651_25909952cd7a069ceed2_72.png)|akabeko|`@shinyu`<br>既定値を有効にするのと実際に数式が処理された時のみ `&lt;script&gt;` と `&lt;body&gt;` 属性が可能なことを確認したので PR だしました。<br><br>feat: Math syntax enabled default by akabekobeko · Pull Request #94 · vivliostyle/vfm<br><https://github.com/vivliostyle/vfm/pull/94><br><blockquote><https://github.com/vivliostyle/vfm/issues/93|#93> 対応。<br><br>• `VFM` 関数の `math` オプション既定値を `false` から `true` に変更<br>• CLI オプション `--math` を `--disable-math` に変更して指定時に無効化<br>• `math: true` でも実際に数式が処理されなければ `&lt;script&gt;` と `&lt;body&gt;` 属性出力はしないように変更<br><br><https://github.com/MurakamiShinyu|@MurakamiShinyu>  <br>`docs/vfm.md` と `tests/math.ts` についてレビューをお願いします。</blockquote>|
|11:26|![](https://avatars.slack-edge.com/2021-03-01/1807880975282_5c8ad89e782096649baa_72.png)|Kiara : Language Translation Bot|🇬🇧: <br>I did PR because I confirmed that the `&amp; lt; script &amp; gt;` and `&amp; lt; body &amp; gt;` attributes are possible only when the default value is enabled and the formula is actually processed.<br><br>feat: Math syntax enabled default by akabekobeko · Pull Request # 94 · vivliostyle / vfm<br><https://github.com/vivliostyle/vfm/pull/94><br><blockquote><https://github.com/vivliostyle/vfm/issues/93|#93> 対応。<br><br>• `VFM` 関数の `math` オプション既定値を `false` から `true` に変更<br>• CLI オプション `--math` を `--disable-math` に変更して指定時に無効化<br>• `math: true` でも実際に数式が処理されなければ `&lt;script&gt;` と `&lt;body&gt;` 属性出力はしないように変更<br><br><https://github.com/MurakamiShinyu|@MurakamiShinyu>  <br>`docs/vfm.md` と `tests/math.ts` についてレビューをお願いします。</blockquote>|
|11:28|![](https://avatars.slack-edge.com/2018-04-27/354445776386_e258f5ed5ba887b08668_72.jpg)|shinyu|`@akabeko` ありがとうございます！　レビューします|
|11:28|![](https://avatars.slack-edge.com/2021-03-01/1807880975282_5c8ad89e782096649baa_72.png)|Kiara : Language Translation Bot|🇬🇧:  Thank you! Review|
