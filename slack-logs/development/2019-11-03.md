# 2019-11-03

|Time|Icon|Name|Message|
|---|---|---|---|
|01:25|![](https://avatars.slack-edge.com/2018-04-27/354445776386_e258f5ed5ba887b08668_72.jpg)|shinyu|<blockquote>For remote participants:<br>Dev meeting starts at 14:00 JST = 2019-11-03T05:00Z (UTC). Visit at Google Hangouts URL <https://hangouts.google.com/call/qY2vyl59M8KATQVw056fAEEM>.<br><br>See `#development` channel for agenda topics, and go to `#meeting-log` channel for chat and minutes (with translation bot Kiara).</blockquote>|
|01:44|![](https://avatars.slack-edge.com/2018-04-27/354445776386_e258f5ed5ba887b08668_72.jpg)|shinyu|Agenda<br>1. New participants’ self-introduction<br>2. How to build and debug Vivliostyle.js: <https://vivliostyle.slack.com/archives/CNN5GPF9V/p1570215806038000><br>3. Vivliostyle.js code reading<br>4. Development topic:<br>  - <https://github.com/vivliostyle/vivliostyle.js/issues/553><br>5. Other (your ideas welcome)<br><blockquote>Vivliostyle.js開発のメモ1</blockquote><br><blockquote>*Overview*<br><br>Vivliostyle has the original asynchronous evaluation value `Task.Result` in task.ts. I propose to replace them to <https://developer.mozilla.org/en-US/docs/Mozilla/JavaScript_code_modules/Promise.jsm/Promise|built-in Promise objects> for modern JS programmers can read the code more easily.<br><br>*Code replacement strategy*<br><br>`Task.Result` is most equivalent to Promise object but their method name is different. I break down each method of `Task.Result` and compare with code which does the same effects.<br><br>*then*<br><br><https://github.com/vivliostyle/vivliostyle.js/blob/f2c6575be70a86bff3046fd8202232029e11d88e/src/ts/vivliostyle/task.ts#L56-L60|vivliostyle.js/src/ts/vivliostyle/task.ts><br><br>Lines 56 to 60 in &lt;/vivliostyle/vivliostyle.js/commit/f2c6575be70a86bff3046fd8202232029e11d88e|f2c6575&gt;<br><br>Same as `task.then(callback)`<br><br>*thenAsync*<br><br><https://github.com/vivliostyle/vivliostyle.js/blob/f2c6575be70a86bff3046fd8202232029e11d88e/src/ts/vivliostyle/task.ts#L62-L67|vivliostyle.js/src/ts/vivliostyle/task.ts><br><br>Lines 62 to 67 in &lt;/vivliostyle/vivliostyle.js/commit/f2c6575be70a86bff3046fd8202232029e11d88e|f2c6575&gt;<br><br>Same as `task.then(callback)`<br><br>*thenReturn*<br><br><https://github.com/vivliostyle/vivliostyle.js/blob/f2c6575be70a86bff3046fd8202232029e11d88e/src/ts/vivliostyle/task.ts#L69-L74|vivliostyle.js/src/ts/vivliostyle/task.ts><br><br>Lines 69 to 74 in &lt;/vivliostyle/vivliostyle.js/commit/f2c6575be70a86bff3046fd8202232029e11d88e|f2c6575&gt;<br><br>Same as `task.then(() =&gt; result)`<br><br>*thenFinish*<br><br><https://github.com/vivliostyle/vivliostyle.js/blob/f2c6575be70a86bff3046fd8202232029e11d88e/src/ts/vivliostyle/task.ts#L76-L79|vivliostyle.js/src/ts/vivliostyle/task.ts><br><br>Lines 76 to 79 in &lt;/vivliostyle/vivliostyle.js/commit/f2c6575be70a86bff3046fd8202232029e11d88e|f2c6575&gt;<br><br>`Frame` is also class defined in task.ts. Implementations of `Task.Result` in Vivliostyle are `ResultImpl` and `SyncResultImpl`, then both method execute `frame.finish(result)`. So we can replace code to `task.then(result =&gt; frame.finish(result))` in all situations.<br><br>*isPending*<br><br><https://github.com/vivliostyle/vivliostyle.js/blob/f2c6575be70a86bff3046fd8202232029e11d88e/src/ts/vivliostyle/task.ts#L81-L84|vivliostyle.js/src/ts/vivliostyle/task.ts><br><br>Lines 81 to 84 in &lt;/vivliostyle/vivliostyle.js/commit/f2c6575be70a86bff3046fd8202232029e11d88e|f2c6575&gt;<br><br>This function is a little strange. In a naive implement, we just replace with<br><br><pre>let isPending = true;<br>task.then(() =&gt; { isPending = false });</pre><br><br>However, this code looks not good. I suppose this method should be implemented in `Frame` class rather than `Task.Result`.<br><br>*get*<br><br><https://github.com/vivliostyle/vivliostyle.js/blob/f2c6575be70a86bff3046fd8202232029e11d88e/src/ts/vivliostyle/task.ts#L86-L89|vivliostyle.js/src/ts/vivliostyle/task.ts><br><br>Lines 86 to 89 in &lt;/vivliostyle/vivliostyle.js/commit/f2c6575be70a86bff3046fd8202232029e11d88e|f2c6575&gt;<br><br>We can replace this function to `await task()` but this change may be a little hard because all functions using `get` also have to return Promise. I suppose it's also better this method is implemented in `Frame` class.</blockquote>|
|01:44|![](https://avatars.slack-edge.com/2019-08-21/732685848020_f3f20736795184660348_72.png)|Kiara Translation|🇯🇵: 議題<br>1.新規参加者の自己紹介<br>2. Vivliostyle.jsをビルドおよびデバッグする方法：<https://vivliostyle.slack.com/archives/CNN5GPF9V/p1570215806038000><br>3. Vivliostyle.jsコード読み取り<br>4.開発トピック：<br>  -<https://github.com/vivliostyle/vivliostyle.js/issues/553><br>5.その他（あなたのアイデアを歓迎します）|
|04:24|![](https://avatars.slack-edge.com/2019-05-15/624511073651_25909952cd7a069ceed2_72.png)|akabeko|<!channel> Vivliostyle 開発者会議 2 の会場に入り、設営中です。<br>参加される方はビル 1F 自動ドアの前で Slack にて `@akabeko` を呼んでください。迎えにゆきます。|
|04:24|![](https://avatars.slack-edge.com/2019-08-21/732685848020_f3f20736795184660348_72.png)|Kiara Translation|🇬🇧: &lt;! channel&gt; Vivliostyle Developer Conference 2 is now in place and is being set up.<br>If you want to join, please call at Slack in front of the automatic door on the 1st floor of the building. I will pick you up.|
|05:08|![](https://secure.gravatar.com/avatar/0479057e04d0dbef40692b5f171f60e4.jpg?s=72&d=https%3A%2F%2Fa.slack-edge.com%2Fdf10d%2Fimg%2Favatars%2Fava_0015-72.png)|takanakahiko|リモート参加させていただきます。よろしくお願いいたします！|
|05:09|![](https://avatars.slack-edge.com/2019-08-21/732685848020_f3f20736795184660348_72.png)|Kiara Translation|🇬🇧: I will participate remotely. Thank you!|
|05:10|![](https://secure.gravatar.com/avatar/b54abc5e7463fe6470c379e97e3f2477.jpg?s=72&d=https%3A%2F%2Fa.slack-edge.com%2Fdf10d%2Fimg%2Favatars%2Fava_0024-72.png)|youchan|あー。リモート参加もありでしたねー。もうすこしで着きます。|
|05:10|![](https://avatars.slack-edge.com/2019-08-21/732685848020_f3f20736795184660348_72.png)|Kiara Translation|🇬🇧: Ah. There was also remote participation. I will arrive a little more.|
|05:12|![](https://avatars.slack-edge.com/2018-04-27/354445776386_e258f5ed5ba887b08668_72.jpg)|shinyu|Visit at Google Hangouts URL: <https://hangouts.google.com/call/6kcBLb_Km9O_56DWa8l_AEEM>|
|05:12|![](https://avatars.slack-edge.com/2019-08-21/732685848020_f3f20736795184660348_72.png)|Kiara Translation|🇯🇵: GoogleハングアウトURLにアクセス：<https://hangouts.google.com/call/6kcBLb_Km9O_56DWa8l_AEEM>|
|05:13|![](https://secure.gravatar.com/avatar/0479057e04d0dbef40692b5f171f60e4.jpg?s=72&d=https%3A%2F%2Fa.slack-edge.com%2Fdf10d%2Fimg%2Favatars%2Fava_0015-72.png)|takanakahiko|ありがとうございます！あと5分程度で入ります|
|05:13|![](https://avatars.slack-edge.com/2019-08-21/732685848020_f3f20736795184660348_72.png)|Kiara Translation|🇬🇧: Thank you! Enter in about 5 minutes|
|05:14|![](https://secure.gravatar.com/avatar/b54abc5e7463fe6470c379e97e3f2477.jpg?s=72&d=https%3A%2F%2Fa.slack-edge.com%2Fdf10d%2Fimg%2Favatars%2Fava_0024-72.png)|youchan|`@akabeko` つきました|
|05:14|![](https://avatars.slack-edge.com/2019-08-21/732685848020_f3f20736795184660348_72.png)|Kiara Translation|🇬🇧:  arrived|
|06:48|![](https://secure.gravatar.com/avatar/b54abc5e7463fe6470c379e97e3f2477.jpg?s=72&d=https%3A%2F%2Fa.slack-edge.com%2Fdf10d%2Fimg%2Favatars%2Fava_0024-72.png)|youchan|`@akabeko` 戻りました|
|06:48|![](https://avatars.slack-edge.com/2019-08-21/732685848020_f3f20736795184660348_72.png)|Kiara Translation|🇬🇧:  came back|
|09:04|![](https://avatars.slack-edge.com/2018-04-27/354445776386_e258f5ed5ba887b08668_72.jpg)|shinyu|<https://vivliostyle.github.io/vivliostyle_doc/ja/vivliostyle-user-group-vol2/shinyu/index.html>|
|09:04|![](https://avatars.slack-edge.com/2019-08-21/732685848020_f3f20736795184660348_72.png)|Kiara Translation|🇬🇧: <https://vivliostyle.github.io/vivliostyle_doc/ja/vivliostyle-user-group-vol2/shinyu/index.html><br>🇯🇵: <https://vivliostyle.github.io/vivliostyle_doc/ja/vivliostyle-user-group-vol2/shinyu/index.html>|
|09:47|![](https://secure.gravatar.com/avatar/7fef90f6ef611e0cc71857ab8251f0c8.jpg?s=72&d=https%3A%2F%2Fa.slack-edge.com%2Fdf10d%2Fimg%2Favatars%2Fava_0006-72.png)|U|早速monorepoの素案を上げました。すぐに移行することを意図していません。次の大型リリースまでに結論を出せればと思います<br><br><https://github.com/vivliostyle/vivliostyle.js/issues/555><br><blockquote>*Current status*<br><br>• Though `vivliostyle.js` and `vivliostyle-ui` depend closely, the repositories are separated. It causes many errors to build both libraries.<br>• Bootstrap, build, and link can be done together in Monorepo manner<br>• Since packages are independent, `npm publish` and versioning can be done independently even though they are managed in a single repository.<br><br>By following the steps below, you can move to monorepo without losing any Git history.<br><br>*vivliostyle.js*<br><br><pre>git clone vivliostyle.js<br>cd vivliostyle.js<br>git checkout -b monorepo<br>mkdir -p packages/vivliostyle.js<br>ls -a1 | grep -v ^packages | xargs -I{} git mv {} packages/vivliostyle.js<br>git commit -m 'chore: move to monorepo'<br>git push origin monorepo<br></pre><br><br>*vivliostyle-ui*<br><br><pre>git clone vivliostyle-ui<br>cd vivliostyle-ui<br>git checkout -b monorepo<br>mkdir -p packages/vivliostyle-ui<br>ls -a1 | grep -v ^packages | xargs -I{} git mv {} packages/vivliostyle-ui<br>git commit -m 'chore: move to monorepo'<br>git push origin monorepo<br></pre><br><br>*vivliostyle (monorepo)*<br><br><pre>mkdir vivliostyle<br>cd vivliostyle<br>git init<br>git remote add vivliostyle.js vibranthq/vivliostyle.js<br>git remote add vivliostyle-ui vibranthq/vivliostyle-ui<br>git fetch --all<br>git merge vivliostyle.js/monorepo --allow-unrelated-histories<br>git merge vivliostyle-ui/monorepo --allow-unrelated-histories<br># setup lerna and yarn workspaces<br>git push origin master<br></pre><br><br>*`lerna.json`*<br><br><pre>{<br>  "packages": [<br>    "packages/*"<br>  ],<br>  "useWorkspaces": true,<br>  "npmClient": "yarn",<br>  "version": "independent"<br>}</pre><br><br>*`package.json`*<br><br><pre>{<br>	"private": true,<br>  "workspaces": [<br>    "packages/*"<br>  ]<br>}</pre><br><br>*New way to setup project*<br><br><pre>lerna bootstrap<br>lerna run build<br>lerna run build-dev<br>lerna link<br><br>cd packages/vivliostyle-ui<br>yarn serve-dev<br></pre><br><br>*References*<br><br>• <https://medium.com/@filipenevola/how-to-migrate-to-mono-repository-without-losing-any-git-history-7a4d80aa7de2|https://medium.com/@filipenevola/how-to-migrate-to-mono-repository-without-losing-any-git-history-7a4d80aa7de2></blockquote>|
|09:47|![](https://avatars.slack-edge.com/2019-08-21/732685848020_f3f20736795184660348_72.png)|Kiara Translation|🇬🇧: Immediately raised the draft of monorepo. It is not intended to migrate immediately. I hope we can conclude by the next big release<br><br><https://github.com/vivliostyle/vivliostyle.js/issues/555>|
|09:53|![](https://secure.gravatar.com/avatar/1f9e7066d4a1b6eb720fced005a15e84.jpg?s=72&d=https%3A%2F%2Fa.slack-edge.com%2Fdf10d%2Fimg%2Favatars%2Fava_0003-72.png)|kubosho_|GitHubのラベル管理は <https://github.com/rust-lang/rust/labels> や <https://github.com/servo/servo/labels> が参考になると思います。|
|09:53|![](https://avatars.slack-edge.com/2019-08-21/732685848020_f3f20736795184660348_72.png)|Kiara Translation|🇬🇧: For GitHub label management, <https://github.com/rust-lang/rust/labels> and <https://github.com/servo/servo/labels> will be helpful.|
|09:56|![](https://secure.gravatar.com/avatar/1f9e7066d4a1b6eb720fced005a15e84.jpg?s=72&d=https%3A%2F%2Fa.slack-edge.com%2Fdf10d%2Fimg%2Favatars%2Fava_0003-72.png)|kubosho_|優先度については自分が仕事で開発しているサービスでは次のようにしています。<br>* P0<br>    * Priority 0: Orders from CEO, VP, or other ultimate critical business decision<br>* P1<br>    * Priority 1: Required for MVP (Minimum Viable Product)<br>* P2<br>    * Priority 2: Required for post-MVP<br>* P3<br>    * Priority: 3: nice to fix<br>* P4<br>    * Priority 4: No priorities to work|
|09:56|![](https://avatars.slack-edge.com/2019-08-21/732685848020_f3f20736795184660348_72.png)|Kiara Translation|🇬🇧: As for the priority, the service I am developing at work is as follows.<br>* P0<br>    * Priority 0: Orders from CEO, VP, or other ultimate critical business decision<br>* P1<br>    * Priority 1: Required for MVP (Minimum Viable Product)<br>* P2<br>    * Priority 2: Required for post-MVP<br>* P3<br>    * Priority: 3: nice to fix<br>* P4<br>    * Priority 4: No priorities to work|
