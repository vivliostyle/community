# 2022-09-18

|Time (UTC)|Icon|Name|Message|
|---|---|---|---|
|01:12|![](https://avatars.slack-edge.com/2018-04-27/354445776386_e258f5ed5ba887b08668_72.jpg)|shinyu|Vivliostyle.js v2.18.0 をリリースしました。CLIに反映して、CLI v5.6.0 を準備しようと思います。<br><https://github.com/vivliostyle/vivliostyle-cli/pull/329><br><br>それから、Vivliostyle Viewerの設定パネルからトンボ出力の設定ができるようになったので、そのオプションなどをCLIに追加しようと思います。<br><blockquote><https://github.com/vivliostyle/vivliostyle.js/releases/tag/v2.18.0|https://github.com/vivliostyle/vivliostyle.js/releases/tag/v2.18.0><br><br>*Features*<br><br>• *viewer:* add crop marks setting (<https://github.com/vivliostyle/vivliostyle.js/commit/1d0834b778f41fcb65553d043d3de30a424a0aea|1d0834b>), closes <https://github.com/vivliostyle/vivliostyle.js/issues/993|#993><br>• *viewer:* change "User Style" to "Custom Style" and treat it as an author stylesheet by default (<https://github.com/vivliostyle/vivliostyle.js/commit/bdb26d474f803eb44c9f09e2489dcda668231396|bdb26d4>), closes <https://github.com/vivliostyle/vivliostyle.js/issues/991|#991><br>• *viewer:* set bookMode=true as default (<https://github.com/vivliostyle/vivliostyle.js/commit/5411264648341144997f1d60a44f218a13625b42|5411264>), closes <https://github.com/vivliostyle/vivliostyle.js/issues/992|#992><br><br>*Bug Fixes*<br><br>• error with `&lt;object&gt;` tag (<https://github.com/vivliostyle/vivliostyle.js/commit/9e9565f49288e58adcede797029c87cbc0f1236f|9e9565f>), closes <https://github.com/vivliostyle/vivliostyle.js/issues/995|#995><br>• errors on the Acid2 Browser Test (<https://github.com/vivliostyle/vivliostyle.js/commit/849a6048572f400deacfee09070247b3d8436eac|849a604>)<br>• failed some of the css-variables tests (<https://github.com/vivliostyle/vivliostyle.js/commit/5d0f3246e1c9b91af6f67427a268409848e20ed9|5d0f324>)<br>• incorrect column-rule positioning in vertical writing mode (<https://github.com/vivliostyle/vivliostyle.js/commit/3cc0e010eb0c41f9ffb7f3c4d34d214b573d5860|3cc0e01>), closes <https://github.com/vivliostyle/vivliostyle.js/issues/978|#978><br>• unnecessary page break caused by ruby elements (<https://github.com/vivliostyle/vivliostyle.js/commit/21eb17c4b1ef5c72f6695c2166c70a76aeb60373|21eb17c>), closes <https://github.com/vivliostyle/vivliostyle.js/issues/987|#987><br>• valid CSS rules ignored after parsing error with invalid or unsupported CSS rule (<https://github.com/vivliostyle/vivliostyle.js/commit/5e76ed5d49c2f4b4c06c69619df27e83429c6a54|5e76ed5>), closes <https://github.com/vivliostyle/vivliostyle.js/issues/597|#597> <https://github.com/vivliostyle/vivliostyle.js/issues/976|#976><br>• *viewer:* problem on author/user stylesheet switch ("Set as user stylesheet" checkbox) (<https://github.com/vivliostyle/vivliostyle.js/commit/2799a343a0363ac4a2b4a139738e86968c08f4b6|2799a34>)<br>• *viewer:* tweak Reset Custom Style checkbox behavior (<https://github.com/vivliostyle/vivliostyle.js/commit/9c96ccb8031f79f1a87e8c639e6dc86212bcd394|9c96ccb>)<br>• *viewer:* unbound this error "Cannot set properties of undefined" (<https://github.com/vivliostyle/vivliostyle.js/commit/2505458462692905de63f9b23afda4eb54bfc9c6|2505458>)<br>• wrong cascading on shorthand property with CSS variable (<https://github.com/vivliostyle/vivliostyle.js/commit/2ee792705c7598be7660ac590872329f2fcde17d|2ee7927>), closes <https://github.com/vivliostyle/vivliostyle.js/issues/979|#979><br>• wrong cascading with CSS !important (<https://github.com/vivliostyle/vivliostyle.js/commit/fb1dae26981827ae099e27967625c9d2abb59da3|fb1dae2>), closes <https://github.com/vivliostyle/vivliostyle.js/issues/986|#986><br>• wrong text justification at last line of page caused by consecutive ruby elements (<https://github.com/vivliostyle/vivliostyle.js/commit/ad2695206e796617f2712e5bfe4b92057fbaae27|ad26952>), closes <https://github.com/vivliostyle/vivliostyle.js/issues/985|#985></blockquote>|
|01:12|![](https://avatars.slack-edge.com/2021-08-02/2324149410423_2aa7423c4133ecb9f168_72.png)|Kiara : Translation 100+ Languages|🇬🇧: Vivliostyle.js v2.18.0 has been released. I will prepare CLI v5.6.0 by reflecting it in CLI.<br><https://github.com/vivliostyle/vivliostyle-cli/pull/329><br><br>Also, since it is now possible to set registration mark output from the setting panel of Vivliostyle Viewer, I would like to add that option to the CLI.|
|06:42|![](https://avatars.slack-edge.com/2018-04-27/354445776386_e258f5ed5ba887b08668_72.jpg)|shinyu|I found a terrible bug.<br><https://github.com/vivliostyle/vivliostyle.js/issues/1000><br>I will make bug fixed version v2.18.1 ASAP!<br><blockquote><https://github.com/vivliostyle/vivliostyle-print|vivliostyle-print> with vivliostyle.js core v2.18.0 does not work. The error "DOMException: Failed to execute 'setStart' on 'Range': There is no child at offset 20." occurs at:<br><br><https://github.com/vivliostyle/vivliostyle.js/blob/21db123c81e3e45730c50310894b2739c64153bf/packages/core/src/vivliostyle/layout-helper.ts#L143|vivliostyle.js/packages/core/src/vivliostyle/layout-helper.ts><br><br>Line 143 in &lt;/vivliostyle/vivliostyle.js/commit/21db123c81e3e45730c50310894b2739c64153bf|21db123&gt;<br><br>The `node` here is expected to be a text node, but when this error occurs the `node` is an element. However, the value of `node instanceof Element` is false. The mistake was that I changed (in <https://github.com/vivliostyle/vivliostyle.js/commit/21eb17c4b1ef5c72f6695c2166c70a76aeb60373|21eb17c>) `node.nodeType == 1` to `node instanceof Element` at:<br><br><https://github.com/vivliostyle/vivliostyle.js/blob/21db123c81e3e45730c50310894b2739c64153bf/packages/core/src/vivliostyle/layout-helper.ts#L84|vivliostyle.js/packages/core/src/vivliostyle/layout-helper.ts><br><br>Line 84 in &lt;/vivliostyle/vivliostyle.js/commit/21db123c81e3e45730c50310894b2739c64153bf|21db123&gt;<br><br>The `node instanceof Element` is not worked as expected when the node is inside iframe.<br><br>See:  <br><https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Operators/instanceof#instanceof_and_multiple_realms|https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Operators/instanceof#instanceof_and_multiple_realms></blockquote>|
|06:42|![](https://avatars.slack-edge.com/2021-08-02/2324149410423_2aa7423c4133ecb9f168_72.png)|Kiara : Translation 100+ Languages|🇯🇵: ひどいバグを見つけました。<br><https://github.com/vivliostyle/vivliostyle.js/issues/1000><br>バグ修正バージョン v2.18.1 を早急に作成します!|
|14:21|![](https://avatars.slack-edge.com/2018-04-27/354445776386_e258f5ed5ba887b08668_72.jpg)|shinyu|バグ修正できたのでv2.18.1リリースします！|
|14:21|![](https://avatars.slack-edge.com/2021-08-02/2324149410423_2aa7423c4133ecb9f168_72.png)|Kiara : Translation 100+ Languages|🇬🇧: We have fixed the bugs, so we will release v2.18.1!|
|15:52|![](https://avatars.slack-edge.com/2018-04-27/354445776386_e258f5ed5ba887b08668_72.jpg)|shinyu|<blockquote>Vivliostyle Viewerの設定パネルからトンボ出力の設定ができるようになったので、そのオプションなどをCLIに追加しようと思います。</blockquote>これについて、これから CLI へのプルリクを作ります。CLIのリリー スv5.6.0 にそれを入れられればと思います。<br><br>トンボ出力の設定（--crop-marks, --bleed, ---crop-offset）のほか、--style、--user-style で直接CSSコードを渡せるようにして、CSS変数でのカスタマイズなどがしやすいようにします。<br><br>今回はまずコマンドラインのオプションのみとして、configファイルでの設定については今後のバージョンでと考えてます。|
|15:52|![](https://avatars.slack-edge.com/2021-08-02/2324149410423_2aa7423c4133ecb9f168_72.png)|Kiara : Translation 100+ Languages|🇬🇧: &gt; Since it is now possible to set registration mark output from the setting panel of Vivliostyle Viewer, I would like to add that option to the CLI.<br>I'll make a pull request to the CLI about this. Hopefully we can get it into release v5.6.0 of the CLI.<br><br>In addition to setting crop mark output (--crop-marks, --bleed, ---crop-offset), --style, --user-style allows you to pass CSS code directly, customize with CSS variables, etc. make it easier to<br><br>This time, only command line options will be used, and settings in the config file will be considered in future versions.|
