# 2022-07-07

|Time (UTC)|Icon|Name|Message|
|---|---|---|---|
|06:14|![](https://avatars.slack-edge.com/2019-11-22/845042642576_070441337abaca9fb7b3_72.png)|ogwata|以下のコメントへの質問です。<br><https://vivliostyle.slack.com/archives/CR14JBXCJ/p1657090376238699?thread_ts=1656512350.393389&amp;cid=CR14JBXCJ><br><br><blockquote>&lt;alias …&gt;<br>  &lt;family&gt;A&lt;/family&gt;<br>  &lt;default&gt;&lt;family&gt;B&lt;/family&gt;&lt;/default&gt;<br>&lt;/alias&gt;<br>は、Aというフォントの指定があって、そのフォントが存在しなければ、Bが存在したらBに置き換えるということです。</blockquote><https://github.com/behdad/fontconfig/blob/master/conf.d/30-metric-aliases.conf|代替ルール>の中には下記のような構文もありますが、これはどういうルールなのでしょう？<br><br>```	&lt;alias binding="same"&gt;<br>	  &lt;family&gt;Arial&lt;/family&gt;<br>	  &lt;accept&gt;<br>	    &lt;family&gt;Arimo&lt;/family&gt;<br>	    &lt;family&gt;Liberation Sans&lt;/family&gt;<br>	    &lt;family&gt;Albany&lt;/family&gt;<br>	    &lt;family&gt;Albany AMT&lt;/family&gt;<br>	  &lt;/accept&gt;<br>	&lt;/alias&gt;```<br>acceptという子要素は500行くらいから多く現れます。<br>もしや、Arimo、Liberation Sans、Albany、Albany AMTがなければ、Arialに置き換えるという意味でしょうか？<br>その場合、前掲&lt;default&gt;の構文とは、関係が逆転します。<br><blockquote>```&lt;alias …&gt;<br>  &lt;family&gt;A&lt;/family&gt;<br>  &lt;default&gt;&lt;family&gt;B&lt;/family&gt;&lt;/default&gt;<br>&lt;/alias&gt;```<br>は、Aというフォントの指定があって、そのフォントが存在しなければ、Bが存在したらBに置き換えるということです。</blockquote><br><blockquote>```<br>&lt;?xml version="1.0"?&gt;<br><!DOCTYPE fontconfig SYSTEM "fonts.dtd"><br>&lt;fontconfig&gt;<br>  &lt;its:rules xmlns:its="http://www.w3.org/2005/11/its" version="1.0"&gt;<br>    &lt;its:translateRule translate="no" selector="/fontconfig/*[not(self::description)]"/&gt;<br>  &lt;/its:rules&gt;<br><br>  &lt;description&gt;Set substitutions for similar/metric-compatible families&lt;/description&gt;<br><br>&lt;!--<br><br>Alias similar/metric-compatible families from various sources:<br><br>PostScript fonts:       URW fonts:           GUST fonts:        Windows fonts:<br>======================  ==================  =================  ==================<br>Helvetica               Nimbus Sans         TeX Gyre Heros<br>Helvetica Narrow        Nimbus Sans Narrow  TeX Gyre Heros Cn<br>Times                   Nimbus Roman        TeX Gyre Termes<br>Courier                 Nimbus Mono PS      TeX Gyre Cursor<br>ITC Avant Garde Gothic  URW Gothic          TeX Gyre Adventor<br>ITC Bookman             URW Bookman         TeX Gyre Bonum     Bookman Old Style<br>ITC Zapf Chancery       Z003                TeX Gyre Chorus<br>Palatino                P052                TeX Gyre Pagella   Palatino Linotype<br>New Century Schoolbook  C059                TeX Gyre Schola    Century Schoolbook<br><br>Microsoft fonts:  Liberation fonts:       Google CrOS core fonts:  StarOffice fonts:  AMT fonts:<br>================  ======================  =======================  =================  ==============<br>Arial             Liberation Sans         Arimo                    Albany             Albany AMT<br>Arial Narrow      Liberation Sans Narrow<br>Times New Roman   Liberation Serif        Tinos                    Thorndale          Thorndale AMT<br>Courier New       Liberation Mono         Cousine                  Cumberland         Cumberland AMT<br>Cambria                                   Caladea<br>Calibri                                   Carlito<br>Symbol                                    SymbolNeu<br><br>Microsoft fonts:  Other fonts:<br>================  ============<br>Georgia           Gelasio<br><br>We want for each of them to fallback to any of these available,<br>but in an order preferring similar designs first.  We do this in three steps:<br><br>1) Alias each specific to its generic family.<br>   e.g. Liberation Sans to Arial<br><br>2) Weak alias each generic to the other generic of its family.<br>   e.g. Arial to Helvetica<br><br>3) Alias each generic to its specifics.<br>   e.g. Arial to Liberation Sans, Arimo, Albany, and Albany AMT<br><br>NOTE: The (URW)++ fonts mappings of generics to specifics were removed, because<br>      upstream now includes them in their release of (URW)++ Core Font Set here:<br>      <https://github.com/ArtifexSoftware/urw-base35-fonts/tree/master/fontconfig><br>--&gt;<br><br>&lt;!-- Map specifics to generics --&gt;<br><br>	&lt;!-- PostScript --&gt;<br>	&lt;alias binding="same"&gt;<br>	  &lt;family&gt;Nimbus Sans L&lt;/family&gt;<br>	  &lt;default&gt;<br>	  &lt;family&gt;Helvetica&lt;/family&gt;<br>	  &lt;/default&gt;<br>	&lt;/alias&gt;<br><br>	&lt;alias binding="same"&gt;<br>	  &lt;family&gt;Nimbus Sans&lt;/family&gt;<br>	  &lt;default&gt;<br>	  &lt;family&gt;Helvetica&lt;/family&gt;<br>	  &lt;/default&gt;<br>	&lt;/alias&gt;<br><br>	&lt;alias binding="same"&gt;<br>	  &lt;family&gt;TeX Gyre Heros&lt;/family&gt;<br>	  &lt;default&gt;<br>	  &lt;family&gt;Helvetica&lt;/family&gt;<br>	  &lt;/default&gt;<br>	&lt;/alias&gt;<br><br>	&lt;alias binding="same"&gt;<br>	  &lt;family&gt;Nimbus Sans Narrow&lt;/family&gt;<br>	  &lt;default&gt;<br>	  &lt;family&gt;Helvetica Narrow&lt;/family&gt;<br>	  &lt;/default&gt;<br>	&lt;/alias&gt;<br><br>	&lt;alias binding="same"&gt;<br>	  &lt;family&gt;TeX Gyre Heros Cn&lt;/family&gt;<br>	  &lt;default&gt;<br>	  &lt;family&gt;Helvetica Narrow&lt;/family&gt;<br>	  &lt;/default&gt;<br>	&lt;/alias&gt;<br><br>	&lt;alias binding="same"&gt;<br>	  &lt;family&gt;Nimbus Roman No9 L&lt;/family&gt;<br>	  &lt;default&gt;<br>	  &lt;family&gt;Times&lt;/family&gt;<br>	  &lt;/default&gt;<br>	&lt;/alias&gt;<br><br>	&lt;alias binding="same"&gt;<br>	  &lt;family&gt;Nimbus Roman&lt;/family&gt;<br>	  &lt;default&gt;<br>	  &lt;family&gt;Times&lt;/family&gt;<br>	  &lt;/default&gt;<br>	&lt;/alias&gt;<br><br>	&lt;alias binding="same"&gt;<br>	  &lt;family&gt;TeX Gyre Termes&lt;/family&gt;<br>	  &lt;default&gt;<br>	  &lt;family&gt;Times&lt;/family&gt;<br>	  &lt;/default&gt;<br>	&lt;/alias&gt;<br><br>	&lt;alias binding="same"&gt;<br>	  &lt;family&gt;Nimbus Mono L&lt;/family&gt;<br>	  &lt;default&gt;<br>	  &lt;family&gt;Courier&lt;/family&gt;<br>	  &lt;/default&gt;<br>	&lt;/alias&gt;<br><br>	&lt;alias binding="same"&gt;<br>	  &lt;family&gt;Nimbus Mono&lt;/family&gt;<br>	  &lt;default&gt;<br>	  &lt;family&gt;Courier&lt;/family&gt;<br>	  &lt;/default&gt;<br>	&lt;/alias&gt;<br><br>	&lt;alias binding="same"&gt;<br>	  &lt;family&gt;Nimbus Mono PS&lt;/family&gt;<br>	  &lt;default&gt;<br>	  &lt;family&gt;Courier&lt;/family&gt;<br>	  &lt;/default&gt;<br>	&lt;/alias&gt;<br><br>	&lt;alias binding="same"&gt;<br>	  &lt;family&gt;TeX Gyre Cursor&lt;/family&gt;<br>	  &lt;default&gt;<br>	  &lt;family&gt;Courier&lt;/family&gt;<br>	  &lt;/default&gt;<br>	&lt;/alias&gt;<br><br>	&lt;alias binding="same"&gt;<br>	  &lt;family&gt;Avant Garde&lt;/family&gt;<br>	  &lt;default&gt;<br>	  &lt;family&gt;ITC Avant Garde Gothic&lt;/family&gt;<br>	  &lt;/default&gt;<br>	&lt;/alias&gt;<br><br>	&lt;alias binding="same"&gt;<br>	  &lt;family&gt;URW Gothic L&lt;/family&gt;<br>	  &lt;default&gt;<br>	  &lt;family&gt;ITC Avant Garde Gothic&lt;/family&gt;<br>	  &lt;/default&gt;<br>	&lt;/alias&gt;<br><br>	&lt;alias binding="same"&gt;<br>	  &lt;family&gt;URW Gothic&lt;/family&gt;<br>	  &lt;default&gt;<br>	  &lt;family&gt;ITC Avant Garde Gothic&lt;/family&gt;<br>	  &lt;/default&gt;<br>	&lt;/alias&gt;<br><br>	&lt;alias binding="same"&gt;<br>	  &lt;family&gt;TeX Gyre Adventor&lt;/family&gt;<br>	  &lt;default&gt;<br>	  &lt;family&gt;ITC Avant Garde Gothic&lt;/family&gt;<br>	  &lt;/default&gt;<br>	&lt;/alias&gt;<br><br>	&lt;alias binding="same"&gt;<br>	  &lt;family&gt;Bookman&lt;/family&gt;<br>	  &lt;default&gt;<br>	  &lt;family&gt;ITC Bookman&lt;/family&gt;<br>	  &lt;/default&gt;<br>	&lt;/alias&gt;<br><br>	&lt;alias binding="same"&gt;<br>	  &lt;family&gt;URW Bookman L&lt;/family&gt;<br>	  &lt;default&gt;<br>	  &lt;family&gt;ITC Bookman&lt;/family&gt;<br>	  &lt;/default&gt;<br>	&lt;/alias&gt;<br><br>	&lt;alias binding="same"&gt;<br>	  &lt;family&gt;Bookman URW&lt;/family&gt;<br>	  &lt;default&gt;<br>	  &lt;family&gt;ITC Bookman&lt;/family&gt;<br>	  &lt;/default&gt;<br>	&lt;/alias&gt;<br><br>	&lt;alias binding="same"&gt;<br>	  &lt;family&gt;URW Bookman&lt;/family&gt;<br>	  &lt;default&gt;<br>	  &lt;family&gt;ITC Bookman&lt;/family&gt;<br>	  &lt;/default&gt;<br>	&lt;/alias&gt;<br><br>	&lt;alias binding="same"&gt;<br>	  &lt;family&gt;TeX Gyre Bonum&lt;/family&gt;<br>	  &lt;default&gt;<br>	  &lt;family&gt;ITC Bookman&lt;/family&gt;<br>	  &lt;/default&gt;<br>	&lt;/alias&gt;<br><br>	&lt;alias binding="same"&gt;<br>	  &lt;family&gt;Bookman Old Style&lt;/family&gt;<br>	  &lt;default&gt;<br>	  &lt;family&gt;ITC Bookman&lt;/family&gt;<br>	  &lt;/default&gt;<br>	&lt;/alias&gt;<br><br>	&lt;alias binding="same"&gt;<br>	  &lt;family&gt;Zapf Chancery&lt;/family&gt;<br>	  &lt;default&gt;<br>	  &lt;family&gt;ITC Zapf Chancery&lt;/family&gt;<br>	  &lt;/default&gt;<br>	&lt;/alias&gt;<br><br>	&lt;alias binding="same"&gt;<br>	  &lt;family&gt;URW Chancery L&lt;/family&gt;<br>	  &lt;default&gt;<br>	  &lt;family&gt;ITC Zapf Chancery&lt;/family&gt;<br>	  &lt;/default&gt;<br>	&lt;/alias&gt;<br><br>	&lt;alias binding="same"&gt;<br>	  &lt;family&gt;Chancery URW&lt;/family&gt;<br>	  &lt;default&gt;<br>	  &lt;family&gt;ITC Zapf Chancery&lt;/family&gt;<br>	  &lt;/default&gt;<br>	&lt;/alias&gt;<br><br>	&lt;alias binding="same"&gt;<br>	  &lt;family&gt;Z003&lt;/family&gt;<br>	  &lt;default&gt;<br>	  &lt;family&gt;ITC Zapf Chancery&lt;/family&gt;<br>	  &lt;/default&gt;<br>	&lt;/alias&gt;<br><br>	&lt;alias binding="same"&gt;<br>	  &lt;family&gt;TeX Gyre Chorus&lt;/family&gt;<br>	  &lt;default&gt;<br>	  &lt;family&gt;ITC Zapf Chancery&lt;/family&gt;<br>	  &lt;/default&gt;<br>	&lt;/alias&gt;<br><br>	&lt;alias binding="same"&gt;<br>	  &lt;family&gt;URW Palladio L&lt;/family&gt;<br>	  &lt;default&gt;<br>	  &lt;family&gt;Palatino&lt;/family&gt;<br>	  &lt;/default&gt;<br>	&lt;/alias&gt;<br><br>	&lt;alias binding="same"&gt;<br>	  &lt;family&gt;Palladio URW&lt;/family&gt;<br>	  &lt;default&gt;<br>	  &lt;family&gt;Palatino&lt;/family&gt;<br>	  &lt;/default&gt;<br>	&lt;/alias&gt;<br><br>	&lt;alias binding="same"&gt;<br>	  &lt;family&gt;P052&lt;/family&gt;<br>	  &lt;default&gt;<br>	  &lt;family&gt;Palatino&…</blockquote>|
|06:14|![](https://avatars.slack-edge.com/2021-08-02/2324149410423_2aa7423c4133ecb9f168_72.png)|Kiara : Translation 100+ Languages|🇬🇧: I have a question for the following comments.<br><https://vivliostyle.slack.com/archives/CR14JBXCJ/p1657090376238699?thread_ts=1656512350.393389&amp;cid=CR14JBXCJ><br><br>&amp; gt; &amp; lt; alias… &amp; gt;<br>&amp; gt; &amp; lt; family &amp; gt; A &amp; lt; / family &amp; gt;<br>&amp; gt; &amp; lt; default &amp; gt; &amp; lt; family &amp; gt; B &amp; lt; / family &amp; gt; &amp; lt; / default &amp; gt;<br>&amp; gt; &amp; lt; / alias &amp; gt;<br>&amp; gt; means that if there is a font specified as A and that font does not exist, then if B exists, it will be replaced with B.<br><https://github.com/behdad/fontconfig/blob/master/conf.d/30-metric-aliases.conf | Alternate rule> also has the following syntax, but what kind of rule is this? prize?<br><br>`` `&amp; lt; alias binding =" same "&amp; gt;<br>&amp; lt; family &amp; gt; Arial &amp; lt; / family &amp; gt;<br>&amp; lt; accept &amp; gt;<br>&amp; lt; family &amp; gt; Arimo &amp; lt; / family &amp; gt;<br>&amp; lt; family &amp; gt; Liberation Sans &amp; lt; / family &amp; gt;<br>&amp; lt; family &amp; gt; Albany &amp; lt; / family &amp; gt;<br>&amp; lt; family &amp; gt; Albany AMT &amp; lt; / family &amp; gt;<br>&amp; lt; / accept &amp; gt;<br>&amp; lt; / alias &amp; gt; `` ``<br>Many child elements called accept appear from about 500 lines.<br>If you don't have Arimo, Liberation Sans, Albany, Albany AMT, does that mean replace it with Arial?<br>In that case, the relationship is reversed from the above-mentioned &amp; lt; default &amp; gt; syntax.|
|06:23|![](https://avatars.slack-edge.com/2018-04-27/354445776386_e258f5ed5ba887b08668_72.jpg)|shinyu|<blockquote>もしや、Arimo、Liberation Sans、Albany、Albany AMTがなければ、Arialに置き換えるという意味でしょうか？</blockquote>いいえ、違います。<br><br>font-family: "Arial" が指定されたとき、Arial がなければ Arimo、Liberation Sans、Albany... のうち見つかったフォントにフォールバックするという意味です。<br><br>`&lt;default&gt;` と `&lt;accept&gt;` の違いなどは、複雑なので気にしない方がよいでしょう。|
|06:23|![](https://avatars.slack-edge.com/2021-08-02/2324149410423_2aa7423c4133ecb9f168_72.png)|Kiara : Translation 100+ Languages|🇬🇧: &amp; gt; If you don't have Arimo, Liberation Sans, Albany, Albany AMT, does that mean replace it with Arial?<br>No, it's not.<br><br>font-family: When "Arial" is specified, it means to fall back to the font found in Arimo, Liberation Sans, Albany ... without Arial.<br><br>The difference between `&amp; lt; default &amp; gt;` and `&amp; lt; accept &amp; gt;` is complicated and should not be bothered.|
|06:24|![](https://avatars.slack-edge.com/2018-04-27/354445776386_e258f5ed5ba887b08668_72.jpg)|shinyu|fontconfigのマニュアルは<br><https://www.freedesktop.org/software/fontconfig/fontconfig-user.html><br>にありますが、難解です。|
|06:24|![](https://avatars.slack-edge.com/2021-08-02/2324149410423_2aa7423c4133ecb9f168_72.png)|Kiara : Translation 100+ Languages|🇬🇧: The fontconfig manual is<br><https://www.freedesktop.org/software/fontconfig/fontconfig-user.html><br>It's in, but it's esoteric.|
|07:09|![](https://avatars.slack-edge.com/2019-11-22/845042642576_070441337abaca9fb7b3_72.png)|ogwata|回答感謝です。もう一つ質問。<br>代替するフォントがこのルールにない場合、どこにフォールバックするのでしょう？<br>なにかしら `font-family:  sans-serif;` のような、最後のフォールバック先があるのではと想像したのですが。|
|07:09|![](https://avatars.slack-edge.com/2021-08-02/2324149410423_2aa7423c4133ecb9f168_72.png)|Kiara : Translation 100+ Languages|🇬🇧: Thank you for your answer. Another question.<br>Where would it fall back if there was no alternative font in this rule?<br>I imagined that there would be a final fallback destination, such as `font-family: sans-serif;`.|
|07:22|![](https://avatars.slack-edge.com/2018-04-27/354445776386_e258f5ed5ba887b08668_72.jpg)|shinyu|単に、知らない存在しないフォントということなので、無視されます。<br>font-family: AAAA; という指定で フォント AAAA がなければ、デフォルトのフォント(欧文ならserif)になります。|
|07:22|![](https://avatars.slack-edge.com/2021-08-02/2324149410423_2aa7423c4133ecb9f168_72.png)|Kiara : Translation 100+ Languages|🇬🇧: It's just an unknown, non-existent font, so it's ignored.<br>If font-family: AAAA; is specified and there is no font AAAA, it will be the default font (serif in Western languages).|
|07:34|![](https://avatars.slack-edge.com/2019-11-22/845042642576_070441337abaca9fb7b3_72.png)|ogwata|ありがとうございます。<br>ルール間の優先順序は、以下のようなものでよろしいでしょうか？<br><br>1. fc-list.sorted.txt<br>2. *30-metric-aliases.conf*<br>3. <https://github.com/vivliostyle/vivliostyle-cli/blob/a431a2ac8eba1941459f2768bc025dd869fa1952/Dockerfile#L32-L49|vivliostyle-cli/Dockerfile><br>4. デフォルトのフォント(欧文ならserif)<br><blockquote><pre>&lt;fontconfig&gt;\<br>  &lt;alias&gt;&lt;family&gt;Source Han Serif&lt;/family&gt;&lt;prefer&gt;&lt;family&gt;Noto Serif CJK JP&lt;/family&gt;&lt;/prefer&gt;&lt;/alias&gt;\<br>  &lt;alias&gt;&lt;family&gt;Hiragino Mincho ProN&lt;/family&gt;&lt;prefer&gt;&lt;family&gt;Noto Serif CJK JP&lt;/family&gt;&lt;/prefer&gt;&lt;/alias&gt;\<br>  &lt;alias&gt;&lt;family&gt;Hiragino Mincho Pro&lt;/family&gt;&lt;prefer&gt;&lt;family&gt;Noto Serif CJK JP&lt;/family&gt;&lt;/prefer&gt;&lt;/alias&gt;\<br>  &lt;alias&gt;&lt;family&gt;YuMincho&lt;/family&gt;&lt;prefer&gt;&lt;family&gt;Noto Serif CJK JP&lt;/family&gt;&lt;/prefer&gt;&lt;/alias&gt;\<br>  &lt;alias&gt;&lt;family&gt;Yu Mincho&lt;/family&gt;&lt;prefer&gt;&lt;family&gt;Noto Serif CJK JP&lt;/family&gt;&lt;/prefer&gt;&lt;/alias&gt;\<br>  &lt;alias&gt;&lt;family&gt;MS Mincho&lt;/family&gt;&lt;prefer&gt;&lt;family&gt;Noto Serif CJK JP&lt;/family&gt;&lt;/prefer&gt;&lt;/alias&gt;\<br>  &lt;alias&gt;&lt;family&gt;MS PMincho&lt;/family&gt;&lt;prefer&gt;&lt;family&gt;Noto Serif CJK JP&lt;/family&gt;&lt;/prefer&gt;&lt;/alias&gt;\<br>  &lt;alias&gt;&lt;family&gt;Source Han Sans&lt;/family&gt;&lt;prefer&gt;&lt;family&gt;Noto Sans CJK JP&lt;/family&gt;&lt;/prefer&gt;&lt;/alias&gt;\<br>  &lt;alias&gt;&lt;family&gt;Hiragino Sans&lt;/family&gt;&lt;prefer&gt;&lt;family&gt;Noto Sans CJK JP&lt;/family&gt;&lt;/prefer&gt;&lt;/alias&gt;\<br>  &lt;alias&gt;&lt;family&gt;Hiragino Kaku Gothic ProN&lt;/family&gt;&lt;prefer&gt;&lt;family&gt;Noto Sans CJK JP&lt;/family&gt;&lt;/prefer&gt;&lt;/alias&gt;\<br>  &lt;alias&gt;&lt;family&gt;Hiragino Kaku Gothic Pro&lt;/family&gt;&lt;prefer&gt;&lt;family&gt;Noto Sans CJK JP&lt;/family&gt;&lt;/prefer&gt;&lt;/alias&gt;\<br>  &lt;alias&gt;&lt;family&gt;YuGothic&lt;/family&gt;&lt;prefer&gt;&lt;family&gt;Noto Sans CJK JP&lt;/family&gt;&lt;/prefer&gt;&lt;/alias&gt;\<br>  &lt;alias&gt;&lt;family&gt;Yu Gothic&lt;/family&gt;&lt;prefer&gt;&lt;family&gt;Noto Sans CJK JP&lt;/family&gt;&lt;/prefer&gt;&lt;/alias&gt;\<br>  &lt;alias&gt;&lt;family&gt;Meiryo&lt;/family&gt;&lt;prefer&gt;&lt;family&gt;Noto Sans CJK JP&lt;/family&gt;&lt;/prefer&gt;&lt;/alias&gt;\<br>  &lt;alias&gt;&lt;family&gt;MS Gothic&lt;/family&gt;&lt;prefer&gt;&lt;family&gt;Noto Sans CJK JP&lt;/family&gt;&lt;/prefer&gt;&lt;/alias&gt;\<br>  &lt;alias&gt;&lt;family&gt;MS PGothic&lt;/family&gt;&lt;prefer&gt;&lt;family&gt;Noto Sans CJK JP&lt;/family&gt;&lt;/prefer&gt;&lt;/alias&gt;\<br>&lt;/fontconfig&gt;' &gt; /etc/fonts/local.conf \</pre></blockquote>|
|07:34|![](https://avatars.slack-edge.com/2021-08-02/2324149410423_2aa7423c4133ecb9f168_72.png)|Kiara : Translation 100+ Languages|🇬🇧: Thank you.<br>Is it okay if the priority order between the rules is as follows?<br><br>1. fc-list.sorted.txt<br>2. * 30-metric-aliases.conf *<br>3. <https://github.com/vivliostyle/vivliostyle-cli/blob/a431a2ac8eba1941459f2768bc025dd869fa1952/Dockerfile#L32-L49|vivliostyle-cli/Dockerfile><br>4. Default font (serif for Western languages)|
|07:40|![](https://avatars.slack-edge.com/2018-04-27/354445776386_e258f5ed5ba887b08668_72.jpg)|shinyu|1は「指定されたフォントが存在したらそのフォントが使われる」という意味ですね。|
|07:40|![](https://avatars.slack-edge.com/2021-08-02/2324149410423_2aa7423c4133ecb9f168_72.png)|Kiara : Translation 100+ Languages|🇬🇧: 1 means "if the specified font exists, that font will be used".|
|07:41|![](https://avatars.slack-edge.com/2019-11-22/845042642576_070441337abaca9fb7b3_72.png)|ogwata|矢継ぎ早ですいません。デフォルトフォントについて質問です。<br><br>たとえば、IPA明朝が指定された場合、1〜3のいずれにもないので、デフォルトフォントに置き換わるということだと思いますが、そのデフォルトフォントはどこで決めているのでしょう？|
|07:41|![](https://avatars.slack-edge.com/2021-08-02/2324149410423_2aa7423c4133ecb9f168_72.png)|Kiara : Translation 100+ Languages|🇬🇧: I'm sorry for the rapid succession. I have a question about the default font.<br><br>For example, if IPA Mincho is specified, it will be replaced with the default font because none of 1 to 3 is specified. Where do you decide the default font?|
|07:43|![](https://avatars.slack-edge.com/2018-04-27/354445776386_e258f5ed5ba887b08668_72.jpg)|shinyu|30-metric-aliases.conf の紹介は複雑すぎるでしょう。実際に意味があるのは、次のものだけです。<br><br>Times → Times New Roman<br>Helvetica → Arial<br>Courier → Courier New|
|07:43|![](https://avatars.slack-edge.com/2021-08-02/2324149410423_2aa7423c4133ecb9f168_72.png)|Kiara : Translation 100+ Languages|🇬🇧: Introducing 30-metric-aliases.conf would be too complicated. The only things that really make sense are:<br><br>Times → Times New Roman<br>Helvetica → Arial<br>Courier → Courier New|
|07:46|![](https://avatars.slack-edge.com/2019-11-22/845042642576_070441337abaca9fb7b3_72.png)|ogwata|<blockquote>実際に意味があるのは、次のものだけです。<br>Times → Times New Roman<br>Helvetica → Arial<br>Courier → Courier New</blockquote> 了解です。30-metric-aliases.conf のうち、fc-list.sorted.txt にあるものを抽出したのですが、あまり聞かないフォントが多いので、この3つに絞ってしまってよさそう。|
|07:46|![](https://avatars.slack-edge.com/2021-08-02/2324149410423_2aa7423c4133ecb9f168_72.png)|Kiara : Translation 100+ Languages|🇬🇧: &amp; gt; The only things that really make sense are:<br>&amp; gt; Times → Times New Roman<br>&amp; gt; Helvetica → Arial<br>&amp; gt; Courier → Courier New<br> I got it. I extracted the ones in fc-list.sorted.txt from 30-metric-aliases.conf, but there are many fonts that I don't often hear, so I think it's okay to narrow down to these three.|
|07:47|![](https://avatars.slack-edge.com/2018-04-27/354445776386_e258f5ed5ba887b08668_72.jpg)|shinyu|<blockquote> たとえば、IPA明朝が指定された場合、1〜3のいずれにもないので、デフォルトフォントに置き換わるということだと思いますが、そのデフォルトフォントはどこで決めているのでしょう？ </blockquote><https://github.com/vivliostyle/vivliostyle-cli/issues/303#issuecomment-1169483493><br>のテストの generic-fonts--noto.pdf を見ると、何も指定しないときのデフォルトは serif と同じになります。serifは欧文は Times New Roman で、漢字仮名文字は Noto Sans CJK JP になります（Serifになってくれない問題があるのに注意）。<br><blockquote>*テスト用サンプルとテスト結果*<br><br>「変更後 (IPAexフォント使用)」のテストは、pull request <https://github.com/vivliostyle/vivliostyle-cli/pull/304|#304> での変更を反映した Docker イメージを使ったもの。この変更では <https://packages.ubuntu.com/focal/ttf-mscorefonts-installer|Microsoft TrueType Core Fonts> も組み込んでいるので欧文フォントも変更前の Liberation フォントから Times New Roman や Arial などのフォントに変わっている。  <br>「変更後 (Noto CJKフォント使用)」のテストは、Noto CJKフォントを組み込むようにした Docker イメージを使ったもの（ <https://github.com/vivliostyle/vivliostyle-cli/pull/304#issuecomment-1169449026|pull request #304> のコメント参照）<br><br>• 「ごん狐」 <https://vivliostyle.github.io/vivliostyle_doc/samples/gon/index.html|https://vivliostyle.github.io/vivliostyle_doc/samples/gon/index.html><br>    • 結果PDF:<br>        • 変更前 (v5.1.0): <https://github.com/vivliostyle/vivliostyle-cli/files/9006871/gon--a.pdf|gon--a.pdf><br>        • 変更後 (IPAexフォント使用): <https://github.com/vivliostyle/vivliostyle-cli/files/9006875/gon--ipaex.pdf|gon--ipaex.pdf><br>        • 変更後 (Noto CJKフォント使用): <https://github.com/vivliostyle/vivliostyle-cli/files/9006879/gon--noto.pdf|gon--noto.pdf><br>    • これらについては、前のコメント <https://github.com/vivliostyle/vivliostyle-cli/issues/303#issue-1281833662|#303 (comment)> 、<https://github.com/vivliostyle/vivliostyle-cli/issues/303#issuecomment-1168884694|#303 (comment)> のとおり<br>• Generic Fontsテスト <https://murakamishinyu.github.io/bugtest/stdfonts/generic-fonts.html|https://murakamishinyu.github.io/bugtest/stdfonts/generic-fonts.html><br>    • 結果PDF:<br>        • 変更前 (v5.1.0): <https://github.com/vivliostyle/vivliostyle-cli/files/9006880/generic-fonts--a.pdf|generic-fonts--a.pdf><br>        • 変更後 (IPAexフォント使用): <https://github.com/vivliostyle/vivliostyle-cli/files/9006881/generic-fonts--ipaex.pdf|generic-fonts--ipaex.pdf><br>        • 変更後 (Noto CJKフォント使用): <https://github.com/vivliostyle/vivliostyle-cli/files/9006883/generic-fonts--noto.pdf|generic-fonts--noto.pdf><br>    • 欧文のフォントは変更前は Liberation Serif や Liberation Sans だったのが、変更後は Microsoft TrueType Core Fonts の Times New Roman や Arial フォントになった。font-family: monospace のフォントは Andale Mono になった。font-family: cursive のフォントは Comic Sans MS になった。font-family: fantasy のフォントは Impact になった。<br>    • 日本語テキストに対するフォントは、「IPAexフォント使用」の場合、変更前も変更後も WenQuanYiZenHei のまま。このサンプルではHTML全体の言語指定はなしで段落要素pに言語指定をしているが、どうもそれが効果がないようだ。「Noto CJKフォント使用」の場合は Noto Sans CJK になり、言語指定によって字体が変わっている。ただし、font-family: serif に対して明朝体のフォントになってくれない問題はあり（その理由は<https://github.com/vivliostyle/vivliostyle-cli/issues/303#issuecomment-1169786479|後述>）。<br>• Core Fontsテスト <https://murakamishinyu.github.io/bugtest/stdfonts/core-fonts.html|https://murakamishinyu.github.io/bugtest/stdfonts/core-fonts.html><br>    • 結果PDF:<br>        • 変更前 (v5.1.0): <https://github.com/vivliostyle/vivliostyle-cli/files/9006886/core-fonts--a.pdf|core-fonts--a.pdf><br>        • 変更後 (IPAexフォント使用): <https://github.com/vivliostyle/vivliostyle-cli/files/9006887/core-fonts--ipaex.pdf|core-fonts--ipaex.pdf><br>        • 変更後 (Noto CJKフォント使用): <https://github.com/vivliostyle/vivliostyle-cli/files/9006888/core-fonts--noto.pdf|core-fonts--noto.pdf><br>    • Microsoft TrueType Core Fonts の各フォントに加えて Times や Helvetica や Courier の指定を場合もテストした。Times、Helvetica、Courier はそれぞれ Times New Roman、Arial、Courier New に置き換わる。font-family: monospace の指定では Courier New ではなく Andale Mono になる。<br>    • 日本語テキストに対するフォントは、Generic Fontsテストの場合と同様。<br>• Core Fontsテスト、lang=ja指定あり <https://murakamishinyu.github.io/bugtest/stdfonts/core-fonts-ja.html|https://murakamishinyu.github.io/bugtest/stdfonts/core-fonts-ja.html><br>    • 結果PDF:<br>        • 変更前 (v5.1.0): <https://github.com/vivliostyle/vivliostyle-cli/files/9006891/core-fonts-ja--a.pdf|core-fonts-ja--a.pdf><br>        • 変更後 (IPAexフォント使用): <https://github.com/vivliostyle/vivliostyle-cli/files/9006893/core-fonts-ja--ipaex.pdf|core-fonts-ja--ipaex.pdf><br>        • 変更後 (Noto CJKフォント使用): <https://github.com/vivliostyle/vivliostyle-cli/files/9006894/core-fonts-ja--noto.pdf|core-fonts-ja--noto.pdf><br>    • このテストは言語指定 lang=ja がHTMLのルート要素にある以外は前のCore Fontsテストと同じ。日本語テキストに対するフォントが、変更後 (IPAexフォント使用) では IPAexGothic フォントに、変更後 (Noto CJKフォント使用) では Noto Sans CJK JP フォントになった。<br><br>* * *<br><br>*Update:*  <br>IPAexではなくNoto CJKフォントに変更することにした：<br><br>• <https://github.com/vivliostyle/vivliostyle-cli/pull/304#issuecomment-1169558841|#304 (comment)><br><br><blockquote>ルビの表示の不具合については <https://github.com/vivliostyle/vivliostyle.js/issues/896#issuecomment-1164121593|vivliostyle/vivliostyle.js#896 (comment)> にある `--enable-blink-features=LayoutNGPrinting` を使うことで、いまの Chromium でもこの問題を解決できるかもしれない。そうなると Noto CJK フォントのほうがよさそう。</blockquote></blockquote>|
|07:47|![](https://avatars.slack-edge.com/2021-08-02/2324149410423_2aa7423c4133ecb9f168_72.png)|Kiara : Translation 100+ Languages|🇬🇧: &amp; gt; For example, if IPA Mincho is specified, it will be replaced with the default font because it is not in any of 1 to 3, but where do you decide the default font?<br><https://github.com/vivliostyle/vivliostyle-cli/issues/303#issuecomment-1169483493><br>Looking at the generic-fonts--noto.pdf of the test, the default when nothing is specified is the same as serif. Serif is Times New Roman in European languages, and Noto Sans CJK JP is used for Chinese characters and kana characters (note that there is a problem that serif is not used).|
|07:49|![](https://avatars.slack-edge.com/2018-04-27/354445776386_e258f5ed5ba887b08668_72.jpg)|shinyu|<blockquote>この3つに絞ってしまってよさそう。</blockquote>ちなみに、Windowsでも同じような代替フォントのしくみがあって、<br>Times → Times New Roman<br>Helvetica → Arial<br>Courier → Courier New<br>となってます。|
|07:49|![](https://avatars.slack-edge.com/2021-08-02/2324149410423_2aa7423c4133ecb9f168_72.png)|Kiara : Translation 100+ Languages|🇬🇧: &amp; gt; It looks good to narrow down to these three.<br>By the way, there is a similar alternative font mechanism in Windows,<br>Times → Times New Roman<br>Helvetica → Arial<br>Courier → Courier New<br>It has become.|
|07:50|![](https://avatars.slack-edge.com/2019-11-22/845042642576_070441337abaca9fb7b3_72.png)|ogwata|なるほど、Windows と互換がとれているんですね。|
|07:50|![](https://avatars.slack-edge.com/2021-08-02/2324149410423_2aa7423c4133ecb9f168_72.png)|Kiara : Translation 100+ Languages|🇬🇧: I see, it's compatible with Windows.|
