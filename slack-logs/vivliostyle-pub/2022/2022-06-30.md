# 2022-06-30

|Time (UTC)|Icon|Name|Message|
|---|---|---|---|
|03:50|![](https://avatars.slack-edge.com/2019-11-22/845042642576_070441337abaca9fb7b3_72.png)|ogwata|ありがとうございます。<br><br><blockquote>現状のVivliostyle Pubでは、vivliostyle.config.js の `theme:` の指定は拡張子 `.css` のファイルへのパスの指定以外は処理できずエラーになる問題があります（PDF出力以前に、プレビューもできません）。</blockquote>なるほど、そういうことでしたか。<br>これはIssueになっているのでしょうか？　PubのIssueで見つけられませんでした。<br><br><blockquote>なおVivliostyle Pubでの「Plain theme」というのは単にthemeの指定がない場合のことなので、PDF出力に問題ありません。</blockquote>これは「PDF出力はできない」という意味ですね？|
|03:50|![](https://avatars.slack-edge.com/2021-08-02/2324149410423_2aa7423c4133ecb9f168_72.png)|Kiara : Translation 100+ Languages|🇬🇧: Thank you.<br><br>&amp; gt; In the current Vivliostyle Pub, there is a problem that the specification of `theme:` in vivliostyle.config.js can only be processed by specifying the path to the file with the extension `.css`, resulting in an error (before PDF output). , Preview is not possible).<br>I see, was that so?<br>Is this an Issue? I couldn't find it in Pub Issue.<br><br>&amp; gt; Note that the "Plain theme" in Vivliostyle Pub simply means that the theme is not specified, so there is no problem with PDF output.<br>Does this mean "PDF output is not possible"?|
|04:08|![](https://avatars.slack-edge.com/2018-04-27/354445776386_e258f5ed5ba887b08668_72.jpg)|shinyu|Issue未登録なので登録します。<br><br>theme指定なしの場合、PDF出力に問題ありませんと書いたとおり、PDF出力ができるということです。|
|04:08|![](https://avatars.slack-edge.com/2021-08-02/2324149410423_2aa7423c4133ecb9f168_72.png)|Kiara : Translation 100+ Languages|🇬🇧: Issue is not registered, so register it.<br><br>If you do not specify the theme, you can output PDF as I wrote that there is no problem with PDF output.|
|06:45|![](https://avatars.slack-edge.com/2019-11-22/845042642576_070441337abaca9fb7b3_72.png)|ogwata|お答え感謝です。<br><blockquote>なおVivliostyle Pubでの「Plain theme」というのは単にthemeの指定がない場合のことなので、PDF出力に問題ありません。</blockquote>-------<br><blockquote>theme指定なしの場合、PDF出力に問題ありませんと書いたとおり、PDF出力ができるということです。</blockquote>すいません、この部分の意味がよく理解できません。<br><br>ユーザリポジトリにあるvivliostyle.config.jsで、`theme: '',` と指定してPDF出力をしてみましたが、いつまでたってもビルドが終了しません。<br><br>ということは、村上さんの言う「theme指定なし」は、比喩的な意味で言われている（つまりユーザリポジトリのconfigではない）ように思います。<br><br>しかし、Actionメニューの「Plain theme」は、プレビューだけの設定であり、PDF出力は無関係ではないでしょうか？<br><br>というのは「Export」では、無条件にvivliostyle.config.js にもとづいて処理するからです。<br><br>ですので、「Plain theme」を選択していた場合でも、PDF出力ではvivliostyle.config.js の`entry:` に書かれたファイルを対象に、`theme:`で指定されたスタイルシートにもとづきPDFに出力されるのだと思います。（vivliostyle.config.jsが存在しない場合は、ループになってしまう）<br><br>私が誤解しているのかもしれませんが「Plain themeでPDF出力ができる」とはどういうことなのか、もう一度教えていただけませんか？|
|06:45|![](https://avatars.slack-edge.com/2021-08-02/2324149410423_2aa7423c4133ecb9f168_72.png)|Kiara : Translation 100+ Languages|🇬🇧: Thank you for your answer.<br>&amp; gt; Note that the "Plain theme" in Vivliostyle Pub simply means that the theme is not specified, so there is no problem with PDF output.<br>------------<br>If you do not specify the &amp; gt; theme, you can output PDF as I wrote that there is no problem with PDF output.<br>I'm sorry, I don't understand the meaning of this part.<br><br>I tried to output PDF by specifying `theme:'',` in vivliostyle.config.js in the user repository, but the build never finishes.<br><br>So, I think that Mr. Murakami's "no theme specified" is said in a figurative sense (that is, it is not the config of the user repository).<br><br>However, isn't the "Plain theme" in the Action menu a preview-only setting, and the PDF output is irrelevant?<br><br>This is because "Export" unconditionally processes based on vivliostyle.config.js.<br><br>Therefore, even if "Plain theme" is selected, the PDF output will target the file written in `entry:` of vivliostyle.config.js, and the PDF will be based on the style sheet specified by `theme:`. I think it will be output to. (If vivliostyle.config.js does not exist, it will be a loop)<br><br>Maybe I'm misunderstanding, but could you please tell me again what it means to be able to output PDF with the Plain theme?|
|06:50|![](https://avatars.slack-edge.com/2018-04-27/354445776386_e258f5ed5ba887b08668_72.jpg)|shinyu|<blockquote>ユーザリポジトリにあるvivliostyle.config.jsで、`theme: '',` と指定してPDF出力をしてみましたが、いつまでたってもビルドが終了しません。</blockquote>`theme: ''`  という指定は間違いです！　「theme指定なし」というのはvivliostyle.config.jsにtheme:の指定を何も書かない（またはコメントアウトする）ことです。<br>`theme: ''`  という空文字列の指定ではvivliostyle-cliがエラーにしているはずです。|
|06:50|![](https://avatars.slack-edge.com/2021-08-02/2324149410423_2aa7423c4133ecb9f168_72.png)|Kiara : Translation 100+ Languages|🇬🇧: &amp; gt; I tried to output PDF by specifying `theme:'',` in vivliostyle.config.js in the user repository, but the build never finishes.<br>The specification `theme:''` is incorrect! "No theme specified" means not writing (or commenting out) any theme: specification in vivliostyle.config.js.<br>Specifying the empty string `theme:''` should cause vivliostyle-cli to make an error.|
|06:56|![](https://avatars.slack-edge.com/2019-11-22/845042642576_070441337abaca9fb7b3_72.png)|ogwata|<blockquote>`theme: ''`  という指定は間違いです！</blockquote>はい、さきほど`theme:`をコメントアウトしてPDF出力したら、PDF出力はできました。ただし、フォントはPlain themeとは無関係なものです。<br><br>もしや「theme指定なしの場合、PDF出力に問題ありません」とは、単にPDF出力ができるというだけの意味で、Plain themeとは無関係なのでしょうか？<br>https://vivliostyle.slack.com/files/UJS3RCS86/F03MC8SQEG7/____________________________2022-06-30_15.54.46.png|
|06:56|![](https://avatars.slack-edge.com/2021-08-02/2324149410423_2aa7423c4133ecb9f168_72.png)|Kiara : Translation 100+ Languages|🇬🇧: &amp; gt; The specification `theme:''` is incorrect!<br>Yes, when I commented out `theme:` and output it to PDF, I was able to output PDF. However, the font has nothing to do with the Plain theme.<br><br>If "theme is not specified, there is no problem with PDF output" is just that PDF output is possible, and is it unrelated to the Plain theme?|
|08:31|![](https://avatars.slack-edge.com/2018-04-27/354445776386_e258f5ed5ba887b08668_72.jpg)|shinyu|「なおVivliostyle Pubでの「Plain theme」というのは単にthemeの指定がない場合のこと」と書いた意味がなかなか通じていないようですね。themeによるスタイルシートの指定が何もないということです。<br><br>スタイルシートの指定が何もないと、プレビューではユーザーのOS環境のブラウザのフォント設定で、ページサイズはViewerの表示領域の大きさによって、ページのレイアウトがされます。<br>PDFビルドでは、Dockerコンテナ内のVivliostyle CLIでのbuildコマンドで組版されます。現状は日本語テキストに対するフォントWenQuanYiZenHeiになります。ページサイズはVivliostyle CLIでのbuildコマンドでページサイズ指定がない場合のデフォルトのサイズになります。|
|08:31|![](https://avatars.slack-edge.com/2021-08-02/2324149410423_2aa7423c4133ecb9f168_72.png)|Kiara : Translation 100+ Languages|🇬🇧: It seems that the meaning of writing "Plain theme" in Vivlio style Pub is simply when the theme is not specified. It means that there is no stylesheet specified by theme.<br><br>If no style sheet is specified, the page layout will be set according to the size of the display area of the Viewer in the font setting of the browser of the user's OS environment in the preview.<br>For PDF builds, typeset with the build command in the Vivliostyle CLI inside the Docker container. Currently, the font is WenQuanYiZenHei for Japanese text. The page size is the default size when the page size is not specified in the build command in Vivliostyle CLI.|
|08:35|![](https://avatars.slack-edge.com/2019-11-22/845042642576_070441337abaca9fb7b3_72.png)|ogwata|なるほど、べつに「Plain theme」というスタイルシートがあるわけではなく、プレビューではブラウザの、PDF出力ではVivliostyle CLIのデフォルト設定に従って処理されるということですね。|
|08:35|![](https://avatars.slack-edge.com/2021-08-02/2324149410423_2aa7423c4133ecb9f168_72.png)|Kiara : Translation 100+ Languages|🇬🇧: Well, there isn't a "Plain theme" stylesheet, it's processed according to the default settings of the browser for preview and Vivliostyle CLI for PDF output.|
|08:38|![](https://avatars.slack-edge.com/2018-04-27/354445776386_e258f5ed5ba887b08668_72.jpg)|shinyu|はい。<br><br>このスレッドで「Plain theme」という名前を提案してます：<br><https://vivliostyle.slack.com/archives/CR14JBXCJ/p1637024938100800?thread_ts=1636994883.085700&amp;cid=CR14JBXCJ><br><blockquote>1.のテーマを使用しない状態は「Plain」でどうでしょうか。<br>Vivliostyleでスタイルシートを何も指定してない状態では、ブラウザのではなくてVivliostyleのデフォルトスタイルになります（Vivliostyleのデフォルトスタイルで定義されていないところにはブラウザのデフォルトスタイルが反映されます）。<br><br>2.は「Custom」でどうでしょう。カスタムテーマ</blockquote>|
|08:39|![](https://avatars.slack-edge.com/2021-08-02/2324149410423_2aa7423c4133ecb9f168_72.png)|Kiara : Translation 100+ Languages|🇬🇧: yes.<br><br>This thread suggests the name "Plain theme":<br><https://vivliostyle.slack.com/archives/CR14JBXCJ/p1637024938100800?thread_ts=1636994883.085700&amp;cid=CR14JBXCJ>|
|09:29|![](https://avatars.slack-edge.com/2018-04-27/354445776386_e258f5ed5ba887b08668_72.jpg)|shinyu|Issue登録しました<br><https://github.com/vivliostyle/vivliostyle-pub/issues/202><br><blockquote>vivliostyle.config.js の `theme:` の設定により、「テーマの準備に失敗しました: … Unexpected token &lt; in JSON at position 0」のエラーになり、プレビューにスタイルが適用されません。<br><br>以下の場合です：<br><br>• CSSファイルへのパスの指定が `./` ではじまる場合<br>    • 例: `theme: './theme/theme_screen.css'`<br>• CSSファイルへのパスの指定が `/` ではじまる場合<br>    • 例: `theme: '/theme/theme_screen.css'`<br>• テーマパッケージ名が指定された場合<br>    • 公式テーマパッケージ指定の例: `theme: '@vivliostyle/theme-techbook'`<br>    • 非公式テーマパッケージ指定の例: `theme: 'vivliostyle-akashi-kosen-bulletin'`<br><br>また、カスタムテーマの（CSSファイルパスではなく）ディレクトリを指定した場合、エラーは起きないにもかかわらず、プレビューにスタイルが適用されません。<br><br>*テストしたサンプルと結果について*<br><br>テストしたレポジトリ: <https://github.com/MurakamiShinyu/tbf11-draft|https://github.com/MurakamiShinyu/tbf11-draft>  <br>（<https://github.com/spring-raining/tbf11-draft|https://github.com/spring-raining/tbf11-draft> をテスト用にforkしたもの）<br><br>*元の `theme: 'theme/theme_screen.css'` の場合：問題なし*<br><br>正常。次のメッセージが出る：<br><br><blockquote>テーマを変更しました: vivliostyle-custom-theme /vpubfs/theme/theme_screen.css</blockquote>PDFビルドもOK。<br><br>*`theme: './theme/theme_screen.css'` （CSSファイルへのパスの指定が `./` ではじまる）*<br><br>テストしたブランチ: <https://github.com/MurakamiShinyu/tbf11-draft/tree/vs-pub-test1|https://github.com/MurakamiShinyu/tbf11-draft/tree/vs-pub-test1><br><br>エラー：<br><br><blockquote>テーマの準備に失敗しました: ./theme/theme_screen.css Unexpected token &lt; in JSON at position 0</blockquote>スクリーンショット  <br><https://user-images.githubusercontent.com/3324737/176642258-c361ddfb-52d2-4ec1-9f16-0ec6ad5a23e7.png|Screen Shot 2022-06-30 at 18 18 43><br><br>PDFビルドはOK。  <br>ただし、「テーマの準備に失敗しました」エラーが起きたあと、PDFビルドを実行すると、現在のブランチではなくデフォルトブランチでPDFビルドが行われる問題があることが分かったため、PDFビルドのテストはリポジトリのデフォルトブランチをテストするブランチに変更したうえで行った。以下のテストも同じ。<br><br>*`theme: '/theme/theme_screen.css'` （CSSファイルへのパスの指定が `/` ではじまる）*<br><br>テストしたブランチ: <https://github.com/MurakamiShinyu/tbf11-draft/tree/vs-pub-test4|https://github.com/MurakamiShinyu/tbf11-draft/tree/vs-pub-test4><br><br>エラー：<br><br><blockquote>テーマの準備に失敗しました: /theme/theme_screen.css Unexpected token &lt; in JSON at position 0</blockquote>PDFビルドは成功するが、このテーマの適用はされない。  <br>リポジトリのルートがPDFビルドの環境でのファイルシステムのルートディレクトリではないので、これは当然といえるかも。<br><br>*`theme: '@vivliostyle/theme-techbook'`（公式テーマパッケージ指定）*<br><br>テストしたブランチ: <https://github.com/MurakamiShinyu/tbf11-draft/tree/vs-pub-test3|https://github.com/MurakamiShinyu/tbf11-draft/tree/vs-pub-test3><br><br>エラー：<br><br><blockquote>テーマの準備に失敗しました: @vivliostyle/theme-techbook Unexpected token &lt; in JSON at position 0</blockquote>PDFビルドは成功するが、このテーマの適用はされない。<br><br>*`theme: 'vivliostyle-akashi-kosen-bulletin'`（非公式テーマパッケージ指定）*<br><br>テストしたブランチ: <https://github.com/MurakamiShinyu/tbf11-draft/tree/vs-pub-test2|https://github.com/MurakamiShinyu/tbf11-draft/tree/vs-pub-test2><br><br>エラー：<br><br><blockquote>テーマの準備に失敗しました: vivliostyle-akashi-kosen-bulletin Unexpected token &lt; in JSON at position 0</blockquote>PDFビルドは成功するが、このテーマの適用はされない<br><br>*`theme: 'theme'` （カスタムテーマのディレクトリを指定）*<br><br>テストしたブランチ: <https://github.com/MurakamiShinyu/tbf11-draft/tree/vs-pub-test2|https://github.com/MurakamiShinyu/tbf11-draft/tree/vs-pub-test2><br><br>エラーメッセージは出ない。次のメッセージが出る：<br><br><blockquote>テーマを変更しました: vivliostyle-custom-theme</blockquote>カスタムテーマのCSSファイルのパスを指定した場合には、  <br>「テーマを変更しました: vivliostyle-custom-theme /vpubfs/theme/theme_screen.css」  <br>のように `/vpubfs/` ではじまるパスが表示されるのだが、それが出ない。<br><br>ファイルリストからMD原稿を選択して、プレビューを確認したが、テーマのスタイルシートの適用はされていない。<br><br>スクリーンショット  <br><https://user-images.githubusercontent.com/3324737/176642411-5f8ffb63-0b7f-40c0-8208-a6e8b9f7c6cd.png|Screen Shot 2022-06-30 at 18 17 12><br><br>PDFビルドはOK。</blockquote>|
|09:29|![](https://avatars.slack-edge.com/2021-08-02/2324149410423_2aa7423c4133ecb9f168_72.png)|Kiara : Translation 100+ Languages|🇬🇧: Issue registered<br><https://github.com/vivliostyle/vivliostyle-pub/issues/202>|
|10:01|![](https://avatars.slack-edge.com/2018-04-27/354445776386_e258f5ed5ba887b08668_72.jpg)|shinyu|<blockquote>`theme: ''`  という空文字列の指定ではvivliostyle-cliがエラーにしているはずです。</blockquote>PDFビルドでエラーが起きているのに何もエラーメッセージが出ないことが問題なのでissueにしました:<br><br><https://github.com/vivliostyle/vivliostyle-pub/issues/203><br><blockquote>PDFビルドサーバー内での vivliostyle build の実行がエラーで終了した場合、そのことがフロントエンド側に通知されず、エラーメッセージが出ないため、いつまでも処理が終了しないようにユーザーからは見えます。</blockquote>|
|10:01|![](https://avatars.slack-edge.com/2021-08-02/2324149410423_2aa7423c4133ecb9f168_72.png)|Kiara : Translation 100+ Languages|🇬🇧: &amp; gt; The empty string specification `theme:''` should cause vivliostyle-cli to make an error.<br>I made an issue because the problem is that there is an error in the PDF build but no error message is displayed:<br><br><https://github.com/vivliostyle/vivliostyle-pub/issues/203>|
|12:41|![](https://avatars.slack-edge.com/2019-11-22/845042642576_070441337abaca9fb7b3_72.png)|ogwata|<blockquote>Issue登録しました<br><https://github.com/vivliostyle/vivliostyle-pub/issues/202></blockquote>ありがとうございます。ドキュメントで参照させていただきます。<br><br>ただ、仮にこのIssueが解決できたとしても、公式Themeで指定されているフォントとDockerコンテナにインストールされているフォントが食い違っている状況に変わりはありません。つまり、公式ThemeはPDF出力には使えない訳です。<br><br>簡単には解決するのはむずかしそうですが、なにか対策を考えたいところです。<br><blockquote>vivliostyle.config.js の `theme:` の設定により、「テーマの準備に失敗しました: … Unexpected token &lt; in JSON at position 0」のエラーになり、プレビューにスタイルが適用されません。<br><br>以下の場合です：<br><br>• CSSファイルへのパスの指定が `./` ではじまる場合<br>    • 例: `theme: './theme/theme_screen.css'`<br>• CSSファイルへのパスの指定が `/` ではじまる場合<br>    • 例: `theme: '/theme/theme_screen.css'`<br>• テーマパッケージ名が指定された場合<br>    • 公式テーマパッケージ指定の例: `theme: '@vivliostyle/theme-techbook'`<br>    • 非公式テーマパッケージ指定の例: `theme: 'vivliostyle-akashi-kosen-bulletin'`<br><br>また、カスタムテーマの（CSSファイルパスではなく）ディレクトリを指定した場合、エラーは起きないにもかかわらず、プレビューにスタイルが適用されません。<br><br>*テストしたサンプルと結果について*<br><br>テストしたレポジトリ: <https://github.com/MurakamiShinyu/tbf11-draft|https://github.com/MurakamiShinyu/tbf11-draft>  <br>（<https://github.com/spring-raining/tbf11-draft|https://github.com/spring-raining/tbf11-draft> をテスト用にforkしたもの）<br><br>*元の `theme: 'theme/theme_screen.css'` の場合：問題なし*<br><br>正常。次のメッセージが出る：<br><br><blockquote>テーマを変更しました: vivliostyle-custom-theme /vpubfs/theme/theme_screen.css</blockquote>PDFビルドもOK。<br><br>*`theme: './theme/theme_screen.css'` （CSSファイルへのパスの指定が `./` ではじまる）*<br><br>テストしたブランチ: <https://github.com/MurakamiShinyu/tbf11-draft/tree/vs-pub-test1|https://github.com/MurakamiShinyu/tbf11-draft/tree/vs-pub-test1><br><br>エラー：<br><br><blockquote>テーマの準備に失敗しました: ./theme/theme_screen.css Unexpected token &lt; in JSON at position 0</blockquote>スクリーンショット  <br><https://user-images.githubusercontent.com/3324737/176642258-c361ddfb-52d2-4ec1-9f16-0ec6ad5a23e7.png|Screen Shot 2022-06-30 at 18 18 43><br><br>PDFビルドはOK。  <br>ただし、「テーマの準備に失敗しました」エラーが起きたあと、PDFビルドを実行すると、現在のブランチではなくデフォルトブランチでPDFビルドが行われる問題があることが分かったため、PDFビルドのテストはリポジトリのデフォルトブランチをテストするブランチに変更したうえで行った。以下のテストも同じ。<br><br>*`theme: '/theme/theme_screen.css'` （CSSファイルへのパスの指定が `/` ではじまる）*<br><br>テストしたブランチ: <https://github.com/MurakamiShinyu/tbf11-draft/tree/vs-pub-test4|https://github.com/MurakamiShinyu/tbf11-draft/tree/vs-pub-test4><br><br>エラー：<br><br><blockquote>テーマの準備に失敗しました: /theme/theme_screen.css Unexpected token &lt; in JSON at position 0</blockquote>PDFビルドは成功するが、このテーマの適用はされない。  <br>リポジトリのルートがPDFビルドの環境でのファイルシステムのルートディレクトリではないので、これは当然といえるかも。<br><br>*`theme: '@vivliostyle/theme-techbook'`（公式テーマパッケージ指定）*<br><br>テストしたブランチ: <https://github.com/MurakamiShinyu/tbf11-draft/tree/vs-pub-test3|https://github.com/MurakamiShinyu/tbf11-draft/tree/vs-pub-test3><br><br>エラー：<br><br><blockquote>テーマの準備に失敗しました: @vivliostyle/theme-techbook Unexpected token &lt; in JSON at position 0</blockquote>PDFビルドは成功するが、このテーマの適用はされない。<br><br>*`theme: 'vivliostyle-akashi-kosen-bulletin'`（非公式テーマパッケージ指定）*<br><br>テストしたブランチ: <https://github.com/MurakamiShinyu/tbf11-draft/tree/vs-pub-test2|https://github.com/MurakamiShinyu/tbf11-draft/tree/vs-pub-test2><br><br>エラー：<br><br><blockquote>テーマの準備に失敗しました: vivliostyle-akashi-kosen-bulletin Unexpected token &lt; in JSON at position 0</blockquote>PDFビルドは成功するが、このテーマの適用はされない<br><br>*`theme: 'theme'` （カスタムテーマのディレクトリを指定）*<br><br>テストしたブランチ: <https://github.com/MurakamiShinyu/tbf11-draft/tree/vs-pub-test2|https://github.com/MurakamiShinyu/tbf11-draft/tree/vs-pub-test2><br><br>エラーメッセージは出ない。次のメッセージが出る：<br><br><blockquote>テーマを変更しました: vivliostyle-custom-theme</blockquote>カスタムテーマのCSSファイルのパスを指定した場合には、  <br>「テーマを変更しました: vivliostyle-custom-theme /vpubfs/theme/theme_screen.css」  <br>のように `/vpubfs/` ではじまるパスが表示されるのだが、それが出ない。<br><br>ファイルリストからMD原稿を選択して、プレビューを確認したが、テーマのスタイルシートの適用はされていない。<br><br>スクリーンショット  <br><https://user-images.githubusercontent.com/3324737/176642411-5f8ffb63-0b7f-40c0-8208-a6e8b9f7c6cd.png|Screen Shot 2022-06-30 at 18 17 12><br><br>PDFビルドはOK。</blockquote>|
|12:41|![](https://avatars.slack-edge.com/2021-08-02/2324149410423_2aa7423c4133ecb9f168_72.png)|Kiara : Translation 100+ Languages|🇬🇧: &amp; gt; Issue registered<br>&amp; gt; <https://github.com/vivliostyle/vivliostyle-pub/issues/202><br>Thank you. I will refer to it in the document.<br><br>However, even if this issue can be resolved, the font specified in the official Theme and the font installed in the Docker container will still be inconsistent. In other words, the official Theme cannot be used for PDF output.<br><br>It seems difficult to solve it easily, but I would like to think about some countermeasures.|
|12:42|![](https://avatars.slack-edge.com/2019-11-22/845042642576_070441337abaca9fb7b3_72.png)|ogwata|Webフォントを使ったthemeを追加していくのが、最も早道なのかもしれませんね。|
|12:43|![](https://avatars.slack-edge.com/2021-08-02/2324149410423_2aa7423c4133ecb9f168_72.png)|Kiara : Translation 100+ Languages|🇬🇧: Adding themes using web fonts may be the fastest way.|
|13:09|![](https://avatars.slack-edge.com/2019-11-22/845042642576_070441337abaca9fb7b3_72.png)|ogwata|<blockquote>ただ、仮にこのIssueが解決できたとしても、公式Themeで指定されているフォントとDockerコンテナにインストールされているフォントが食い違っている状況に変わりはありません。つまり、公式ThemeはPDF出力には使えない訳です。</blockquote>すいません、もしや＃202の問題がなければ、公式themeを利用することでローカルフォントが使えるのでしょうか？　もしもそうなら誤解していたことになります。|
|13:09|![](https://avatars.slack-edge.com/2021-08-02/2324149410423_2aa7423c4133ecb9f168_72.png)|Kiara : Translation 100+ Languages|🇬🇧: &amp; gt; However, even if this issue can be resolved, the font specified in the official Theme and the font installed in the Docker container will still be inconsistent. In other words, the official Theme cannot be used for PDF output.<br>Excuse me, if there is no problem with # 202, can I use local fonts by using the official theme? If so, you would have misunderstood.|
|13:52|![](https://avatars.slack-edge.com/2018-04-27/354445776386_e258f5ed5ba887b08668_72.jpg)|shinyu|<https://github.com/vivliostyle/vivliostyle-cli/issues/303><br>この問題や関連するcore側の課題を近日中に解決します。Vivliostyle CLIにNoto CJKフォント（源ノ明朝・源ノ角ゴシック）など一式を組み込みます。そして標準でそれらのフォントが使われるようにします。<br><br>現在の公式テーマは、そのままPubでのPDF出力にも使えるようになります。MacやWindowsの標準の日本語フォントの指定 "Hiragino Sans" や "YuMincho" がスタイルシートにあれば、その代替フォントとしてNoto CJKフォントで出力されるようになるためです。<br><br><blockquote> もしや＃202の問題がなければ、公式themeを利用することでローカルフォントが使えるのでしょうか？</blockquote>はい、公式themeでもカスタムテーマでも、ローカルフォントが使えるようになります。<br>ローカルフォントというのは、それぞれの実行環境にインストールされているフォントです。<br>Macを使っているユーザーならば、プレビューはMacに入っているローカルフォントで、PubでのPDFビルドではDockerに入っているローカルフォント（Noto CJKフォントなど）で、ということです。完全に同じフォントではないため、プレビューとPDFビルドでレイアウトが完全には一致しないという問題はあります。これは、同じ公式themeでも、Macで使うのとWindowsで使うのとでは、OSに入っているフォントが違うのでレイアウトが一致しないのと同じことです。<br><br>Webフォントを使用するとプレビューとPDFビルドの結果が完全に一致するかというと、それも保証できるわけではありません。ブラウザの環境によってたとえフォントが同じものでも微妙に違いがでるためです。<br><blockquote>DockerモードでVivliostyle CLIを使う場合、Webフォントの指定なしで利用できるフォントがとても限られる。<br><br>とくに日本語テキストに対してデフォルトで選択されるフォントがCJK汎用フォントである WenQuanYiZenHei になり、このフォントは縦書き非対応のためレイアウトが崩れるということが大きな問題だ。<br><br>テスト:（サンプルは 「ごん狐」）<br><br><pre>vivliostyle build --render-mode=docker <https://vivliostyle.github.io/vivliostyle_doc/samples/gon/index.html><br></pre><br><br>出力されたPDF: <https://github.com/vivliostyle/vivliostyle-cli/files/8964203/output.pdf|output.pdf><br><br>Adobe AcrobatでこのPDFを表示してプロパティでフォントを確認したところのスクリーンショット:  <br><https://user-images.githubusercontent.com/3324737/175221295-032045db-076d-4f0b-b8b7-6c124488b9ae.png|Screen Shot 2022-06-23 at 14 15 37><br><br>もっとまともなフォントがデフォルトで使えるように、Vivliostyle CLIのDockerイメージに、いくつかの基本的なフォントがインストールされているとよさそう。</blockquote>|
|13:52|![](https://avatars.slack-edge.com/2021-08-02/2324149410423_2aa7423c4133ecb9f168_72.png)|Kiara : Translation 100+ Languages|🇬🇧: <https://github.com/vivliostyle/vivliostyle-cli/issues/303><br>We will resolve this issue and related core issues in the near future. Incorporate a set of Noto CJK fonts (Source Han Serif / Source Han Sans) into the Vivliostyle CLI. And make sure those fonts are used by default.<br><br>The current official theme can be used for PDF output in Pub as it is. This is because if the standard Japanese font specification "Hiragino Sans" or "YuMincho" for Mac or Windows is included in the style sheet, it will be output as the Noto CJK font as an alternative font.<br><br>&amp; gt; If there is no problem with # 202, can local fonts be used by using the official theme?<br>Yes, you will be able to use local fonts in both official themes and custom themes.<br>Local fonts are fonts installed in each execution environment.<br>If you're a Mac user, the preview is the local font that's in your Mac, and the PDF build in Pub is the local font that's in Docker (such as the Noto CJK font). The problem is that the layout doesn't exactly match the preview and the PDF build because they aren't exactly the same font. This is the same as the same official theme, but the layout does not match between using it on Mac and using it on Windows because the fonts in the OS are different.<br><br>We cannot guarantee that the preview and PDF build results will match exactly when using web fonts. This is because even if the font is the same, there will be a slight difference depending on the browser environment.|
