# 2021-02-06

|Time (UTC)|Icon|Name|Message|
|---|---|---|---|
|04:45|![](https://avatars.slack-edge.com/2019-05-15/624511073651_25909952cd7a069ceed2_72.png)|akabeko|<!channel> 本日の Vivliostyle 開発者会議 February 2021 は本メッセージに対するスレッドとして議事録をとります。<br>発言内容の補足や訂正などはスレッド中のメッセージとしてお願いします。<br><br>またオフレコにしたい発言をされる際はその旨をお知らせください。議事録の対象から外します。<br><br>February 2021 · Issue #84 · vivliostyle/community<br><https://github.com/vivliostyle/community/issues/84><br><blockquote>• Meeting Log<br><br>*Agenda*<br><br>• <https://github.com/Monchi/vfm-viewer|vfm-viewer>のデモ（<https://github.com/Monchi|@Monchi>）<br><br>*VFM の仕様検討*<br><br>VFMの仕様と現状の動作をチェックして各spec issueのコメントに課題と仕様見直し案をまとめた:<br><br>• <https://github.com/vivliostyle/vfm/issues/8|spec: Auto generate HTML section elements #8><br>    • <https://github.com/vivliostyle/vfm/issues/8#issuecomment-760207841|コメント: 現状の vfm と Pandoc --section-divs の動作の比較評価><br>• <https://github.com/vivliostyle/vfm/issues/9|spec: Attributes on headings and other elements #9><br>    • <https://github.com/vivliostyle/vfm/issues/9#issuecomment-760304439|コメント: 現状の vfm での実装状況と課題><br>• <https://github.com/vivliostyle/vfm/issues/15|spec: figure for image container #15><br>    • <https://github.com/vivliostyle/vfm/issues/15#issuecomment-760331260|コメント: 現状の課題まとめ><br>• <https://github.com/vivliostyle/vfm/issues/5|spec: Fenced blocks #5><br>    • <https://github.com/vivliostyle/vfm/issues/5#issuecomment-768119623|コメント: 現状の vfm の Fenced blocks 実装とその課題、Pandoc との比較 / HTML 要素名を明示的に指定可能にする拡張案><br>• <https://github.com/vivliostyle/vfm/issues/28|spec: WAI-ARIA role syntax #28><br>    • <https://github.com/vivliostyle/vfm/issues/28#issuecomment-768171789|コメント: WAI-ARIA role syntax の見直し案><br><br><https://github.com/akabekobeko|@akabekobeko> からの議題:<br><br>• VFM v1.0.0 進捗報告<br>• <https://github.com/vivliostyle/vfm/issues/38|svgタグ内の改行がbrタグに変換される · Issue #38 · vivliostyle/vfm><br>    • <https://spec.commonmark.org/0.29/#html-blocks|CommonMark Spec 4.6 HTML blocks> のリストにないタグが分割処理される挙動をどう扱うか？<br>    • remark としては CommonMark に基づきブロック扱いしない<br>    • VFM として対応するなら既定を CommonMark 互換としてオプショナルにブロック処理を実装するか？<br><br>*vivliostyle.js v2.5 で予定する更新内容について報告*<br><br>• <https://github.com/vivliostyle/vivliostyle.js/pull/693|feat(viewer): Configuration flags update><br>• <https://github.com/vivliostyle/vivliostyle.js/issues/666|break-before:left/right at beginning of a document does not work properly><br>• <https://github.com/vivliostyle/vivliostyle.js/issues/667|First-page pseudo-class :first should work on each document in a multi-document publication? (→support :nth())><br><br>*vivliostyle-cli v3 RC*<br><br>近日中にリリース予定の v3 RC について <https://github.com/spring-raining|@spring-raining><br><br><blockquote>Hi users! I’m planning to release the RC version of vivliostyle-cli v3 in a few days. If that version seems to be works well, it’ll become the final release before the major update to v3.</blockquote>*Members*<br><br>• <https://github.com/MurakamiShinyu|@MurakamiShinyu><br>• <https://github.com/ogwata|@ogwata><br>• <https://github.com/spring-raining|@spring-raining><br>• <https://github.com/yamasy1549|@yamasy1549><br>• <https://github.com/takanakahiko|@takanakahiko><br>• <https://github.com/AyumuTakai|@AyumuTakai><br>• <https://github.com/Monchi|@Monchi><br>• <https://github.com/akabekobeko|@akabekobeko> (Scribe)</blockquote>|
|04:45|![](https://avatars.slack-edge.com/2019-08-21/732685848020_f3f20736795184660348_72.png)|Kiara Translation|🇬🇧: &lt;! channel&gt; Today's Vivliostyle Developer Conference February 2021 will take minutes as a thread to this message.<br>Please use the message in the thread to supplement or correct your remarks.<br><br>If you want to make an off-record statement, please let us know. Excludes from the minutes.<br><br>February 2021 · Issue # 84 · vivliostyle / community<br><https://github.com/vivliostyle/community/issues/84>|
|05:03|![](https://avatars.slack-edge.com/2019-05-15/624511073651_25909952cd7a069ceed2_72.png)|akabeko|議事録における合意事項の記録と一覧性について|
|05:03|![](https://avatars.slack-edge.com/2019-08-21/732685848020_f3f20736795184660348_72.png)|Kiara Translation|🇬🇧: About the record and list of agreements in the minutes|
|05:07|![](https://avatars.slack-edge.com/2019-05-15/624511073651_25909952cd7a069ceed2_72.png)|akabeko|合意して対応が決定した事項は議題 Issue に ogwata が記録<br>それを akabeko が Issue 説明文に転載|
|05:07|![](https://avatars.slack-edge.com/2019-08-21/732685848020_f3f20736795184660348_72.png)|Kiara Translation|🇬🇧: Matters agreed and decided to be dealt with are recorded by ogwata on the agenda issue<br>Reprinted by akabeko in the issue description|
|05:12|![](https://avatars.slack-edge.com/2019-05-15/624511073651_25909952cd7a069ceed2_72.png)|akabeko|meet 荒らしがきたので部屋を作り直して再開|
|05:12|![](https://avatars.slack-edge.com/2019-08-21/732685848020_f3f20736795184660348_72.png)|Kiara Translation|🇬🇧: meet Trolls have come, so recreate the room and restart|
|05:13|![](https://avatars.slack-edge.com/2019-05-15/624511073651_25909952cd7a069ceed2_72.png)|akabeko|meet や zoom の URL を Twitter のようにユーザー制限のない場所に公開すると荒らしの標的になりやすい、これをどう対策するか？|
|05:13|![](https://avatars.slack-edge.com/2019-08-21/732685848020_f3f20736795184660348_72.png)|Kiara Translation|🇬🇧: If you publish the URL of meet or zoom to a place like Twitter where there is no user restriction, it is easy to be a target of vandalism, how to deal with this?|
|05:16|![](https://avatars.slack-edge.com/2019-05-15/624511073651_25909952cd7a069ceed2_72.png)|akabeko|次回から検討する|
|05:16|![](https://avatars.slack-edge.com/2019-08-21/732685848020_f3f20736795184660348_72.png)|Kiara Translation|🇬🇧: Consider from next time|
|05:17|![](https://avatars.slack-edge.com/2019-05-15/624511073651_25909952cd7a069ceed2_72.png)|akabeko|<https://github.com/Monchi/vfm-viewer> のデモ<br><blockquote>Experimental real-time typesetting previewer for Vivliostyle Flavored Markdown.</blockquote>|
|05:17|![](https://avatars.slack-edge.com/2019-08-21/732685848020_f3f20736795184660348_72.png)|Kiara Translation|🇬🇧: Demo of <https://github.com/Monchi/vfm-viewer>|
|05:17|![](https://avatars.slack-edge.com/2019-05-15/624511073651_25909952cd7a069ceed2_72.png)|akabeko|by. `@yuku`|
|05:17|![](https://avatars.slack-edge.com/2019-08-21/732685848020_f3f20736795184660348_72.png)|Kiara Translation|🇯🇵: 沿って。|
|05:18|![](https://avatars.slack-edge.com/2019-05-15/624511073651_25909952cd7a069ceed2_72.png)|akabeko|VS Code 上で編集した Markdown を Web ブラウザーでプレビューするもの|
|05:18|![](https://avatars.slack-edge.com/2019-08-21/732685848020_f3f20736795184660348_72.png)|Kiara Translation|🇬🇧: Preview Markdown edited on VS Code in a web browser|
|05:18|![](https://avatars.slack-edge.com/2019-05-15/624511073651_25909952cd7a069ceed2_72.png)|akabeko|CLI なので VS Code でなくてもよい？|
|05:18|![](https://avatars.slack-edge.com/2019-08-21/732685848020_f3f20736795184660348_72.png)|Kiara Translation|🇬🇧: Since it's CLI, it doesn't have to be VS Code?|
|05:20|![](https://avatars.slack-edge.com/2019-05-15/624511073651_25909952cd7a069ceed2_72.png)|akabeko|ファイル変更を検知 (なので VS Code 以外も OK) して React などでいう HMR 的に差分更新してくれる|
|05:20|![](https://avatars.slack-edge.com/2019-08-21/732685848020_f3f20736795184660348_72.png)|Kiara Translation|🇬🇧: Detects file changes (so other than VS Code is OK) and updates the difference like HMR in React etc.|
|05:21|![](https://avatars.slack-edge.com/2019-05-15/624511073651_25909952cd7a069ceed2_72.png)|akabeko|yuku: これを Vivliostyle 関連のプロジェクトにフィードバックしてゆけたら、と考えている|
|05:21|![](https://avatars.slack-edge.com/2019-08-21/732685848020_f3f20736795184660348_72.png)|Kiara Translation|🇬🇧: yuku: I hope I can feed this back to Vivliostyle related projects.|
|05:21|![](https://avatars.slack-edge.com/2019-05-15/624511073651_25909952cd7a069ceed2_72.png)|akabeko|spring-raining: CLI などに PR もらえるとうれしい|
|05:21|![](https://avatars.slack-edge.com/2019-08-21/732685848020_f3f20736795184660348_72.png)|Kiara Translation|🇬🇧: spring-raining: I'd be happy if you could get PR from CLI etc.|
|05:24|![](https://avatars.slack-edge.com/2019-05-15/624511073651_25909952cd7a069ceed2_72.png)|akabeko|shinyu: Vivliostyle の viewer 体験をよくして統合してゆくのが望ましいと考えている|
|05:24|![](https://avatars.slack-edge.com/2019-08-21/732685848020_f3f20736795184660348_72.png)|Kiara Translation|🇬🇧: shinyu: I think it's desirable to improve and integrate the Vivliostyle viewer experience.|
|05:24|![](https://avatars.slack-edge.com/2019-05-15/624511073651_25909952cd7a069ceed2_72.png)|akabeko|yuku: 確かにその線もある|
|05:24|![](https://avatars.slack-edge.com/2019-08-21/732685848020_f3f20736795184660348_72.png)|Kiara Translation|🇬🇧: youku: Certainly there is that line|
|05:25|![](https://avatars.slack-edge.com/2019-05-15/624511073651_25909952cd7a069ceed2_72.png)|akabeko|spring-raining: クライアント部分が乱立するのは好ましくないが新規性のある機能なので CLI に統合できるとよさそう|
|05:25|![](https://avatars.slack-edge.com/2019-08-21/732685848020_f3f20736795184660348_72.png)|Kiara Translation|🇬🇧: spring-raining: I don't want the client part to be crowded, but it's a novel feature so it would be nice to be able to integrate it into the CLI|
|05:27|![](https://avatars.slack-edge.com/2019-05-15/624511073651_25909952cd7a069ceed2_72.png)|akabeko|yuku: UI の再発明は避けるとして、今回の更新の仕組みなどで裏側が増強されてゆくのが望ましい|
|05:27|![](https://avatars.slack-edge.com/2019-08-21/732685848020_f3f20736795184660348_72.png)|Kiara Translation|🇬🇧: yuku: While avoiding reinventing the UI, it is desirable that the back side be strengthened by the mechanism of this update etc.|
|05:27|![](https://avatars.slack-edge.com/2019-05-15/624511073651_25909952cd7a069ceed2_72.png)|akabeko|spring-raining: 参考として <https://browsersync.io/><br><blockquote>Browsersync makes your browser testing workflow faster by synchronising URLs, interactions and code changes across multiple devices. It&amp;rsquo;s wicked-fast and totally free.</blockquote>|
|05:27|![](https://avatars.slack-edge.com/2019-08-21/732685848020_f3f20736795184660348_72.png)|Kiara Translation|🇬🇧: spring-raining: For reference <https://browsersync.io/>|
|05:29|![](https://avatars.slack-edge.com/2019-05-15/624511073651_25909952cd7a069ceed2_72.png)|akabeko|shinyu: この話題に絡むものとして shinyu と ogwata で作成しているコンテンツをデモする|
|05:29|![](https://avatars.slack-edge.com/2019-08-21/732685848020_f3f20736795184660348_72.png)|Kiara Translation|🇬🇧: shinyu: Demonstrate content created by shinyu and ogwata as something related to this topic|
|05:32|![](https://avatars.slack-edge.com/2019-05-15/624511073651_25909952cd7a069ceed2_72.png)|akabeko|shinyu: VFM と CLI を組み合わせている|
|05:32|![](https://avatars.slack-edge.com/2019-08-21/732685848020_f3f20736795184660348_72.png)|Kiara Translation|🇬🇧: shinyu: Combining VFM and CLI|
|05:33|![](https://avatars.slack-edge.com/2019-05-15/624511073651_25909952cd7a069ceed2_72.png)|akabeko|shinyu: CLI 経由で vivliostyle viewer が起動されて、そこでプレビューされる|
|05:33|![](https://avatars.slack-edge.com/2019-08-21/732685848020_f3f20736795184660348_72.png)|Kiara Translation|🇬🇧: shinyu: The vivliostyle viewer is launched via the CLI and previewed there|
|05:34|![](https://avatars.slack-edge.com/2019-05-15/624511073651_25909952cd7a069ceed2_72.png)|akabeko|shinyu: 原稿を更新すると Browersync により即座にプレビューへ反映される|
|05:34|![](https://avatars.slack-edge.com/2019-08-21/732685848020_f3f20736795184660348_72.png)|Kiara Translation|🇬🇧: shinyu: When the manuscript is updated, Browersync immediately reflects it in the preview.|
|05:35|![](https://avatars.slack-edge.com/2019-05-15/624511073651_25909952cd7a069ceed2_72.png)|akabeko|shinyu: SCSS を編集してもプレビューへ反映される (変更検知の対象としている)|
|05:35|![](https://avatars.slack-edge.com/2019-08-21/732685848020_f3f20736795184660348_72.png)|Kiara Translation|🇬🇧: shinyu: Even if you edit SCSS, it will be reflected in the preview (target for change detection)|
|05:35|![](https://avatars.slack-edge.com/2019-05-15/624511073651_25909952cd7a069ceed2_72.png)|akabeko|SCSS を watch していて、その変換結果としての CSS 出力を監視？|
|05:35|![](https://avatars.slack-edge.com/2019-08-21/732685848020_f3f20736795184660348_72.png)|Kiara Translation|🇬🇧: Are you watching SCSS and watching the resulting CSS output?|
|05:36|![](https://avatars.slack-edge.com/2019-05-15/624511073651_25909952cd7a069ceed2_72.png)|akabeko|shinyu: この機能を CLI にも活かしてほしい|
|05:36|![](https://avatars.slack-edge.com/2019-08-21/732685848020_f3f20736795184660348_72.png)|Kiara Translation|🇬🇧: shinyu: I want this function to be used in the CLI as well.|
|05:36|![](https://avatars.slack-edge.com/2019-05-15/624511073651_25909952cd7a069ceed2_72.png)|akabeko|ogwata: yuku さんのデモをみて、取り込めそうな部分はあるか？|
|05:36|![](https://avatars.slack-edge.com/2019-08-21/732685848020_f3f20736795184660348_72.png)|Kiara Translation|🇬🇧: ogwata: Looking at youku's demo, is there anything you can capture?|
|05:37|![](https://avatars.slack-edge.com/2019-05-15/624511073651_25909952cd7a069ceed2_72.png)|akabeko|spring-raining: SCSSもwatchしているのですねー|
|05:37|![](https://avatars.slack-edge.com/2019-08-21/732685848020_f3f20736795184660348_72.png)|Kiara Translation|🇬🇧: spring-raining: You also watch SCSS, right?|
|05:37|![](https://avatars.slack-edge.com/2019-05-15/624511073651_25909952cd7a069ceed2_72.png)|akabeko|yamasy1549: 卒論書くとき1箇所変更→40回ページを繰る みたいなアホなことしてたのでこれはうれしいですね|
|05:37|![](https://avatars.slack-edge.com/2019-08-21/732685848020_f3f20736795184660348_72.png)|Kiara Translation|🇬🇧: yamasy1549: When I wrote my thesis, I changed one place → I was doing stupid things like turning pages 40 times, so this is nice.|
|05:37|![](https://avatars.slack-edge.com/2019-05-15/624511073651_25909952cd7a069ceed2_72.png)|akabeko|Ayumu Takai: VFM-Viewerは変更した部分だけ更新がかかるという理解で良いですか?|
|05:37|![](https://avatars.slack-edge.com/2019-08-21/732685848020_f3f20736795184660348_72.png)|Kiara Translation|🇬🇧: Ayumu Takai: Is it okay to understand that VFM-Viewer only updates the changed parts?|
|05:38|![](https://avatars.slack-edge.com/2019-05-15/624511073651_25909952cd7a069ceed2_72.png)|akabeko|Ayumu Takai: BrowserSyncは変更したらページ全体をリロードになりますかね?|
|05:38|![](https://avatars.slack-edge.com/2019-08-21/732685848020_f3f20736795184660348_72.png)|Kiara Translation|🇬🇧: Ayumu Takai: Will BrowserSync reload the entire page if I change it?|
|05:38|![](https://avatars.slack-edge.com/2019-05-15/624511073651_25909952cd7a069ceed2_72.png)|akabeko|shinyu: 差分更新なども含めると yuku さんの知見を活かしたい|
|05:38|![](https://avatars.slack-edge.com/2019-08-21/732685848020_f3f20736795184660348_72.png)|Kiara Translation|🇬🇧: shinyu: I want to make use of yuku's knowledge, including diff updates.|
|05:39|![](https://avatars.slack-edge.com/2019-05-15/624511073651_25909952cd7a069ceed2_72.png)|akabeko|yuku: ブラウザーのリロードに頼ると Pub の執筆体験がよろしくない (全体更新になる) ため、VFM-viewer のように差分更新する仕組みがあるとよい|
|05:39|![](https://avatars.slack-edge.com/2019-08-21/732685848020_f3f20736795184660348_72.png)|Kiara Translation|🇬🇧: yuku: If you rely on the reload of the browser, the writing experience of Pub is not good (it will be a whole update), so it would be nice to have a mechanism for differential update like VFM-viewer|
|05:40|![](https://avatars.slack-edge.com/2019-05-15/624511073651_25909952cd7a069ceed2_72.png)|akabeko|Ayumu Takai: ページ位置を保持するのは、VivliostyleViewerを使っていても私の手元でも実装できてます。|
|05:40|![](https://avatars.slack-edge.com/2019-08-21/732685848020_f3f20736795184660348_72.png)|Kiara Translation|🇬🇧: Ayumu Takai: Preserving page position can be implemented either with VivliostyleViewer or at my fingertips.|
|05:40|![](https://avatars.slack-edge.com/2019-05-15/624511073651_25909952cd7a069ceed2_72.png)|akabeko|spring-raining: viewer が Knockout.js で実装されていて開発がきびしい|
|05:40|![](https://avatars.slack-edge.com/2019-08-21/732685848020_f3f20736795184660348_72.png)|Kiara Translation|🇬🇧: spring-raining: viewer is implemented in Knockout.js and development is difficult|
|05:42|![](https://avatars.slack-edge.com/2019-05-15/624511073651_25909952cd7a069ceed2_72.png)|akabeko|shinyu: React などで作り直してもよいが、それを待つ間はバグ修正や機能追加ができない|
|05:42|![](https://avatars.slack-edge.com/2019-08-21/732685848020_f3f20736795184660348_72.png)|Kiara Translation|🇬🇧: shinyu: You can recreate it with React etc., but you can not fix bugs or add functions while waiting for it|
|05:43|![](https://avatars.slack-edge.com/2019-05-15/624511073651_25909952cd7a069ceed2_72.png)|akabeko|shinyu: なので当面は現行の設計で|
|05:43|![](https://avatars.slack-edge.com/2019-08-21/732685848020_f3f20736795184660348_72.png)|Kiara Translation|🇬🇧: shinyu: So for the time being, with the current design|
|05:43|![](https://avatars.slack-edge.com/2019-05-15/624511073651_25909952cd7a069ceed2_72.png)|akabeko|spring-raining: 個人的には React になると嬉しい、そうなると Pub などの実装が効率的になる|
|05:43|![](https://avatars.slack-edge.com/2019-08-21/732685848020_f3f20736795184660348_72.png)|Kiara Translation|🇬🇧: spring-raining: Personally, I'm happy with React, which makes implementations such as Pub more efficient.|
|05:44|![](https://avatars.slack-edge.com/2019-05-15/624511073651_25909952cd7a069ceed2_72.png)|akabeko|yuku: 現状は vfm-viewer も文書全体に更新がかかってしまいます。文書のレンダリングは core で行っているので、そちらに手を加える必要がありそうです。|
|05:45|![](https://avatars.slack-edge.com/2019-05-15/624511073651_25909952cd7a069ceed2_72.png)|akabeko|Ayumu Takai: ありがとうございます。|
|05:45|![](https://avatars.slack-edge.com/2019-08-21/732685848020_f3f20736795184660348_72.png)|Kiara Translation|🇬🇧: Ayumu Takai: Thank you.|
|05:45|![](https://avatars.slack-edge.com/2019-05-15/624511073651_25909952cd7a069ceed2_72.png)|akabeko|spring-raining: yuku さんが cli に PR 出してくれるとうれしい|
|05:45|![](https://avatars.slack-edge.com/2019-08-21/732685848020_f3f20736795184660348_72.png)|Kiara Translation|🇬🇧: spring-raining: I'm glad that youku puts out a PR for cli|
|05:45|![](https://avatars.slack-edge.com/2019-05-15/624511073651_25909952cd7a069ceed2_72.png)|akabeko|yuku: PR を検討します|
|05:45|![](https://avatars.slack-edge.com/2019-08-21/732685848020_f3f20736795184660348_72.png)|Kiara Translation|🇬🇧: yuku: Consider PR|
|05:46|![](https://avatars.slack-edge.com/2019-05-15/624511073651_25909952cd7a069ceed2_72.png)|akabeko|akabeko: いま cli リポジトリーの `master` が `main` になる話があった、他もそうするのか？|
|05:46|![](https://avatars.slack-edge.com/2019-08-21/732685848020_f3f20736795184660348_72.png)|Kiara Translation|🇬🇧: akabeko: Now there was talk of the `master` in the cli repository becoming` main`, will others do so?|
|05:47|![](https://avatars.slack-edge.com/2019-05-15/624511073651_25909952cd7a069ceed2_72.png)|akabeko|takanakahiko: Pub は `main` 移行してもよい、特に `master` へ拘りはない、旗振り役の村上さんにならう|
|05:47|![](https://avatars.slack-edge.com/2019-08-21/732685848020_f3f20736795184660348_72.png)|Kiara Translation|🇬🇧: takanakahiko: Pub may move to `main`, not particularly concerned with` master`, following Mr. Murakami who is the flag waving person|
|05:49|![](https://avatars.slack-edge.com/2019-05-15/624511073651_25909952cd7a069ceed2_72.png)|akabeko|akabeko: VFM も移行可能だが URL のパーマネント性から最初が `master`  だったものは維持したほうがよいと思う|
|05:49|![](https://avatars.slack-edge.com/2019-08-21/732685848020_f3f20736795184660348_72.png)|Kiara Translation|🇬🇧: akabeko: VFM is also migratable, but I think it's better to keep what was initially `master` due to the permanent nature of the URL|
|05:49|![](https://avatars.slack-edge.com/2019-05-15/624511073651_25909952cd7a069ceed2_72.png)|akabeko|shinyu: 既存のものはデフォルト ブランチをそのままに、新しく作られたものは `main` なのでそれを利用|
|05:49|![](https://avatars.slack-edge.com/2019-08-21/732685848020_f3f20736795184660348_72.png)|Kiara Translation|🇬🇧: shinyu: The existing one keeps the default branch, and the newly created one is `main`, so use that|
|05:50|![](https://avatars.slack-edge.com/2019-05-15/624511073651_25909952cd7a069ceed2_72.png)|akabeko|shinyu: 能動的に変更せず、GitHub のデフォルトをそのまま維持する方針|
|05:50|![](https://avatars.slack-edge.com/2019-08-21/732685848020_f3f20736795184660348_72.png)|Kiara Translation|🇬🇧: shinyu: Policy to keep GitHub defaults without actively changing|
|05:50|![](https://avatars.slack-edge.com/2019-05-15/624511073651_25909952cd7a069ceed2_72.png)|akabeko|Ayumu Takai: VivliostyleってElectronアプリの汎用印刷エンジンにもなりうると思っているので、Reactコンポーネントなどとして簡単に活用できるようになるのはとても良いことだと思います。|
|05:50|![](https://avatars.slack-edge.com/2019-08-21/732685848020_f3f20736795184660348_72.png)|Kiara Translation|🇬🇧: Ayumu Takai: I think Vivliostyle can also be a general-purpose printing engine for Electron apps, so I think it's great that it can be easily used as a React component.|
|05:51|![](https://avatars.slack-edge.com/2019-05-15/624511073651_25909952cd7a069ceed2_72.png)|akabeko|spring-raining: デフォルトブランチについて<br>一応GitHubの管轄する範囲ではリダイレクトされそうです <https://github.com/github/renaming><br><blockquote>Guidance for changing the default branch name for GitHub repositories</blockquote>|
|05:51|![](https://avatars.slack-edge.com/2019-08-21/732685848020_f3f20736795184660348_72.png)|Kiara Translation|🇬🇧: spring-raining: about the default branch<br>It seems to be redirected within the jurisdiction of GitHub <https://github.com/github/renaming>|
|05:51|![](https://avatars.slack-edge.com/2019-05-15/624511073651_25909952cd7a069ceed2_72.png)|akabeko|VFM の仕様検討|
|05:51|![](https://avatars.slack-edge.com/2019-08-21/732685848020_f3f20736795184660348_72.png)|Kiara Translation|🇬🇧: VFM specification review|
|05:53|![](https://avatars.slack-edge.com/2019-05-15/624511073651_25909952cd7a069ceed2_72.png)|akabeko|spec: Auto generate HTML section elements · Issue #8 · vivliostyle/vfm<br><https://github.com/vivliostyle/vfm/issues/8><br><blockquote>HTML headings `&lt;h1&gt;` .. `&lt;h6&gt;` create implicit sections. However, using explicit `&lt;section&gt;` elements has an advantage that allows entire sections to be treated differently in CSS.<br><br>*Goals*<br><br>It will be useful if implicit sections created by headings in markdown are converted to explicit `&lt;section&gt;` elements.<br><br>*Prior Art*<br><br><https://pandoc.org/MANUAL.html#option--section-divs|Pandoc Option: --section-divs><br><br><blockquote>Wrap sections in `&lt;section&gt;` tags, and attach identifiers to the enclosing `&lt;section&gt;` rather than the heading itself.</blockquote>Example:<br><br><pre># Chapter 1<br>...<br><br>## Section 1-1<br>...<br><br>### Subsection 1-1-1<br>...<br><br>### Subsection 1-1-2<br>...<br><br>## Section 1-2<br>...<br><br># Chapter 2<br>...</pre><br><br>is converted to the following HTML by `pandoc -t html5 --section-divs`:<br><br><pre>&lt;section id="chapter-1" class="level1"&gt;<br>&lt;h1&gt;Chapter 1&lt;/h1&gt;<br>&lt;p&gt;…&lt;/p&gt;<br>&lt;section id="section-1-1" class="level2"&gt;<br>&lt;h2&gt;Section 1-1&lt;/h2&gt;<br>&lt;p&gt;…&lt;/p&gt;<br>&lt;section id="subsection-1-1-1" class="level3"&gt;<br>&lt;h3&gt;Subsection 1-1-1&lt;/h3&gt;<br>&lt;p&gt;…&lt;/p&gt;<br>&lt;/section&gt;<br>&lt;section id="subsection-1-1-2" class="level3"&gt;<br>&lt;h3&gt;Subsection 1-1-2&lt;/h3&gt;<br>&lt;p&gt;…&lt;/p&gt;<br>&lt;/section&gt;<br>&lt;/section&gt;<br>&lt;section id="section-1-2" class="level2"&gt;<br>&lt;h2&gt;Section 1-2&lt;/h2&gt;<br>&lt;p&gt;…&lt;/p&gt;<br>&lt;/section&gt;<br>&lt;/section&gt;<br>&lt;section id="chapter-2" class="level1"&gt;<br>&lt;h1&gt;Chapter 2&lt;/h1&gt;<br>&lt;p&gt;…&lt;/p&gt;<br>&lt;/section&gt;</pre><br><br>*Discussion*<br><br>The conversion with <https://pandoc.org/MANUAL.html#option--section-divs|Pandoc Option: --section-divs> may have the following issues:<br><br>• The level 1 heading maybe should not be wrapped with `&lt;section&gt;` because this is usually the top level heading of `&lt;body&gt;`.<br>• Headings maybe should not be wrapped with `&lt;section&gt;` when already wrapped in a section element (with <https://github.com/vivliostyle/vfm/issues/4|HTML blocks> or <https://github.com/vivliostyle/vfm/issues/5|Fenced blocks>) that has same or deeper level of the heading, or when placed in HTML elements other than sectioning elements `article`, `aside`, `nav`, or `section`.<br><br>*Update (2021-01-13)*: It may need further consideration, but at this point I think it's best to make it compatible with Pandoc's `--section-divs` feature.</blockquote>|
|05:53|![](https://avatars.slack-edge.com/2019-08-21/732685848020_f3f20736795184660348_72.png)|Kiara Translation|🇯🇵: 仕様：HTMLセクション要素の自動生成・問題＃8・vivliostyle / vfm<br><https://github.com/vivliostyle/vfm/issues/8>|
|05:53|![](https://avatars.slack-edge.com/2019-05-15/624511073651_25909952cd7a069ceed2_72.png)|akabeko|shinyu: 現在の仕様はだいたい <https://pandoc.org/MANUAL.html#option--section-divs> に基づいている|
|05:53|![](https://avatars.slack-edge.com/2019-08-21/732685848020_f3f20736795184660348_72.png)|Kiara Translation|🇬🇧: shinyu: The current spec is mostly based on <https://pandoc.org/MANUAL.html#option--section-divs>|
|05:54|![](https://avatars.slack-edge.com/2019-05-15/624511073651_25909952cd7a069ceed2_72.png)|akabeko|shinyu: 実際に動作を比較すると Pandoc の挙動が色々と異なる|
|05:54|![](https://avatars.slack-edge.com/2019-08-21/732685848020_f3f20736795184660348_72.png)|Kiara Translation|🇬🇧: shinyu: Pandoc behaves differently when you actually compare the behavior|
|05:55|![](https://avatars.slack-edge.com/2019-05-15/624511073651_25909952cd7a069ceed2_72.png)|akabeko|当該 issue の「現状の vfm と Pandoc `--section-divs` の動作の比較評価」を参照のこと|
|05:55|![](https://avatars.slack-edge.com/2019-08-21/732685848020_f3f20736795184660348_72.png)|Kiara Translation|🇬🇧: See "Comparison Evaluation of Current Vfm and Pandoc` --section-divs` Behavior "in the issue.|
|06:03|![](https://avatars.slack-edge.com/2019-05-15/624511073651_25909952cd7a069ceed2_72.png)|akabeko|akabeko: 現在の VFM 構文パーサーは基本的にひとつの構文を個別処理するもので、他の構文との相関はあまり意識されていない|
|06:03|![](https://avatars.slack-edge.com/2019-08-21/732685848020_f3f20736795184660348_72.png)|Kiara Translation|🇬🇧: akabeko: The current VFM syntax parser basically processes one syntax individually and is not very aware of its correlation with other syntaxes.|
|06:04|![](https://avatars.slack-edge.com/2019-05-15/624511073651_25909952cd7a069ceed2_72.png)|akabeko|akabeko: そのため別の構文や階層を意識した処理をする場合、他で処理された AST を加工する必要がある<br>これはかなりの大改造となるだろう|
|06:04|![](https://avatars.slack-edge.com/2019-08-21/732685848020_f3f20736795184660348_72.png)|Kiara Translation|🇬🇧: akabeko: Therefore, if you want to process with different syntax or hierarchy, you need to process AST processed by others.<br>This will be a significant remodeling|
|06:04|![](https://avatars.slack-edge.com/2019-05-15/624511073651_25909952cd7a069ceed2_72.png)|akabeko|akabeko: remark-parse v9 対応も視野に入れると更に難題|
|06:04|![](https://avatars.slack-edge.com/2019-08-21/732685848020_f3f20736795184660348_72.png)|Kiara Translation|🇬🇧: akabeko: Remark-parse v9 support is even more difficult when considering|
|06:05|![](https://avatars.slack-edge.com/2019-05-15/624511073651_25909952cd7a069ceed2_72.png)|akabeko|spec: Attributes on headings and other elements · Issue #9 · vivliostyle/vfm<br><https://github.com/vivliostyle/vfm/issues/9><br><blockquote>*Goals*<br><br>For effective CSS styling, we need to add attributes on headings and other elements.<br><br>*Prior Art*<br><br><https://michelf.ca/projects/php-markdown/extra/|PHP Markdown Extra> defines <https://michelf.ca/projects/php-markdown/extra/#spe-attr|Special Attributes>:<br><br><blockquote>*Special Attributes*<br><br>With Markdown Extra, you can set the id and class attribute on certain elements using an attribute block. For instance, put the desired id prefixed by a hash inside curly brackets after the header at the end of the line, like this:<br><br><pre>Header 1            {#header1}<br>========<br><br>## Header 2 ##      {#header2}<br></pre><br><br>Then you can create links to different parts of the same document like this:<br><br><pre>[Link back to header 1](#header1)<br></pre><br><br>To add a class name, which can be used as a hook for a style sheet, use a dot like this:<br><br><pre>## The Site ##    {.main}<br></pre><br><br>You can also add custom attributes having simple values by specifying the attribute name, followed by an equal sign, followed by the value (which cannot contain spaces at this time):<br><br><pre>## Le Site ##    {lang=fr}<br></pre><br><br>The id, multiple class names, and other custom attributes can be combined by putting them all into the same special attribute block:<br><br><pre>## Le Site ##    {.main .shine #the-site lang=fr}<br></pre><br><br>At this time, special attribute blocks can be used with<br><br>• headers,<br>• fenced code blocks,<br>• links, and<br>• images.<br><br>…</blockquote><https://pandoc.org/MANUAL.html#pandocs-markdown|Pandoc’s Markdown> defines extensions for attributes, compatible with PHP Markdown Extra's <https://michelf.ca/projects/php-markdown/extra/#spe-attr|Special Attributes> and further extended:<br><br>• Headings<br>    • <https://pandoc.org/MANUAL.html#extension-header_attributes|Extension: header_attributes><br>• Fenced code blocks<br>    • <https://pandoc.org/MANUAL.html#extension-fenced_code_attributes|Extension: fenced_code_attributes><br>• Inline code<br>    • <https://pandoc.org/MANUAL.html#extension-inline_code_attributes|Extension: inline_code_attributes><br>• Links<br>    • <https://pandoc.org/MANUAL.html#extension-link_attributes|Extension: link_attributes><br>• Fenced blocks<br>    • <https://pandoc.org/MANUAL.html#extension-fenced_divs|Extension: fenced_divs><br>• Inlines<br>    • <https://pandoc.org/MANUAL.html#extension-bracketed_spans|Extension: bracketed_spans><br>    • Example: `[This is *some text*]{.class key="val"}`<br><br>*Discussion*<br><br>Related issues:<br><br>• <https://github.com/vivliostyle/vfm/issues/5|spec: Fenced blocks><br>• <https://github.com/vivliostyle/vfm/issues/8|spec: Auto generate HTML section elements><br>    • &lt;<https://github.com/vivliostyle/vfm/issues/8#issuecomment-578662720%7CGenerated> `&lt;section&gt;` with attributes&gt;</blockquote>|
|06:05|![](https://avatars.slack-edge.com/2019-08-21/732685848020_f3f20736795184660348_72.png)|Kiara Translation|🇯🇵: 仕様：見出しおよびその他の要素の属性・問題＃9・vivliostyle / vfm<br><https://github.com/vivliostyle/vfm/issues/9>|
|06:06|![](https://avatars.slack-edge.com/2019-05-15/624511073651_25909952cd7a069ceed2_72.png)|akabeko|akabeko: 現時点の属性処理は以下を利用しています<br>remark-attr - npm<br><https://www.npmjs.com/package/remark-attr?activeTab=readme><br><blockquote>Add support of custom attributes to Markdown syntax.</blockquote>|
|06:06|![](https://avatars.slack-edge.com/2019-08-21/732685848020_f3f20736795184660348_72.png)|Kiara Translation|🇬🇧: akabeko: The current attribute processing uses the following<br>remark-attr --npm<br><https://www.npmjs.com/package/remark-attr?activeTab=readme>|
|06:09|![](https://avatars.slack-edge.com/2019-05-15/624511073651_25909952cd7a069ceed2_72.png)|akabeko|ogwata: 全体的な方針として remark の処理で Pandoc にあっていないものはフルスクラッチするのか？|
|06:09|![](https://avatars.slack-edge.com/2019-08-21/732685848020_f3f20736795184660348_72.png)|Kiara Translation|🇬🇧: ogwata: The overall policy is to fully scratch remarks that aren't in Pandoc?|
|06:10|![](https://avatars.slack-edge.com/2019-05-15/624511073651_25909952cd7a069ceed2_72.png)|akabeko|spec: &lt;figure&gt; for image container · Issue #15 · vivliostyle/vfm<br><https://github.com/vivliostyle/vfm/issues/15><br><blockquote>*Goals*<br><br><pre>![Sample](./sample.png)</pre><br><br><pre>&lt;figure&gt;<br>  &lt;img src="./sample.png" alt="Sample"&gt;<br>  &lt;figcaption&gt;Sample&lt;/figcaption&gt;<br>&lt;/figure&gt;</pre><br><br>*Image with anchors*<br><br><pre>![Sample Image](./sample.png){#fig:sample}</pre><br><br><pre>&lt;figure&gt;<br>  &lt;img src="./sample.png" alt="Sample Image" data-ref="fig" id="sample"&gt;<br>  &lt;figcaption&gt;Sample Image&lt;/figcaption&gt;<br>&lt;/figure&gt;</pre><br><br>*Image without caption*<br><br><pre>![](./sample.png)</pre><br><br><pre>&lt;figure&gt;<br>  &lt;img src="./sample.png"&gt;<br>&lt;/figure&gt;</pre><br><br>or<br><br><pre>&lt;img src="./sample.png"&gt;</pre><br><br>*Discussion*<br><br>It might be related to <https://github.com/vivliostyle/vfm/issues/11|cross-ref>.</blockquote>|
|06:11|![](https://avatars.slack-edge.com/2019-08-21/732685848020_f3f20736795184660348_72.png)|Kiara Translation|🇯🇵: 仕様：＆lt;図＆gt;画像コンテナ用・問題＃15・vivliostyle / vfm<br><https://github.com/vivliostyle/vfm/issues/15>|
|06:11|![](https://avatars.slack-edge.com/2019-05-15/624511073651_25909952cd7a069ceed2_72.png)|akabeko|spec: Fenced blocks · Issue #5 · vivliostyle/vfm<br><https://github.com/vivliostyle/vfm/issues/5><br><blockquote>Adopt *fenced divs* from Pandoc's Markdown, that allows special fenced syntax for `div` blocks.  <br>See the spec: <https://pandoc.org/MANUAL.html#extension-fenced_divs|Pandoc Extension: fenced_divs><br><br><blockquote>... As with fenced code blocks, one can use either attributes in curly braces or a single unbraced word, which will be treated as a class name. The Div ends with another line containing a string of at least three consecutive colons. The fenced Div should be separated by blank lines from preceding and following blocks.<br><br>Example:<br><br><pre>::::: {#special .sidebar}<br>Here is a paragraph.<br><br>And another.<br>:::::<br></pre><br><br>Fenced divs can be nested. Opening fences are distinguished because they _must_ have attributes:<br><br><pre>::: Warning ::::::<br>This is a warning.<br><br>::: Danger<br>This is a warning within a warning.<br>:::<br>::::::::::::::::::<br></pre><br><br>Fences without attributes are always closing fences. Unlike with fenced code blocks, the number of colons in the closing fence need not match the number in the opening fence. ...</blockquote>*Discussion*<br><br>This "fenced divs" syntax is very similar to the <https://github.com/vivliostyle/vfm/blob/427f390d188a9e2a1a575d3bf5d279a141ae87a1/spec/vfm.md#walled-block|walled block> in the current VFM draft. I prefer "fenced divs" because:<br><br>• naming: "fenced divs" is better, because the term "fenced" is consistent with "fenced code blocks".<br>• colons `:::` is better than `===`, because `===` is used for <https://github.github.com/gfm/#setext-heading-underline|setext heading underline> and will make confusion.<br>• the attribute syntax, same as the <https://pandoc.org/MANUAL.html#extension-fenced_code_attributes|fenced code attributes>, enables adding arbitrary attributes</blockquote>|
|06:11|![](https://avatars.slack-edge.com/2019-08-21/732685848020_f3f20736795184660348_72.png)|Kiara Translation|🇯🇵: 仕様：フェンスで囲まれたブロック・問題＃5・vivliostyle / vfm<br><https://github.com/vivliostyle/vfm/issues/5>|
|06:23|![](https://avatars.slack-edge.com/2019-05-15/624511073651_25909952cd7a069ceed2_72.png)|akabeko|spring-raining: もともと VFM は <https://github.com/vivliostyle/themes/issues/23> などの実装をプラグイン的に書きやすくする目的があった<br><blockquote>テーマ独自の記法を使えるようにするため、themesにreplace用のスクリプトをもたせる<br><br>例：<br><br>• 句点をピリオドに置換する<br>• 対話形式のテキストを書きやすくする</blockquote>|
|06:23|![](https://avatars.slack-edge.com/2019-08-21/732685848020_f3f20736795184660348_72.png)|Kiara Translation|🇬🇧: spring-raining: Originally VFM was intended to make implementations such as <https://github.com/vivliostyle/themes/issues/23> easier to write as plugins.|
|06:25|![](https://avatars.slack-edge.com/2019-05-15/624511073651_25909952cd7a069ceed2_72.png)|akabeko|shinyu: Fenced Block 実装は現時点だと Pandoc 仕様に対して中途半端なので、いったんドロップするのはどうか？|
|06:25|![](https://avatars.slack-edge.com/2019-08-21/732685848020_f3f20736795184660348_72.png)|Kiara Translation|🇬🇧: shinyu: The Fenced Block implementation is currently halfway to the Pandoc spec, so why not drop it?|
|06:25|![](https://avatars.slack-edge.com/2019-05-15/624511073651_25909952cd7a069ceed2_72.png)|akabeko|spec: WAI-ARIA role syntax · Issue #28 · vivliostyle/vfm<br><https://github.com/vivliostyle/vfm/issues/28><br><blockquote><https://github.com/vivliostyle/vfm/blob/master/docs/vfm.md#wai-aria-role|https://github.com/vivliostyle/vfm/blob/master/docs/vfm.md#wai-aria-role><br><br><blockquote>*VFM*<br><br><pre># Table of Contents {@toc}</pre><br><br>*HTML*<br><br><pre>&lt;nav id="table-of-contents" role="doc-toc"&gt;<br>  &lt;h1&gt;Table of Contents&lt;/h1&gt;<br>&lt;/nav&gt;</pre></blockquote>The `doc-` prefix of <https://www.w3.org/TR/dpub-aria-1.0/#roles|Digital Publishing WAI-ARIA roles> should not be ommited in the VFM syntax. We should use `{@doc-toc}` for `role="doc-toc"` because:<br><br>• for consistency with CSS rules, `[role="doc-toc"]`. Using same role name is better to understand<br>• for extensibility to be able to specify roles other than `doc-*`</blockquote>|
|06:25|![](https://avatars.slack-edge.com/2019-08-21/732685848020_f3f20736795184660348_72.png)|Kiara Translation|🇯🇵: 仕様：WAI-ARIAロール構文・問題＃28・vivliostyle / vfm<br><https://github.com/vivliostyle/vfm/issues/28>|
|06:27|![](https://avatars.slack-edge.com/2019-05-15/624511073651_25909952cd7a069ceed2_72.png)|akabeko|shinyu: ロール構文のドロップを考えている|
|06:27|![](https://avatars.slack-edge.com/2019-08-21/732685848020_f3f20736795184660348_72.png)|Kiara Translation|🇬🇧: shinyu: I'm thinking of dropping the role syntax|
|06:27|![](https://avatars.slack-edge.com/2019-05-15/624511073651_25909952cd7a069ceed2_72.png)|akabeko|spring-raining: 変換結果をこうしてほしいというのは村上さんが詳しいので、テストコードを村上さんに用意してほしい|
|06:27|![](https://avatars.slack-edge.com/2019-08-21/732685848020_f3f20736795184660348_72.png)|Kiara Translation|🇬🇧: spring-raining: Mr. Murakami is familiar with wanting the conversion result like this, so I want Mr. Murakami to prepare the test code.|
|06:29|![](https://avatars.slack-edge.com/2019-05-15/624511073651_25909952cd7a069ceed2_72.png)|akabeko|akabeko: テストコードだけ PR され、その時点ではテストが落ちる状態 (もしくは除外) して後から対応してゆく？|
|06:29|![](https://avatars.slack-edge.com/2019-08-21/732685848020_f3f20736795184660348_72.png)|Kiara Translation|🇬🇧: akabeko: Only the test code will be publicized, and at that point the test will fail (or be excluded) and will be dealt with later?|
|06:30|![](https://avatars.slack-edge.com/2019-05-15/624511073651_25909952cd7a069ceed2_72.png)|akabeko|takanakahiko: テストコードとして仕様が明示されるので issue や口頭の議論よりも効率的|
|06:30|![](https://avatars.slack-edge.com/2019-08-21/732685848020_f3f20736795184660348_72.png)|Kiara Translation|🇬🇧: takanakahiko: More efficient than issue or oral discussion because the specification is specified as test code|
|06:30|![](https://avatars.slack-edge.com/2019-05-15/624511073651_25909952cd7a069ceed2_72.png)|akabeko|spring-raining: テストコードでなくてもよいかもしれない。変換前後がテキストとして明示されていればよい|
|06:30|![](https://avatars.slack-edge.com/2019-08-21/732685848020_f3f20736795184660348_72.png)|Kiara Translation|🇬🇧: spring-raining: It may not be the test code. Before and after conversion should be clearly stated as text|
|06:39|![](https://avatars.slack-edge.com/2019-05-15/624511073651_25909952cd7a069ceed2_72.png)|akabeko|yuku: 参考 <https://github.com/markedjs/marked/tree/master/test/specs/redos>|
|06:39|![](https://avatars.slack-edge.com/2019-08-21/732685848020_f3f20736795184660348_72.png)|Kiara Translation|🇬🇧: yuku: Reference <https://github.com/markedjs/marked/tree/master/test/specs/redos>|
|06:41|![](https://avatars.slack-edge.com/2019-05-15/624511073651_25909952cd7a069ceed2_72.png)|akabeko|spring-raining: 仕様検討の案 <https://github.com/vivliostyle/vfm/pull/65/files>|
|06:41|![](https://avatars.slack-edge.com/2019-08-21/732685848020_f3f20736795184660348_72.png)|Kiara Translation|🇬🇧: spring-raining: Proposal for specification review <https://github.com/vivliostyle/vfm/pull/65/files>|
|06:44|![](https://avatars.slack-edge.com/2019-05-15/624511073651_25909952cd7a069ceed2_72.png)|akabeko|shinyu 「HTML 要素名を明示的に指定可能にする拡張案」などの是非についてどうするか？|
|06:44|![](https://avatars.slack-edge.com/2019-08-21/732685848020_f3f20736795184660348_72.png)|Kiara Translation|🇬🇧: shinyu What do you do about the pros and cons of "extension plan that allows you to explicitly specify HTML element names"?|
|06:45|![](https://avatars.slack-edge.com/2019-05-15/624511073651_25909952cd7a069ceed2_72.png)|akabeko|shinyu: サンプルを PR する方法だとこのような議論はどうするのか？|
|06:45|![](https://avatars.slack-edge.com/2019-08-21/732685848020_f3f20736795184660348_72.png)|Kiara Translation|🇬🇧: shinyu: What about this kind of discussion when it comes to PRing samples?|
|06:45|![](https://avatars.slack-edge.com/2019-05-15/624511073651_25909952cd7a069ceed2_72.png)|akabeko|spring-raining: サンプル PR でも議論は可能、これは補完的なものなので Issue からリンクするなど組み合わせて使う|
|06:45|![](https://avatars.slack-edge.com/2019-08-21/732685848020_f3f20736795184660348_72.png)|Kiara Translation|🇬🇧: spring-raining: It is possible to discuss with the sample PR, but since this is complementary, use it in combination such as linking from Issue|
|06:46|![](https://avatars.slack-edge.com/2019-05-15/624511073651_25909952cd7a069ceed2_72.png)|akabeko|spring-raining: 曖昧な議論は Issue、具体的になったらファイルの PR|
|06:46|![](https://avatars.slack-edge.com/2019-08-21/732685848020_f3f20736795184660348_72.png)|Kiara Translation|🇬🇧: spring-raining: Ambiguous discussion is Issue, file PR when concrete|
|06:47|![](https://avatars.slack-edge.com/2019-05-15/624511073651_25909952cd7a069ceed2_72.png)|akabeko|<https://github.com/vivliostyle/vfm/issues/38><br><blockquote>*Describe the bug*  <br>svgタグをVFM内に直接記述した場合、タグ内部の改行がbrタグに変換されます<br><br>*To Reproduce*<br><br>入力<br><br><pre>&lt;svg xmlns="http://www.w3.org/2000/svg" version="1.1"<br> xmlns:xlink="http://www.w3.org/1999/xlink"<br> width="100%" height="100%" viewBox="0 0 3000 3000"&gt;<br>&lt;image width="3000" height="3000" xlink:href="../image/cover.jpg"/&gt;<br>&lt;/svg&gt;<br><br></pre><br><br>出力<br><br><pre><!doctype html><br>&lt;html lang="ja"&gt;<br>&lt;head&gt;<br>&lt;meta charset="utf-8"&gt;<br>&lt;meta name="viewport" content="width=device-width, initial-scale=1"&gt;<br>&lt;/head&gt;<br>&lt;body&gt;<br>&lt;p&gt;&lt;svg xmlns="http://www.w3.org/2000/svg" version="1.1" xmlns:xlink="http://www.w3.org/1999/xlink" width="100%" height="100%" viewBox="0 0 3000 3000"&gt;&lt;br&gt;&lt;/br&gt;<br>&lt;image width="3000" height="3000" xlink:href="../image/cover.jpg"&gt;&lt;/image&gt;&lt;br&gt;&lt;/br&gt;<br>&lt;/svg&gt;&lt;/p&gt;<br>&lt;/body&gt;<br>&lt;/html&gt;<br></pre><br><br>上記のように、svgタグ内の改行がbrタグに変換されています。<br><br>*Expected behavior*<br><br>改行がbrタグに変換されず、以下のように出力されるのが期待される結果です。<br><br><pre><!doctype html><br>&lt;html lang="ja"&gt;<br>&lt;head&gt;<br>&lt;meta charset="utf-8"&gt;<br>&lt;meta name="viewport" content="width=device-width, initial-scale=1"&gt;<br>&lt;/head&gt;<br>&lt;body&gt;<br>&lt;p&gt;&lt;svg xmlns="http://www.w3.org/2000/svg" version="1.1" xmlns:xlink="http://www.w3.org/1999/xlink" width="100%" height="100%" viewBox="0 0 3000 3000"&gt;<br>&lt;image width="3000" height="3000" xlink:href="../image/cover.jpg"&gt;&lt;/image&gt;<br>&lt;/svg&gt;&lt;/p&gt;<br>&lt;/body&gt;<br>&lt;/html&gt;<br></pre><br><br>*Additional context*<br><br>Markdownの中でインラインSVGを使用するケース自体がレアかもしれませんが、今回のケースでは、EPUBと印刷物の制作を一つのmarkdownから行うことを目的として、電書協やKADOKAWAのepub制作ガイドラインで推奨されている「SVGラッピング」と呼ばれる手法を用いる必要があったためインラインSVGを使用したものです。<br><br>svgタグの内部に改行を含めないようにすることで回避可能ですが、うっかり改行によりbrタグが入り込んでいてもビューワによって挙動が異なるため、気付かないリスクがあります。例えば、Chrome上のVivliostyle Viewerでは恐らくbrタグがあっても正常に表示されますが、Kindle Previewerなどでは異常な表示となります。<br><br>電子書籍と印刷物をワンソースで制作するというのはVFMの想定ユースケースとそれほどズレないと思いますので、svgタグ内部の改行をbrタグに変換しないようにするという対応が必要と考えます。<br><br>加えて、 画像の構文`![xxx](./path/to/img)`を拡張してSVGラッピングでレンダリングされるオプションを追加する（例：`![xxx](./path/to/img =3000x3000,svg)`）というような対応があると便利かもしれません。ただ、SVGラッピング自体が過渡的なハックに過ぎないようにも思えるため、あえてVFMの構文の仕様を弄るべきかというとかなり微妙なような気もします。</blockquote>|
|06:47|![](https://avatars.slack-edge.com/2019-08-21/732685848020_f3f20736795184660348_72.png)|Kiara Translation|🇬🇧: <https://github.com/vivliostyle/vfm/issues/38><br>🇯🇵: <https://github.com/vivliostyle/vfm/issues/38>|
|06:48|![](https://avatars.slack-edge.com/2019-05-15/624511073651_25909952cd7a069ceed2_72.png)|akabeko|<https://spec.commonmark.org/0.29/#html-blocks>|
|06:48|![](https://avatars.slack-edge.com/2019-08-21/732685848020_f3f20736795184660348_72.png)|Kiara Translation|🇬🇧: <https://spec.commonmark.org/0.29/#html-blocks><br>🇯🇵: <https://spec.commonmark.org/0.29/#html-blocks>|
|06:58|![](https://avatars.slack-edge.com/2019-05-15/624511073651_25909952cd7a069ceed2_72.png)|akabeko|akabeko: remark 側にあげて却下された issue はこれです <https://github.com/remarkjs/remark/issues/618><br><blockquote>*Subject of the issue*<br><br>The contents of the `&lt;svg&gt;` and `&lt;math&gt;` tags are not a single `html`, but are split into separate `text` and `html` for each element. The `&lt;table&gt;` and `&lt;a&gt;` tags, including their children, are a single `html`.<br><br>The problem with this behavior is that if a newline in `&lt;svg&gt;` becomes `text` due to splitting, it will be processed by `remark-breaks` and `&lt;br&gt;` will be inserted.<br><br>*Your environment*<br><br>• *OS*: macOS Big Sur 11.1 (20C69)<br>• *Packages*:<br>• remark-parse 9.0.0<br>• remark-gfm 1.0.0<br>• unified 9.2.0<br>• *Env*:<br>• Node.js 15.6.0<br>• npm 7.4.0<br><br>*Steps to reproduce*<br><br>I've prepared a project for verification, so I think it's easy to check with this. Can check the phenomenon of this issue by setting up and executing according to the `README.md`.<br><br>• <https://github.com/akabekobeko/test-remark-parse-html|akabekobeko/test-remark-parse-html><br><br>*Expected behavior*<br><br>`&lt;svg&gt;` and `&lt;math&gt;` are parsed as a single `html` like any other tag.<br><br>*Actual behavior*<br><br>The parse result for the `&lt;svg&gt;` and `&lt;math&gt;` tags does not result in a single `html`. Child and closing tags are split into separate `html` and `text`. Below is the output formatted by `unist-util-inspect`.<br><br><pre>root[6]<br>├─0 html "&lt;table&gt;\n&lt;tbody&gt;\n  &lt;tr&gt;&lt;td&gt;aaa&lt;/td&gt;&lt;/tr&gt;\n&lt;/tbody&gt;\n&lt;/table&gt;"<br>├─1 html "&lt;iframe&gt;\ntest\n&lt;/iframe&gt;"<br>├─2 html "&lt;div&gt;\naaaaa\n&lt;/div&gt;"<br>├─3 html "&lt;a href=\"sample.jpg\"&gt;\ntest\n&lt;/a&gt;"<br>├─4 paragraph[3]<br>│   ├─0 html "&lt;svg xmlns=\"http://www.w3.org/2000/svg\" version=\"1.1\" xmlns:xlink=\"http://www.w3.org/1999/xlink\" width=\"100%\" height=\"100%\" viewBox=\"0 0 3000 3000\"&gt;"<br>│   ├─1 html "&lt;image width=\"3000\" height=\"3000\" xlink:href=\"../image/cover.jpg\"/&gt;"<br>│   └─2 html "&lt;/svg&gt;"<br>└─5 paragraph[36]<br>    ├─0 html "&lt;math&gt;"<br>    ├─1 html "&lt;mrow&gt;"<br>    ├─2 html "&lt;mrow&gt;"<br>    ├─3 html "&lt;msup&gt;"<br>    ├─4 html "&lt;mi&gt;"<br>    ├─5 text "a"<br>    ├─6 html "&lt;/mi&gt;"<br>    ├─7 html "&lt;mn&gt;"<br>    ├─8 text "2"<br>    ├─9 html "&lt;/mn&gt;"<br>    ├─10 html "&lt;/msup&gt;"<br>    ├─11 html "&lt;mo&gt;"<br>    ├─12 text "+"<br>    ├─13 html "&lt;/mo&gt;"<br>    ├─14 html "&lt;msup&gt;"<br>    ├─15 html "&lt;mi&gt;"<br>    ├─16 text "b"<br>    ├─17 html "&lt;/mi&gt;"<br>    ├─18 html "&lt;mn&gt;"<br>    ├─19 text "2"<br>    ├─20 html "&lt;/mn&gt;"<br>    ├─21 html "&lt;/msup&gt;"<br>    ├─22 html "&lt;/mrow&gt;"<br>    ├─23 html "&lt;mo&gt;"<br>    ├─24 text "="<br>    ├─25 html "&lt;/mo&gt;"<br>    ├─26 html "&lt;msup&gt;"<br>    ├─27 html "&lt;mi&gt;"<br>    ├─28 text "c"<br>    ├─29 html "&lt;/mi&gt;"<br>    ├─30 html "&lt;mn&gt;"<br>    ├─31 text "2"<br>    ├─32 html "&lt;/mn&gt;"<br>    ├─33 html "&lt;/msup&gt;"<br>    ├─34 html "&lt;/mrow&gt;"<br>    └─35 html "&lt;/math&gt;"<br></pre></blockquote>|
|06:58|![](https://avatars.slack-edge.com/2019-08-21/732685848020_f3f20736795184660348_72.png)|Kiara Translation|🇬🇧: akabeko: This is the issue that was rejected on the remark side <https://github.com/remarkjs/remark/issues/618>|
|07:02|![](https://avatars.slack-edge.com/2019-05-15/624511073651_25909952cd7a069ceed2_72.png)|akabeko|shinyu: 修正する方向で検討する、しかし全タグに適用するのは危ないのでは？|
|07:02|![](https://avatars.slack-edge.com/2019-08-21/732685848020_f3f20736795184660348_72.png)|Kiara Translation|🇬🇧: shinyu: I'll consider fixing it, but isn't it dangerous to apply it to all tags?|
|07:03|![](https://avatars.slack-edge.com/2019-05-15/624511073651_25909952cd7a069ceed2_72.png)|akabeko|shinyu: <https://github.com/vivliostyle/vfm/issues/4> に影響するのでは？<br><blockquote>How to enable markdown inside HTML blocks? There are differences between major Markdown dialects:<br><br>• Pandoc Markdown: markdown is enabled by default inside HTML blocks<br>    • See: <https://pandoc.org/MANUAL.html#extension-markdown_in_html_blocks|Pandoc Extension: markdown_in_html_blocks><br>• GFM and CommonMark: markdown is enabled if there is a blank line after the start tag<br>    • See: <https://github.github.com/gfm/#html-blocks|GFM Spec: HTML blocks><br>• PHP Markdown Extra: markdown is enabled if `markdown="1"` is added in the start tag<br>    • See: <https://michelf.ca/projects/php-markdown/extra/#markdown-attr|PHP Markdown Extra: Markdown Inside HTML Blocks><br><br>I think Pandoc Markdown's method is most useful and easy to understand.<br><br>Examples:<br><br><pre>&lt;div class="foo"&gt;<br>* Here, markdown is **enabled** in Pandoc Markdown<br>&lt;/div&gt;</pre><br><br><pre>&lt;div class="foo"&gt;<br><br>* Here, markdown is **enabled** in GFM and CommonMark<br>&lt;/div&gt;</pre><br><br><pre>&lt;div class="foo" markdown="1"&gt;<br>* Here, markdown is **enabled** in PHP Markdown Extra<br>&lt;/div&gt;</pre></blockquote>|
|07:03|![](https://avatars.slack-edge.com/2019-08-21/732685848020_f3f20736795184660348_72.png)|Kiara Translation|🇬🇧: shinyu: Does it affect <https://github.com/vivliostyle/vfm/issues/4>?|
|07:06|![](https://avatars.slack-edge.com/2019-05-15/624511073651_25909952cd7a069ceed2_72.png)|akabeko|これは Issue で継続議論します|
|07:07|![](https://avatars.slack-edge.com/2019-08-21/732685848020_f3f20736795184660348_72.png)|Kiara Translation|🇬🇧: This will continue to be discussed in Issue|
|07:07|![](https://avatars.slack-edge.com/2019-05-15/624511073651_25909952cd7a069ceed2_72.png)|akabeko|vivliostyle.js v2.5 で予定する更新内容について報告|
|07:08|![](https://avatars.slack-edge.com/2019-08-21/732685848020_f3f20736795184660348_72.png)|Kiara Translation|🇬🇧: Report on upcoming updates in vivliostyle.js v2.5|
|07:08|![](https://avatars.slack-edge.com/2019-05-15/624511073651_25909952cd7a069ceed2_72.png)|akabeko|feat(viewer): Configuration flags update by MurakamiShinyu · Pull Request #693 · vivliostyle/vivliostyle.js<br><https://github.com/vivliostyle/vivliostyle.js/pull/693><br><blockquote>Update to the previous pr <https://github.com/vivliostyle/vivliostyle.js/pull/692|#692><br><br>Configuration flags can be specified with the `data-vivliostyle-viewer-flags`  <br>attribute on the vivliostyle-viewer root element or the `flags` URL parameter.  <br>e.g.,<br><br><pre>&lt;html data-vivliostyle-viewer-flags="SZba" data-vivliostyle-paginated="true"&gt;<br></pre><br><br>or<br><br><pre><https://vivliostyle.org/viewer/#src=https://example.com/&amp;flags=BAp><br></pre><br><br>Flags:<br><br>• "S": disableSettings<br>    • "P": disablePageStyleChange<br>    • "V": disablePageViewModeChange<br>    • "B": disableBookModeChange<br>    • "A": disableRenderAllPagesChange<br>• "T": disableTOCNavigation<br>• "N": disablePageNavigation<br>• "Z": disableZoom<br>• "F": disableFontSizeChange<br>• "s": disablePageSlider<br>• "c": disableContextMenu<br>• "p": disablePrint<br>• "b": defaultBookMode<br>• "a": undefaultRenderAllPages</blockquote>|
|07:08|![](https://avatars.slack-edge.com/2019-08-21/732685848020_f3f20736795184660348_72.png)|Kiara Translation|🇯🇵: feat（viewer）：MurakamiShinyuによる構成フラグの更新・プルリクエスト＃693・vivliostyle / vivliostyle.js<br><https://github.com/vivliostyle/vivliostyle.js/pull/693>|
|07:11|![](https://avatars.slack-edge.com/2019-05-15/624511073651_25909952cd7a069ceed2_72.png)|akabeko|shinyu: これは一文字のフラグを組み合わせて viewer の挙動を制御するもの|
|07:11|![](https://avatars.slack-edge.com/2019-08-21/732685848020_f3f20736795184660348_72.png)|Kiara Translation|🇬🇧: shinyu: This is a combination of single-letter flags to control the behavior of the viewer|
|07:12|![](https://avatars.slack-edge.com/2019-05-15/624511073651_25909952cd7a069ceed2_72.png)|akabeko|shinyu: 基本的に viewer の機能を制限するもの、例えばサイドバーやメニューの非表示など|
|07:12|![](https://avatars.slack-edge.com/2019-08-21/732685848020_f3f20736795184660348_72.png)|Kiara Translation|🇬🇧: shinyu: Basically things that limit the functionality of the viewer, such as hiding the sidebar and menus|
|07:13|![](https://avatars.slack-edge.com/2019-05-15/624511073651_25909952cd7a069ceed2_72.png)|akabeko|break-before:left/right at beginning of a document does not work properly · Issue #666 · vivliostyle/vivliostyle.js<br><https://github.com/vivliostyle/vivliostyle.js/issues/666><br><blockquote>CSS Paged Media spec <https://drafts.csswg.org/css-page-3/#progression|https://drafts.csswg.org/css-page-3/#progression> says:<br><br><blockquote>… To explicitly force a document to begin printing on a left or right page, authors can specify a 'break-before' value that that propagates a page break to the root. [CSS-BREAK-3] The UA must suppress the first (empty) page(s) in this case (and the `:first` pseudo-class matches the first printed page).<br><br>EXAMPLE 1  <br>…<br><br><pre>html { break-before: left }<br></pre><br><br>For an HTML document, the above style rule will cause the first page of the document to print on a ':left' page, regardless of the page progression.</blockquote>The current behavior of Vivliostyle.js differs from this specification in some points.<br><br>I made test files on JS Bin:<br><br>• html-right.html = <https://jsbin.com/safalef/edit|https://jsbin.com/safalef/edit> -- html { break-before: right }<br>    • Vivliostyle: <https://vivliostyle.org/viewer/#src=https://jsbin.com/safalef|https://vivliostyle.org/viewer/#src=https://jsbin.com/safalef><br>        • seems OK<br>• html-left.html = <https://jsbin.com/tatokoz/edit|https://jsbin.com/tatokoz/edit> -- html { break-before: left }<br>    • Vivliostyle: <https://vivliostyle.org/viewer/#src=https://jsbin.com/tatokoz|https://vivliostyle.org/viewer/#src=https://jsbin.com/tatokoz><br>        • BUG: `html { break-before: left }` does not work<br>• body-right.html = <https://jsbin.com/xehuli/edit|https://jsbin.com/xehuli/edit> -- body { break-before: right }<br>    • Vivliostyle: <https://vivliostyle.org/viewer/#src=https://jsbin.com/xehuli|https://vivliostyle.org/viewer/#src=https://jsbin.com/xehuli><br>        • seems OK<br>• body-left.html = <https://jsbin.com/kefobus/edit|https://jsbin.com/kefobus/edit> -- body { break-before: left }<br>    • Vivliostyle: <https://vivliostyle.org/viewer/#src=https://jsbin.com/kefobus|https://vivliostyle.org/viewer/#src=https://jsbin.com/kefobus><br>        • BUG: `body { break-before: left }` works but,<br>            • differs from the spec "The UA must suppress the first (empty) page(s) in this case (and the :first pseudo-class matches the first printed page)."<br>            • The first (empty) page has page-margin box content<br>• body-right.html + html-right.html<br>    • Vivliostyle: <https://vivliostyle.org/viewer/#src=https://jsbin.com/xehuli&amp;src=https://jsbin.com/safalef|https://vivliostyle.org/viewer/#src=https://jsbin.com/xehuli&amp;src=https://jsbin.com/safalef><br>        • BUG: `html { break-before: right }` on the second document does not work<br>• html-right.html + body-right.html<br>    • Vivliostyle: <https://vivliostyle.org/viewer/#src=https://jsbin.com/safalef&amp;src=https://jsbin.com/xehuli|https://vivliostyle.org/viewer/#src=https://jsbin.com/safalef&amp;src=https://jsbin.com/xehuli><br>        • BUG: `body { break-before: right }` on the second document works but,<br>            • The generated blank page between two documents has page-margin box content ("body-right") defined for the second document (body-right.html). This is incorrect because the document with `break-before: right` should begin on a right page, and the generated blank page should belong to the previous document.<br><br>In summary, there are the following problems:<br><br>• break-before: left/right on the root (`html`) element does not work<br>• break-before: left/right on the `body` element generates blank page even on the first document<br>• the blank page generated by the break-before: left/right on the `body` element of the Nth document in a multi-document publication (like EPUB) has page-margin box content defined for the Nth document. (not for the (N-1)th document).</blockquote>|
|07:13|![](https://avatars.slack-edge.com/2019-08-21/732685848020_f3f20736795184660348_72.png)|Kiara Translation|🇯🇵: break-before：ドキュメントの先頭の左/右が正しく機能しない・問題＃666・vivliostyle / vivliostyle.js<br><https://github.com/vivliostyle/vivliostyle.js/issues/666>|
|07:18|![](https://avatars.slack-edge.com/2019-05-15/624511073651_25909952cd7a069ceed2_72.png)|akabeko|First-page pseudo-class :first should work on each document in a multi-document publication? (→support :nth()) · Issue #667 · vivliostyle/vivliostyle.js<br><https://github.com/vivliostyle/vivliostyle.js/issues/667><br><blockquote>The spec: <https://drafts.csswg.org/css-page-3/#first-pseudo|https://drafts.csswg.org/css-page-3/#first-pseudo><br><br><blockquote>The `:first` pseudo-class matches the first printed page of a document.</blockquote>In the current Vivliostyle's implementation, the first-page pseudo-class :first works only on the first document in a multi-document publication.</blockquote>|
|07:18|![](https://avatars.slack-edge.com/2019-08-21/732685848020_f3f20736795184660348_72.png)|Kiara Translation|🇯🇵: 最初のページの疑似クラス：firstは、マルチドキュメントパブリケーションの各ドキュメントで機能する必要がありますか？ （→support：nth（））・Issue＃667・vivliostyle / vivliostyle.js<br><https://github.com/vivliostyle/vivliostyle.js/issues/667>|
|07:19|![](https://avatars.slack-edge.com/2019-05-15/624511073651_25909952cd7a069ceed2_72.png)|akabeko|spring-raining: 便利そう|
|07:19|![](https://avatars.slack-edge.com/2019-08-21/732685848020_f3f20736795184660348_72.png)|Kiara Translation|🇬🇧: spring-raining: looks convenient|
|07:19|![](https://avatars.slack-edge.com/2019-05-15/624511073651_25909952cd7a069ceed2_72.png)|akabeko|yamasy1549: めちゃめちゃいいですね|
|07:19|![](https://avatars.slack-edge.com/2019-08-21/732685848020_f3f20736795184660348_72.png)|Kiara Translation|🇬🇧: yamasy1549: It's really good|
|07:19|![](https://avatars.slack-edge.com/2019-05-15/624511073651_25909952cd7a069ceed2_72.png)|akabeko|Ayumu Takai: これはありがたいです。|
|07:20|![](https://avatars.slack-edge.com/2019-08-21/732685848020_f3f20736795184660348_72.png)|Kiara Translation|🇬🇧: Ayumu Takai: Thank you for this.|
|07:20|![](https://avatars.slack-edge.com/2019-05-15/624511073651_25909952cd7a069ceed2_72.png)|akabeko|takanakahiko: べ、便利〜〜〜〜|
|07:20|![](https://avatars.slack-edge.com/2019-08-21/732685848020_f3f20736795184660348_72.png)|Kiara Translation|🇬🇧: takanakahiko: All, convenient ~ ~ ~ ~|
|07:20|![](https://avatars.slack-edge.com/2019-05-15/624511073651_25909952cd7a069ceed2_72.png)|akabeko|近日中にリリース予定の v3 RC について spring-raining|
|07:20|![](https://avatars.slack-edge.com/2019-08-21/732685848020_f3f20736795184660348_72.png)|Kiara Translation|🇬🇧: Spring-raining about the upcoming v3 RC|
|07:21|![](https://avatars.slack-edge.com/2019-05-15/624511073651_25909952cd7a069ceed2_72.png)|akabeko|取り組んだ Issue/PR について説明|
|07:21|![](https://avatars.slack-edge.com/2019-08-21/732685848020_f3f20736795184660348_72.png)|Kiara Translation|🇬🇧: Explain the Issue / PR you worked on|
|07:22|![](https://secure.gravatar.com/avatar/1ac180f0868137292905c311b5fff781.jpg?s=72&d=https%3A%2F%2Fa.slack-edge.com%2Fdf10d%2Fimg%2Favatars%2Fava_0021-72.png)|spring-raining|<https://github.com/vivliostyle/vivliostyle-cli/issues/80><br><blockquote>[vivliostyle/vivliostyle-cli] #80 CLI の issue をアサインする</blockquote>|
|07:22|![](https://avatars.slack-edge.com/2019-08-21/732685848020_f3f20736795184660348_72.png)|Kiara Translation|🇬🇧: <https://github.com/vivliostyle/vivliostyle-cli/issues/80><br>🇯🇵: <https://github.com/vivliostyle/vivliostyle-cli/issues/80>|
|07:23|![](https://avatars.slack-edge.com/2019-05-15/624511073651_25909952cd7a069ceed2_72.png)|akabeko|Should not create `.vivliostyle` directory by default (v3) · Issue #77 · vivliostyle/vivliostyle-cli<br><https://github.com/vivliostyle/vivliostyle-cli/issues/77><br><blockquote>ディレクトリ `.vivliostyle` をデフォルトでは作らないようにするべき(v3)<br><br>（このissueの下書きを書いてから、同じようなissueをすでに書いてたことを思い出しました:  <br><https://github.com/vivliostyle/vivliostyle-cli/issues/65|#65 Generating publication manifest should be optional>  <br>内容が重なるけれど、大きなディレクトリが作られることの問題と、シンプルな解決提案を書いたので、これで検討材料になればと思います）<br><br>* * *<br><br>現在開発中の vivliostyle-cli 3.0.0-pre.x では、ローカルにある HTML ファイルを組版しようとすると、カレントディレクトリの下に `.vivliostyle` というディレクトリが作られて、その中に HTML ファイルや画像ファイルや CSS ファイルがコピーされ、manifest.json ファイルが作られてそれが Vivliostyle Core組版エンジンに渡されるようになっています。<br><br>この動作は Markdown 原稿から build する場合にはよくても、すでに出来ている HTML+CSS や EPUB の内容を組版して PDF を作るという用途に対しては、次のように、とても問題があります:<br><br>• 多くのファイルのコピーが伴うことで動作が遅くなる<br>• ユーザーは組版結果のPDFがほしいだけなのに、カレントディレクトリの下に多くのファイルが入ったディレクトリができる<br>• HTML ファイルと画像は `.vivliostyle/artifacts/` ディレクトリに、CSS ファイルは `.vivliostyle/themes/` ディレクトリへと、違う場所にコピーされるので HTML から CSS へのリンクは書き換えられている。しかし、元のファイルのディレクトリ構造と違うものになるので、ほかのファイルへの参照がリンクエラーになる問題をすべて解消するのは難しい。<br><br>*問題が起きるテスト*<br><br>以下、テストした例：  <br>例：<br><br><pre>$ npm i -g @vivliostyle/cli@next<br></pre><br><br>バージョンを確認:<br><br><pre>$ vivliostyle --version<br>cli: 3.0.0-pre.3<br>core: 2.1.1<br></pre><br><br>Vivliostle の公式サンプル文書類のリポジトリ<br><br><pre>$ git clone <https://github.com/vivliostyle/vivliostyle_doc.git><br>$ cd vivliostyle_doc<br><br>$ vivliostyle build samples/gutenberg/Alice.html --title Alice -o Alice.pdf --size A4<br>◡ Collecting build configError: Could not parse CSS stylesheet<br>    at exports.createStylesheet (/usr/local/lib/node_modules/@vivliostyle/cli/node_modules/jsdom/lib/jsdom/living/helpers/stylesheets.js:34:21)<br><br>…長いエラーメッセージ省略…<br><br>✖ 404 <http://localhost:13000/artifacts/samples/gutenberg/fonts/Crimson-Roman.ttf><br>✖ 404 <http://localhost:13000/artifacts/samples/gutenberg/fonts/Crimson-Semibold.ttf><br>✖ 404 <http://localhost:13000/artifacts/samples/gutenberg/fonts/Crimson-Italic.ttf><br>✔ samples/gutenberg/Alice.html Alice's Adventures in Wonderland, by Lewis Carroll<br>🎉 Built successfully.<br><br>Alice.pdf has been created.<br></pre><br><br>これで、PDFはできる。（いくつかエラーメッセージは出るけど）<br><br>`.vivliostyle` ディレクトリが生成されている。<br><br>このディレクトリの容量を調べると：<br><br><pre>$ du -sh .vivliostyle<br> 42M    .vivliostyle<br></pre><br><br>大きさが 42M バイトもある。  <br>含まれるファイル数とディレクトリ数を調べると:<br><br><pre>$ find .vivliostyle -type f | wc -l<br>    1770<br>$ find .vivliostyle -type d | wc -l<br>      97<br></pre><br><br>1770ファイル、97ディレクトリ<br><br>なぜこのように大きなディレクトリになっているかというと、このテストで対象にしたHTMLファイル `samples/gutenberg/Alice.html` から参照されていない画像ファイルであっても、カレントディレクトリ以下にある画像ファイルがすべて `.vivliostyle/artifacts/` の下にコピーされているためである。<br><br>*解決の提案*<br><br>`.vivliostyle` （または `--dist-dir` で指定の）ディレクトリを生成するのは次の場合だけとする：<br><br>• `--dist-dir` オプションの指定がある場合<br>• コマンドラインで指定される入力ファイルが Markdown ファイルの場合<br>• `vivliostyle.config.js` ファイル（または`--config` の指定）がある場合（config 内容によるかは要検討）<br><br>それ以外の場合は、HTML・CSS・その他のリソースをコピーしないで、それらのファイルを直接Vivliostyle Core組版エンジンに渡すようにする。<br><br>v2.1 まで存在した次のオプションを復活させるとよいかもしれない:<br><br><pre>  -r, --root &lt;root_directory&gt;   specify assets root path (default directory of input file)<br></pre><br><br>ただし、 "default directory of input file" は見直すべきだろう。このデフォルトではHTMLファイルよりも上位のディレクトリにある画像ファイルなどへの参照がエラーになるので不便。デフォルトがローカルファイル・システムのルートディレクトリ `/` であれば、そのような問題がなくなる。<br><br>参考：他のCSS組版エンジンのCLI（例：pagedjs-cli や AH Formatter の CLI）の場合、ローカルのファイルを入力として指定すると、fileプロトコルのURL（例: `file:///Users/user/work/file.html`）として扱われる。Vivliostyle の場合、ローカルのHTTPにする必要があるので、ファイルシステムのルートディレクトリをそのルートにすれば、同じように上位のディレクトリにあるファイルも参照できるようになる。</blockquote>|
|07:23|![](https://avatars.slack-edge.com/2019-08-21/732685848020_f3f20736795184660348_72.png)|Kiara Translation|🇯🇵: デフォルトで `.vivliostyle`ディレクトリを作成しないでください（v3）・問題＃77・vivliostyle / vivliostyle-cli<br><https://github.com/vivliostyle/vivliostyle-cli/issues/77>|
|07:24|![](https://avatars.slack-edge.com/2019-05-15/624511073651_25909952cd7a069ceed2_72.png)|akabeko|Make a list of asset files configurable · Issue #73 · vivliostyle/vivliostyle-cli<br><https://github.com/vivliostyle/vivliostyle-cli/issues/73><br><blockquote>*Overview*<br><br>On a building artifacts phase, we copy image files to artifact dir to load by a broker server.<br><br><https://github.com/vivliostyle/vivliostyle-cli/blob/c7ee470146c3b86612cc00947dce46fd73f2c8f5/src/builder.ts#L223-L231|vivliostyle-cli/src/builder.ts><br><br>Lines 223 to 231 in &lt;/vivliostyle/vivliostyle-cli/commit/c7ee470146c3b86612cc00947dce46fd73f2c8f5|c7ee470&gt;<br><br>However, we have no way to load any asset files excepting images (ex. font files) due to clean up any files on an artifact directory before the building phase. Vivliostyle should provide users with the option of selecting files to copy.</blockquote>|
|07:24|![](https://avatars.slack-edge.com/2019-08-21/732685848020_f3f20736795184660348_72.png)|Kiara Translation|🇯🇵: アセットファイルのリストを構成可能にする・問題＃73・vivliostyle / vivliostyle-cli<br><https://github.com/vivliostyle/vivliostyle-cli/issues/73>|
|07:25|![](https://avatars.slack-edge.com/2019-05-15/624511073651_25909952cd7a069ceed2_72.png)|akabeko|spring-raining: 設定ファイルの形式を変更した<br><br>W3C Publication Manifest or Readium Web Publication Manifest? · Issue #67 · vivliostyle/vivliostyle-cli<br><https://github.com/vivliostyle/vivliostyle-cli/issues/67><br><blockquote>V3.0.0-preで生成される manifest.json が、<https://www.w3.org/TR/pub-manifest/|W3C Publication Manifest> ではなくて <https://github.com/readium/webpub-manifest|Readium Web Publication Manifest> のものであることに気付きました。<br><br>両者は似ていますが少し違います。Readiumの人々がReadium Web Publication Manifestを作って、それがだいたい元になってW3Cで標準化する Publication Manifest となっているという関係です。Vivliostyle Coreでは、どちらの形式でもサポートするようにしています。<br><br>W3C Publication Manifest は現在 ほぼ仕様が完成といえる Candidate Recommendation であるので、これを採用してもよいと思います。  <br>Readium Web Publication Manifestを採用している理由はありますか？</blockquote>|
|07:25|![](https://avatars.slack-edge.com/2019-08-21/732685848020_f3f20736795184660348_72.png)|Kiara Translation|🇬🇧: spring-raining: Changed the format of the configuration file<br><br>W3C Publication Manifest or Readium Web Publication Manifest? · Issue # 67 · vivliostyle / vivliostyle-cli<br><https://github.com/vivliostyle/vivliostyle-cli/issues/67>|
|07:26|![](https://avatars.slack-edge.com/2019-05-15/624511073651_25909952cd7a069ceed2_72.png)|akabeko|spring-raining: 目次の生成機能を実装<br><br>toc.html generation option · Issue #66 · vivliostyle/vivliostyle-cli<br><https://github.com/vivliostyle/vivliostyle-cli/issues/66><br><blockquote>vivliostyle.config.js の `toc: true` により目次のHTMLファイル toc.html が生成されて、それが manifest.json の readingOrder の先頭項目になります。  <br>これにより、組版される文書の先頭に目次がつきます。<br><br>現状（CLI 3.0.0-pre.2 で確認）の目次HTMLファイル生成には次の問題があるため、あまり有用ではありません：<br><br>• 目次のHTMLにthemeのスタイルシートが適用されない（`&lt;link rel="stylesheet"...&gt;` がない）。<br>    • 目次のスタイルを指定できない。<br>    • 本のページサイズなどがテーマのCSSの `@page { size: }` で指定されている場合、目次ページに適用されない。<br><br>以下、改善案：<br><br>• `&lt;link href="テーマの.css" rel="stylesheet"&gt;` を出力する<br>• 生成されるHTMLファイルは出版物のトップのHTML（Web Publicationの primary entry page）ということになるので<br>    • デフォルトのファイル名は "index.html" のほうがよい<br>    • HTMLの title と h1 見出しには出版物のタイトルがあったほうがよい<br><br>例：<br><br><pre>&lt;html lang="ja"&gt;<br>&lt;head&gt;<br>&lt;title&gt;本のタイトル&lt;/title&gt;<br>&lt;link href="manifest.json" rel="manifest" type="application/webpub+json"&gt;<br>&lt;link href="theme.css" rel="stylesheet"&gt;<br>&lt;/head&gt;<br>&lt;body&gt;<br>&lt;h1&gt;本のタイトル&lt;/h1&gt;<br><br>&lt;nav id="toc" role="doc-toc"&gt;<br>&lt;h2&gt;目次&lt;/h2&gt;<br>&lt;ul&gt;<br>  &lt;li&gt;&lt;a href="chapter1.html"&gt;第1章&lt;/a&gt;&lt;/li&gt;<br>  &lt;li&gt;&lt;a href="chapter2.html"&gt;第2章&lt;/a&gt;&lt;/li&gt;<br>&lt;/ul&gt;<br>&lt;/nav&gt;<br>&lt;/body&gt;<br>&lt;/html&gt;</pre></blockquote>|
|07:26|![](https://avatars.slack-edge.com/2019-08-21/732685848020_f3f20736795184660348_72.png)|Kiara Translation|🇬🇧: spring-raining: Implemented table of contents generation function<br><br>toc.html generation option · Issue # 66 · vivliostyle / vivliostyle-cli<br><https://github.com/vivliostyle/vivliostyle-cli/issues/66>|
|07:27|![](https://avatars.slack-edge.com/2019-05-15/624511073651_25909952cd7a069ceed2_72.png)|akabeko|spring-raining: デフォルト生成される目次ファイル名が `index.html` に変更された、任意の名前も可能|
|07:27|![](https://avatars.slack-edge.com/2019-08-21/732685848020_f3f20736795184660348_72.png)|Kiara Translation|🇬🇧: spring-raining: Default generated table of contents file name changed to `index.html`, can be any name|
|07:29|![](https://avatars.slack-edge.com/2019-05-15/624511073651_25909952cd7a069ceed2_72.png)|akabeko|spring-raining: EPUB 入力に対応した<br><br>Error on EPUB (unzipped) loading (v3.0.0-pre.2) · Issue #63 · vivliostyle/vivliostyle-cli<br><https://github.com/vivliostyle/vivliostyle-cli/issues/63><br><blockquote>v3.0.0-pre.2で、EPUB (unzipped)からのPDF生成ができません。v2.1.0では問題ありませんでした。<br><br>EPUBサンプルとして、たとえば <https://github.com/IDPF/epub3-samples|https://github.com/IDPF/epub3-samples> をローカルにクローンします。<br><br>ディレクトリ "30" の下の各ディレクトリは、EPUBを展開(unzip)した内容となっています。  <br>（ちなみに、Vivliostyle Viewer はGitHub上のそのようなディレクトリのURLをそのまま指定してEPUBの表示ができます。例：  <br><https://vivliostyle.org/viewer/#src=https://github.com/IDPF/epub3-samples/tree/master/30/accessible_epub_3&amp;bookMode=true|https://vivliostyle.org/viewer/#src=https://github.com/IDPF/epub3-samples/tree/master/30/accessible_epub_3&amp;bookMode=true> ）<br><br>Vivliostyle CLI v2.1.0 では、次のように EPUB (unzipped)からPDFの生成ができていました：<br><br><pre>$ vivliostyle build --book --size A4 30/accessible_epub_3/<br>===&gt; Launching build environment...<br>===&gt; Building pages...<br>===&gt; 404 <http://localhost:13000/><br>===&gt; 404 <http://localhost:13000/META-INF/encryption.xml><br>===&gt; Generating PDF...<br>===&gt; Processing PDF...<br>===&gt; … Done<br>===&gt; …/epub3-samples/output.pdf has been created<br></pre><br><br>しかし、v3.0.0-pre.2 では<br><br><pre>$ vivliostyle build --size A4 --title Test 30/accessible_epub_3/<br>✖ Error: EISDIR: illegal operation on a directory, read<br></pre><br><br>とエラーになります。<br><br>OPFファイルを指定するとどうなるか試すと、<br><br><pre>$ vivliostyle build --size A4 --title Test 30/accessible_epub_3/EPUB/package.opf <br>✖ Error: waiting for function failed: timeout 120000ms exceeded<br></pre><br><br>なにかの処理にとても時間がかかっていて、タイムアウトになるようです。<br><br>v2.1では、EPUBの目次やメタデータの情報がPDFに出力されるようになり、EPUB処理が改良されているのでv3.0でもそれを引き継がなくてはなりません。</blockquote>|
|07:29|![](https://avatars.slack-edge.com/2019-08-21/732685848020_f3f20736795184660348_72.png)|Kiara Translation|🇬🇧: spring-raining: Supports EPUB input<br><br>Error on EPUB (unzipped) loading (v3.0.0-pre.2) · Issue # 63 · vivliostyle / vivliostyle-cli<br><https://github.com/vivliostyle/vivliostyle-cli/issues/63>|
|07:29|![](https://avatars.slack-edge.com/2019-05-15/624511073651_25909952cd7a069ceed2_72.png)|akabeko|shinyu: 従来は展開された EPUB のみ対応だったが、これで ZIP 圧縮されたものもサポートしている|
|07:29|![](https://avatars.slack-edge.com/2019-08-21/732685848020_f3f20736795184660348_72.png)|Kiara Translation|🇬🇧: shinyu: Previously only expanded EPUB was supported, but now it also supports ZIP compressed ones.|
|07:30|![](https://avatars.slack-edge.com/2019-05-15/624511073651_25909952cd7a069ceed2_72.png)|akabeko|spring-raining: 明日にリリースできそう、いま準備している|
|07:30|![](https://avatars.slack-edge.com/2019-08-21/732685848020_f3f20736795184660348_72.png)|Kiara Translation|🇬🇧: spring-raining: I'm preparing for release tomorrow|
|07:32|![](https://avatars.slack-edge.com/2019-05-15/624511073651_25909952cd7a069ceed2_72.png)|akabeko|ogwata: これは pre ではなく正式リリース？pre とかではなく？|
|07:32|![](https://avatars.slack-edge.com/2019-08-21/732685848020_f3f20736795184660348_72.png)|Kiara Translation|🇬🇧: ogwata: Is this an official release, not a pre? Not pre?|
|07:32|![](https://avatars.slack-edge.com/2019-05-15/624511073651_25909952cd7a069ceed2_72.png)|akabeko|spring-raining: 正式リリース。ただし `examples`  がエラーになるので別途追加で修正予定|
|07:32|![](https://avatars.slack-edge.com/2019-08-21/732685848020_f3f20736795184660348_72.png)|Kiara Translation|🇬🇧: spring-raining: Official release. However, `examples` will cause an error, so it will be fixed separately.|
|07:33|![](https://avatars.slack-edge.com/2019-05-15/624511073651_25909952cd7a069ceed2_72.png)|akabeko|Ayumu Takai: 3.0リリースされたら私家版のReplaceやSCSSのPRを出す感じで良いでしょうか?|
|07:33|![](https://avatars.slack-edge.com/2019-08-21/732685848020_f3f20736795184660348_72.png)|Kiara Translation|🇬🇧: Ayumu Takai: Is it okay to release a private version of Replace or SCSS PR when 3.0 is released?|
|07:33|![](https://avatars.slack-edge.com/2019-05-15/624511073651_25909952cd7a069ceed2_72.png)|akabeko|Ayumu Takai: 3.0 以降に PR だします|
|07:33|![](https://avatars.slack-edge.com/2019-08-21/732685848020_f3f20736795184660348_72.png)|Kiara Translation|🇬🇧: Ayumu Takai: PR after 3.0|
|07:34|![](https://avatars.slack-edge.com/2019-05-15/624511073651_25909952cd7a069ceed2_72.png)|akabeko|takanakahiko: Pub は 3.0 以降で、手元で開発中|
|07:35|![](https://avatars.slack-edge.com/2019-05-15/624511073651_25909952cd7a069ceed2_72.png)|akabeko|次回日程|
|07:35|![](https://avatars.slack-edge.com/2019-08-21/732685848020_f3f20736795184660348_72.png)|Kiara Translation|🇬🇧: Next schedule|
|07:35|![](https://avatars.slack-edge.com/2019-05-15/624511073651_25909952cd7a069ceed2_72.png)|akabeko|2021/3/7 (日) はどうか？|
|07:35|![](https://avatars.slack-edge.com/2019-08-21/732685848020_f3f20736795184660348_72.png)|Kiara Translation|🇬🇧: How about 2021/3/7 (Sun)?|
|07:36|![](https://avatars.slack-edge.com/2019-05-15/624511073651_25909952cd7a069ceed2_72.png)|akabeko|2021/3/7 (日) に開催で|
|07:36|![](https://avatars.slack-edge.com/2019-08-21/732685848020_f3f20736795184660348_72.png)|Kiara Translation|🇬🇧: Held on 2021/3/7 (Sun)|
|07:37|![](https://avatars.slack-edge.com/2019-05-15/624511073651_25909952cd7a069ceed2_72.png)|akabeko|議題をひととおり消化したので閉会します。<br>みなさんお疲れさまでした！|
|07:37|![](https://avatars.slack-edge.com/2019-08-21/732685848020_f3f20736795184660348_72.png)|Kiara Translation|🇬🇧: I have finished the agenda, so I will close it.<br>Thank you everyone!|
