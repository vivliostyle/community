# 2023-12-02

|Time (UTC)|Icon|Name|Message|
|---|---|---|---|
|04:48|![](https://avatars.slack-edge.com/2019-05-15/624511073651_25909952cd7a069ceed2_72.png)|akabeko|本日の Vivliostyle 開発者会議 December 2023 は本メッセージに対するスレッドとして議事録をとります。<br>発言内容の補足・訂正などはスレッド中のメッセージとしてお願いします。<br><br>またオフレコにしたい発言をされる際はその旨をお知らせください。議事録の対象から外します。<br><br>December 2023 · Issue #118 · vivliostyle/community<br><https://github.com/vivliostyle/community/issues/118><br><blockquote>• Meeting Log<br><br>*Agenda*<br><br>• *Vivliostyle.js*（<https://github.com/MurakamiShinyu|@MurakamiShinyu>）<br>    • 前月からの報告と今後の予定<br>• *Vivliostyle CLI*（<https://github.com/spring-raining|@spring-raining> , <https://github.com/MurakamiShinyu|@MurakamiShinyu>）<br>    • 前月からの報告と今後の予定<br>• *Theme* (<https://github.com/spring-raining|@spring-raining>, <https://github.com/yamasy1549|yamasy1549>)<br>    • 前月からの報告と今後の予定<br>• *VFM, create-book, vivliostyle-sitegen*（<https://github.com/akabekobeko|@akabekobeko>）<br>    • 前月からの報告と今後の予定<br>• *Vivliostyle Pub*（<https://github.com/takanakahiko|@takanakahiko>, <https://github.com/MurakamiShinyu|@MurakamiShinyu>）<br>    • 前月からの報告と今後の予定<br>• <http://gihyo.jp|gihyo.jp> Web連載について（<https://github.com/U-1F992|@U-1F992>）<br><br>*Members*<br><br>• <https://github.com/MurakamiShinyu|@MurakamiShinyu><br>• <https://github.com/ogwata|@ogwata><br>• <https://github.com/spring-raining|@spring-raining><br>• <https://github.com/yamasy1549|@yamasy1549><br>• <https://github.com/UskeS|@UskeS><br>• <https://github.com/lwohtsu|@lwohtsu><br>• <https://github.com/macneko-ayu|@macneko-ayu><br>• <https://github.com/U-1F992|@U-1F992><br>• <https://github.com/akabekobeko|@akabekobeko> (Scribe)</blockquote>|
|05:05|![](https://avatars.slack-edge.com/2019-05-15/624511073651_25909952cd7a069ceed2_72.png)|akabeko|*Vivliostyle.js*|
|05:06|![](https://avatars.slack-edge.com/2019-05-15/624511073651_25909952cd7a069ceed2_72.png)|akabeko|shinyu: 今月は特に進捗なし|
|05:06|![](https://avatars.slack-edge.com/2018-04-27/354445776386_e258f5ed5ba887b08668_72.jpg)|shinyu|<https://github.com/vivliostyle/vivliostyle.js/issues/1240><br><blockquote>最近、Chromeからの印刷・PDF出力でページエリア内容が消えることがある。  <br>(Slackで不具合報告あり: <https://vivliostyle.slack.com/archives/CJAP6GBKQ/p1701221438074109|https://vivliostyle.slack.com/archives/CJAP6GBKQ/p1701221438074109> )<br><br>ページに `<ruby>` 要素があるときにこの不具合が発生する。<br><br>もっとも単純な例 `<ruby>RUBY</ruby>` だけのHTMLでも発生。<br><br>Vivliostyle Viewerでテスト: <https://vivliostyle.org/viewer/#src=data:,%3Cruby%3ERUBY%3C/ruby%3E|https://vivliostyle.org/viewer/#src=data:,%3Cruby%3ERUBY%3C/ruby%3E><br><br>テスト結果のスクリーンショット：  <br>（Vivliostyle Viewerのページ表示では「RUBY」が表示されるのに、印刷プレビューではそれが消えている）  <br><https://private-user-images.githubusercontent.com/3324737/287318949-4f58df04-60db-4025-a2de-195b0da98010.png?jwt=eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJnaXRodWIuY29tIiwiYXVkIjoicmF3LmdpdGh1YnVzZXJjb250ZW50LmNvbSIsImtleSI6ImtleTEiLCJleHAiOjE3MDE0OTM5MDgsIm5iZiI6MTcwMTQ5MzYwOCwicGF0aCI6Ii8zMzI0NzM3LzI4NzMxODk0OS00ZjU4ZGYwNC02MGRiLTQwMjUtYTJkZS0xOTViMGRhOTgwMTAucG5nP1gtQW16LUFsZ29yaXRobT1BV1M0LUhNQUMtU0hBMjU2JlgtQW16LUNyZWRlbnRpYWw9QUtJQUlXTkpZQVg0Q1NWRUg1M0ElMkYyMDIzMTIwMiUyRnVzLWVhc3QtMSUyRnMzJTJGYXdzNF9yZXF1ZXN0JlgtQW16LURhdGU9MjAyMzEyMDJUMDUwNjQ4WiZYLUFtei1FeHBpcmVzPTMwMCZYLUFtei1TaWduYXR1cmU9MjQ2MTk2ZWRjYmU1MjcwNGU4ZDg0NjBhNzBkNGY5MzNiZGViZmUwZWEzZGE0ZWJkZjdjZjAyOGFjN2Y1ZmI1ZCZYLUFtei1TaWduZWRIZWFkZXJzPWhvc3QmYWN0b3JfaWQ9MCZrZXlfaWQ9MCZyZXBvX2lkPTAifQ.oKrwams54w4jvQmnWUNtCQrtPPRosndN8GBA9YQUEX8|スクリーンショット 2023-12-02 0 30 14><br><br>常に再現するわけではなく、Chromeを立ち上げて使っているうちに症状が起きなくなるようだ。Chromeを起動し直すとまた症状が起きる。<br><br>macOSとWindowsで試したが、どちらでも再現する。<br><br>Chrome (Chromium) の最近のバージョンで発生するようになったようだ<br><br>• Chrome 119.0.6045.159 で発生する（Slackでの不具合報告から）。それ以降の Chrome（119.0.6045.161、 119.0.6045.199、121.0.6159.0 で確認）で発生。<br>• Chromium 119.0.6045.9 （Vivliostyle CLIの現行バージョンv8.5.1でインストールされる）では発生しない<br>• Chromium 120.0.6099.28 （Playwright 1.40.1 でインストールされる Chromium バージョン）では発生する</blockquote>|
|05:07|![](https://avatars.slack-edge.com/2019-05-15/624511073651_25909952cd7a069ceed2_72.png)|akabeko|shinyu: ↑のように報告のあったバグ調査をしている|
|05:09|![](https://avatars.slack-edge.com/2019-05-15/624511073651_25909952cd7a069ceed2_72.png)|akabeko|shinyu: ページ内に `&lt;ruby&gt;` があると印刷でページが消える|
|05:10|![](https://avatars.slack-edge.com/2019-05-15/624511073651_25909952cd7a069ceed2_72.png)|akabeko|akabeko: この問題が起きるとき、DevTools のコンソールにエラーなど出ていないか？|
|05:10|![](https://avatars.slack-edge.com/2019-05-15/624511073651_25909952cd7a069ceed2_72.png)|akabeko|shinyu: でない|
|05:11|![](https://avatars.slack-edge.com/2019-05-15/624511073651_25909952cd7a069ceed2_72.png)|akabeko|shinyu: ルビ処理に関するハックの副作用かもしれない|
|05:20|![](https://avatars.slack-edge.com/2019-05-15/624511073651_25909952cd7a069ceed2_72.png)|akabeko|*Vivliostyle CLI*<br>特に進捗なし|
|05:20|![](https://avatars.slack-edge.com/2019-05-15/624511073651_25909952cd7a069ceed2_72.png)|akabeko|*VFM, create-book, vivliostyle-sitegen*|
|05:20|![](https://avatars.slack-edge.com/2019-05-15/624511073651_25909952cd7a069ceed2_72.png)|akabeko|特に進捗なし|
|05:21|![](https://avatars.slack-edge.com/2019-05-15/624511073651_25909952cd7a069ceed2_72.png)|akabeko|akabeko: Pub のフロントエンド不具合を調査することになったので、Pub のコードを読んでます|
|05:21|![](https://avatars.slack-edge.com/2019-05-15/624511073651_25909952cd7a069ceed2_72.png)|akabeko|*Vivliostyle Pub*|
|05:22|![](https://avatars.slack-edge.com/2019-11-22/845042642576_070441337abaca9fb7b3_72.png)|ogwata|akabeko: 村上のパッケージ更新をしたいというIssueを手伝うために調査をしてみた|
|05:23|![](https://avatars.slack-edge.com/2018-04-27/354445776386_e258f5ed5ba887b08668_72.jpg)|shinyu|<https://github.com/vivliostyle/vivliostyle-pub/pull/292><br><blockquote>Update next 12->14, react 17->18, etc.</blockquote>|
|05:24|![](https://avatars.slack-edge.com/2019-11-22/845042642576_070441337abaca9fb7b3_72.png)|ogwata|akabeko: 現在、パッケージ更新しようとするとトースト（エラー表示）が大量に出る|
|05:25|![](https://avatars.slack-edge.com/2019-11-22/845042642576_070441337abaca9fb7b3_72.png)|ogwata|akabeko: その原因を調査した。すると、現在の実装の質があまりよろしくないことが判明。原因を調査すること自体がむずかしい。テスト方法がない。なにがおきているか、とてもわかりにくい。それにどう対処するか。|
|05:25|![](https://avatars.slack-edge.com/2019-11-22/845042642576_070441337abaca9fb7b3_72.png)|ogwata|akabeko: 地道に少しずつリファクタリングするしかないと思われる。|
|05:26|![](https://avatars.slack-edge.com/2019-11-22/845042642576_070441337abaca9fb7b3_72.png)|ogwata|akabeko: 特定のパッケージだけ、ちょっとずつバージョンを上げていくなど。個別対処を積み重ねる。|
|05:27|![](https://avatars.slack-edge.com/2019-11-22/845042642576_070441337abaca9fb7b3_72.png)|ogwata|村上：それはそうだと思う。ここでいくつかのパッケージをまとめてあげようとした理由は、依存関係が複雑だから。|
|05:27|![](https://avatars.slack-edge.com/2019-11-22/845042642576_070441337abaca9fb7b3_72.png)|ogwata|akabeko: それは回避法が心当たりあるので、自分が引き受けてもよい。|
|05:28|![](https://avatars.slack-edge.com/2019-11-22/845042642576_070441337abaca9fb7b3_72.png)|ogwata|akabeko: Next.jsが一番大きいので、これを最後にバージョンアップするのがよい。|
|05:29|![](https://avatars.slack-edge.com/2019-11-22/845042642576_070441337abaca9fb7b3_72.png)|ogwata|akabeko: package.jsonのアップデートがキモ。|
|05:30|![](https://avatars.slack-edge.com/2019-11-22/845042642576_070441337abaca9fb7b3_72.png)|ogwata|akabeko: chakra3つをまとめてアップデートするところから始めるのがよさそう。|
|05:30|![](https://avatars.slack-edge.com/2019-11-22/845042642576_070441337abaca9fb7b3_72.png)|ogwata|akabeko: すでに自分の手元に環境が構築されているので、そこからはじめてみる。|
|05:31|![](https://avatars.slack-edge.com/2019-11-22/845042642576_070441337abaca9fb7b3_72.png)|ogwata|村上：了解。Firebase関係のライブラリはどうする？|
|05:33|![](https://avatars.slack-edge.com/2019-11-22/845042642576_070441337abaca9fb7b3_72.png)|ogwata|akabeko: たしかにfirebaseは分けて進めた方がよさそう。|
|05:34|![](https://avatars.slack-edge.com/2019-11-22/845042642576_070441337abaca9fb7b3_72.png)|ogwata|決定、akabekoが適宜Slackで相談しつつすすめる。|
|05:36|![](https://avatars.slack-edge.com/2019-05-15/624511073651_25909952cd7a069ceed2_72.png)|akabeko|akabeko: 安全そうな deps を小さく更新適用しつつ、next、react、firebase など重量級のものを後回しにします|
|05:36|![](https://avatars.slack-edge.com/2019-05-15/624511073651_25909952cd7a069ceed2_72.png)|akabeko|<http://gihyo.jp|gihyo.jp> Web連載について|
|05:39|![](https://avatars.slack-edge.com/2019-05-15/624511073651_25909952cd7a069ceed2_72.png)|akabeko|企画とスケジュールなどを共有|
|05:52|![](https://avatars.slack-edge.com/2019-05-15/624511073651_25909952cd7a069ceed2_72.png)|akabeko|ここはオフレコです|
|06:19|![](https://avatars.slack-edge.com/2019-05-15/624511073651_25909952cd7a069ceed2_72.png)|akabeko|執筆内容、スケジュール、進行などを相談してひととおり合意|
|06:19|![](https://avatars.slack-edge.com/2019-05-15/624511073651_25909952cd7a069ceed2_72.png)|akabeko|*Vivliostyle CLI*|
|06:20|![](https://avatars.slack-edge.com/2019-05-15/624511073651_25909952cd7a069ceed2_72.png)|akabeko|特に進捗なし|
|06:20|![](https://avatars.slack-edge.com/2018-04-27/354445776386_e258f5ed5ba887b08668_72.jpg)|shinyu|<https://github.com/spring-raining/vivliostyle/issues/13><br><blockquote>> 電子版としてPDFだけでなくEPUBも追加しました。購入済みの方はぜひ〜 <https://t.co/YXTAC2ClBl|https://t.co/YXTAC2ClBl><br>> <br>> — 緑豆はるさめ (@spring_raining) <https://twitter.com/spring_raining/status/1726449072935170221?ref_src=twsrc%5Etfw|November 20, 2023><br><br>とのことで、『AstroとVivliostyle CLIでWeb&出版物ハイブリッド開発』のEPUB版を見てみました。ソースはこのリポジトリのようなので、ここで不具合報告します。<br><br>EPUBファイルは次の２つ:<br><br>• `AstroとVivliostyle CLIでWeb&出版物ハイブリッド開発_unstyled.epub` - 以下「unstyled.epub」と書く<br>• `AstroとVivliostyle CLIでWeb&出版物ハイブリッド開発_styled.epub` - 以下「styled.epub」と書く<br><br>テストした環境・ソフトウェア:<br><br>OS: macOS Sonoma 14.1.1<br><br>• EPUB-Checker<br>• Kindle Previewer<br>• Apple Books<br>• Thorium Reader<br><br>*EPUB-Checkerでエラー*<br><br><https://pagina.gmbh/startseite/leistungen/publishing-softwareloesungen/epub-checker/|pagina EPUB-Checker> でチェックした。<br><br>「unstyled.epub」でのエラー:  <br><https://github.com/spring-raining/vivliostyle/assets/3324737/c2ec6d90-c40c-4087-b898-f168400198d0|スクリーンショット：EPUB-CheckerでERROR><br><br>「styled.epub」でのエラー:  <br><https://github.com/spring-raining/vivliostyle/assets/3324737/788eb6eb-0643-4ff4-ab08-ecfbabc6a94b|スクリーンショット：EPUB-CheckerでERROR><br><br>*Kindle Previewerでエラー*<br><br><https://kdp.amazon.co.jp/ja_JP/help/topic/G202131170|Kindle Previewer 3> で開こうとしたがエラーになった。<br><br>「unstyled.epub」「styled.epub」とも  <br><https://github.com/spring-raining/vivliostyle/assets/3324737/d9188832-b322-4866-9527-9bfceb480dbe|スクリーンショット：「変換エラーにより、Kindle Previewerでこの本をプレビューできませんでした」><br><br>「unstyled.epub」でのエラー:  <br><https://github.com/spring-raining/vivliostyle/assets/3324737/ac9ba64d-3571-4c3d-adc2-7e4e6824e142|スクリーンショット 2023-11-21 11 53 46><br><br>「styled.epub」でのエラー:  <br><https://github.com/spring-raining/vivliostyle/assets/3324737/a851aa8f-6e4a-40d7-947a-92f6605c182b|スクリーンショット 2023-11-21 11 55 22><br><br>*Apple Booksで表示不具合*<br><br>Apple Books（macOS上の標準の「ブック」アプリ）で開いてテストした。<br><br>「styled.epub」で、１つの章（EPUB内の１つのXHTMLファイル）が最初の1ページしか表示されない不具合がある。<br><br><https://github.com/spring-raining/vivliostyle/assets/3324737/575c64c1-f1b5-4791-b23f-46055f79c218|スクリーンショット 2023-11-21 12 11 42><br><br>このスクリーンショットで、「あとがき」ページのページ番号の表示が「9/10」となっているように、10個の章がそれぞれ1ページだけしかなくて、「あとがき」が9ページ目ということになっている。<br><br>それから、「unstyled.epub」「styled.epub」とも目次の表示で目次項目内での不要な空白文字がそのまま出ているようであまりよくない：<br><br><https://github.com/spring-raining/vivliostyle/assets/3324737/a3cee3bb-2912-4616-9a68-81405415d71b|スクリーンショット 2023-11-21 12 08 52><br><br>*Thorium Readerで表示不具合*<br><br><https://www.edrlab.org/software/thorium-reader/|Thorium Reader> で開いてテストした。<br><br>だいたいは問題なく閲覧できるが、「styled.epub」でページを進めていくと、ところによって垂直スクロールバーが出て、その章はスクロールしないと最後まで読めないという現象があるのが気になった。<br><br><https://github.com/spring-raining/vivliostyle/assets/3324737/f5bc8227-8f29-40de-b44c-3befea6aed23|スクリーンショット 2023-11-22 18 45 13></blockquote>|
|06:23|![](https://avatars.slack-edge.com/2019-05-15/624511073651_25909952cd7a069ceed2_72.png)|akabeko|spring-raining: ↑の issue は CLI などに移して個別対応する|
|06:28|![](https://avatars.slack-edge.com/2019-05-15/624511073651_25909952cd7a069ceed2_72.png)|akabeko|次回開催|
|06:29|![](https://avatars.slack-edge.com/2019-05-15/624511073651_25909952cd7a069ceed2_72.png)|akabeko|2024/1/13 (土) で|
|06:30|![](https://avatars.slack-edge.com/2019-05-15/624511073651_25909952cd7a069ceed2_72.png)|akabeko|ひととおり議題をおえたので閉会します<br>みなさまお疲れ様でした！よいお年を！|
