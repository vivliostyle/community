# 2023-01-24

|Time (UTC)|Icon|Name|Message|
|---|---|---|---|
|01:56|![](https://avatars.slack-edge.com/2023-01-24/4689073193331_8c2914ef883b04d806ba_72.png)|Norihiro Kumagai|Markdownファイルをソースコードとしてvivliostyle buildするとき、'$'文字を使用していても数式モードに入らない(数式モード解釈を無効にする!?)方法があればご教示ください。ざっとググった範囲で見つけることができませんでした。|
|01:59|![](https://avatars.slack-edge.com/2018-04-27/354445776386_e258f5ed5ba887b08668_72.jpg)|shinyu|Markdownではバックスラッシュ `\` がエスケープ文字として使えます。つまり `\$` と書くことで数式扱いにならなくなります。|
|02:03|![](https://avatars.slack-edge.com/2018-04-27/354445776386_e258f5ed5ba887b08668_72.jpg)|shinyu|<https://spec.commonmark.org/0.30/#backslash-escapes>|
|02:25|![](https://avatars.slack-edge.com/2018-04-27/354445776386_e258f5ed5ba887b08668_72.jpg)|shinyu|それから、エスケープなしで $ ... $ で囲まれていても次の場合には数式にならずそのまま $ として出力されます：<br><br>• `$ ...$` ...スペース (スペース、タブ文字、改行など)、インライン開始の `$` 直後に がある<br>• `$... $` ...スペース (スペース、タブ文字、改行など)、インライン終了の `$` 直前に がある<br>• `$...$5` ...インライン終了の `$` 直後に数字 `0...N` がある<br><https://vivliostyle.github.io/vfm/#/ja/vfm#%E6%95%B0%E5%BC%8F-math-equation> から|
|09:54|![](https://avatars.slack-edge.com/2023-01-24/4682033437206_950a6c9111216c78d846_72.png)|二日ゆに|【Vivliostyle上でのHTMLの解釈について】<br><br>はじめまして、二日ゆにと申します。<br>日頃は二次創作で小説を書いており、その組版にはLaTeXを用いてきましたが、vivliostyleに興味を持って移行を考えています。<br>vivliostyleでどうしても実現したい挙動があるので、もし知っている方がいらっしゃれば回答していただければ幸いです。<br><br>質問：vivliostyle flavored markdown上（あるいはvivliostyle上のhtml）では、LaTeX記法を再現する方法はないでしょうか。<br><br>詳細：<br><br>パラグラフ中の改行に関する挙動です。<br>例えば、<br><br>```吾輩は猫である。<br>名前はまだない。<br><br>ただ薄暗いところで以下云々<pre>と原稿上で書いた場合。<br>LaTeX上では<br></pre>　吾輩は猫である。名前はまだない。<br>　ただ薄暗いところで以下云々<pre>と解釈されるはずです。<br><br>しかし、vivliostyleでは現状、（少なくとも私の環境では）<br></pre>LaTeXの場合<br>　吾輩は猫である。名前はまだない。<br>　ただ薄暗いところで以下云々<br><br>Vivliostyleの場合<br>　吾輩は猫である。 名前はまだない。<br>　ただ薄暗いところで以下云々```<br>となっており、つまり、*パラグラフ中で改行した場合、改行に当たる位置に謎の半角空白が生成されている*ように見えます。<br><br>調べてみた結果としては、そもそも私の環境でこれが成り立っていること自体がおかしいような気もするし（おそらく、本来なら出力上でも改行されるはず）、<br>かといってcssでこの謎の空白を消す方法も、<br>config.jsでの指定によってこの空白を消す処理を追加する方法も見つかりませんでした。<br><br>長々となってしまいましたが、もしこの質問に対して何か解答をお持ちでしたら、教えていただけると幸いです。|
|10:40|![](https://avatars.slack-edge.com/2018-04-27/354445776386_e258f5ed5ba887b08668_72.jpg)|shinyu|LaTeXの場合、入力テキストでの改行の直前の文字が全角文字であれば改行は削除されて、それ以外の文字ならば単語間のスペース（U+0020）になります。<br><br>HTML+CSSでもそうなればよいのですが、現状では、常に単語間のスペースになります。<br><br>CSS Textドラフト仕様では改行の前後のコンテキストによってスペースにするか除去するかを自動処理するのが望ましい（だけどそのルールは実装依存）ということが一応書かれてます：<br><https://www.w3.org/TR/css-text-4/#line-break-transform><br><br>Vivliostyle.jsあるいはVFMにその望ましい挙動を実装すればよいかもしれません。<br><br>それができるまでは、スペースとして出力したくないところには改行を入れないで書くようにする必要があります。|
|11:42|![](https://avatars.slack-edge.com/2023-01-24/4689073193331_8c2914ef883b04d806ba_72.png)|Norihiro Kumagai|ご回答ありがとうございます。とりあえず\$を活用させていただきます。<br>vivlistyle.config.jsでスイッチON/OFFがあればありがたいのですが、そういうスイッチ類はあるのでしょうか？|
|16:11|![](https://avatars.slack-edge.com/2023-01-24/4682033437206_950a6c9111216c78d846_72.png)|二日ゆに|回答ありがとうございます。<br>なるほど、これについてはvivliostyle.js本体の実装を待つ必要がある（ないし私がコントリビュートすればいい……？）ということですね。<br>当面の間は、原稿をシェルスクリプトで自動整形して何とかやっていこうと思います。<br><br>リンク先についても確認してみました。<br>一つ勉強になりました。<br><br>わざわざ丁寧にありがとうございます。|
