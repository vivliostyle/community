# 2023-09-07

|Time (UTC)|Icon|Name|Message|
|---|---|---|---|
|06:27|![](https://avatars.slack-edge.com/2018-04-27/354445776386_e258f5ed5ba887b08668_72.jpg)|shinyu|このスタイルシートで問題なところ：<br>```@page {<br>  size: 105mm 148mm;<br>  width: 234pt;<br>  height: 349pt;<br>}<br>@page :left {<br>  margin-top: 16mm;<br>  margin-bottom: 13mm;<br>  margin-left: 11mm;<br>  margin-right: 14mm;<br>}<br>@page :right {<br>  margin-top: 16mm;<br>  margin-bottom: 13mm;<br>  margin-left: 11mm;<br>  margin-right: 14mm;<br>}```<br>`@page` に size でのページサイズの指定と width と height によるページエリアのサイズの指定の両方があります。そして `@page :left` と  `@page :right` にページマージンの指定があります。<br><br>通常ページエリアのサイズは、ページサイズからページマージンを引いたものになります。ところがこのスタイルシートでは、ページマージンの指定だけでなくwidth と height によるページエリアのサイズの指定もあります。ページサイズからページマージンを引いたサイズと明示的に指定されたページエリアのサイズとが一致していない場合、左側と下側のマージンのところで調整されるということが起きます。<br><br>指定されたページエリアの幅 234pt はmm単位だと 82.55mm です。<br>それに対して、ページサイズの幅から左右のマージンを引くと width = 105mm - 14mm - 11mm = 80mm です。2.55mm の差があります。右のマージンがこの分だけ小さくなって右に寄ることになるので左右均等にならないという結果になります。<br><br>`@page` に width、heightを指定する場合はページマージンの左右の少なくとも１つ、上下の少なくとも１つは auto にするようにしてください（ページマージンがすべて auto であれば、センタリングになります）。そうすれば、このような不一致が生じることはありません。<br><br>おそらく`@page` に width、heightを指定したスタイルシートは、Vivliostyle公開サンプルの「ごんぎつね」のスタイルシート、あるいはそれをベースにした旧bunkoテーマなどからのものだと思います。ごんぎつねサンプルのスタイルシート<br><https://github.com/vivliostyle/vivliostyle_doc/blob/gh-pages/samples/gon/style.css><br>では、`@page` に width、heightを指定するとともにページマージンに auto を使っています。ご参考まで。<br><blockquote><pre>@charset "UTF-8";<br>html {<br>  /* 組み方向 */<br>  writing-mode: vertical-rl;<br>  orphans: 1;<br>  widows: 1; }<br><br>* {<br>  margin: 0;<br>  padding: 0; }<br><br>/* タイトル文字列セット */<br>.title {<br>  string-set: title content(); }<br><br>@page {<br>  size: 105mm 148mm;<br>  width: 240pt;<br>  height: 331.5pt;<br>  margin-top: 15mm;<br>  margin-bottom: auto;<br>  margin-left: auto;<br>  margin-right: auto; }<br>@page :left {<br>  @top-left {<br>    /* 左上ノンブル、柱（タイトル文字列） */<br>    content: counter(page) "　　" string(title);<br>    font-size: 6pt;<br>    vertical-align: top;<br>    margin-left: 3.75pt;<br>    margin-top: 6mm;<br>    writing-mode: horizontal-tb; } }<br>@page :right {<br>  @top-right {<br>    /* 右上ノンブル */<br>    content: counter(page);<br>    font-size: 6pt;<br>    vertical-align: top;<br>    margin-right: 3.75pt;<br>    margin-top: 6mm;<br>    writing-mode: horizontal-tb; } }<br>html {<br>  /* フォント */<br>  font-family: "游明朝", "YuMincho", serif;<br>  font-weight: normal;<br>  /* 行末揃え */<br>  text-align: justify;<br>  font-size: 8.5pt;<br>  line-height: 16pt;<br>  /* 約物の調整 */<br>  text-spacing: space-first allow-end; }<br><br>h1 {<br>  /* フォント */<br>  font-weight: bold;<br>  /* フォントサイズ */<br>  font-size: 11.5pt;<br>  /* 字下げ */<br>  text-indent: 0;<br>  /* 直後の改ページ・改段禁止 */<br>  break-after: avoid;<br>  line-height: 48pt;<br>  letter-spacing: 1em; }<br><br>h2 {<br>  /* フォント */<br>  font-weight: normal;<br>  /* フォントサイズ */<br>  font-size: 10pt;<br>  /* 字下げ */<br>  text-indent: 6em;<br>  /* 直後の改ページ・改段禁止 */<br>  break-after: avoid;<br>  line-height: 32pt; }<br><br>ruby > rt {<br>  font-size: 50%; }<br><br>p {<br>  text-indent: 1em;<br>  /* 段落先頭約物の調整、行末句読点ぶら下げあり */<br>  hanging-punctuation: first allow-end; }<br><br>/* 縦中横 */<br>.tcy {<br>  text-combine-upright: all; }<br><br>/* 圏点（ゴマ） */<br>em.sesame_dot {<br>  font-style: normal;<br>  text-emphasis-style: sesame; }<br><br>/* 著作者 */<br>.author {<br>  display: block;<br>  font-size: 8.5pt;<br>  font-weight: bold;<br>  text-align: end; }<br><br>/* 画像＋キャプション */<br>figure {<br>  float-reference: page;<br>  float: top;<br>  width: 236pt;<br>  max-width: 100vw;<br>  height: 254pt;<br>  writing-mode: horizontal-tb; }<br><br>figure > img {<br>  display: block;<br>  width: 100%;<br>  height: auto; }<br><br>figcaption {<br>  text-align: left;<br>  font-size: 7pt;<br>  line-height: 14pt;<br>  margin-bottom: 4pt; }<br><br>/* 奥付 */<br>.colophon {<br>  font-size: 7pt;<br>  margin-block-start: 48pt; }<br><br>/*# sourceMappingURL=style.css.map */<br></pre></blockquote>|
|13:21|![](https://avatars.slack-edge.com/2023-09-06/5867844158657_99e7476a506dc16e6401_72.png)|概念音声2|```@charset "UTF-8";<br>/*<br> * For all media (print, screen)<br> */<br>/* you can import partial SCSS files */<br>/* @import '_variables'; */<br>/* @import '_toc'; */<br>/* ... */<br>html {<br>  writing-mode: vertical-rl;<br>  orphans: 1;<br>  widows: 1;<br>  <br>}<br><br>body {<br>  break-before: left; /* 左ページから開始 */<br>  counter-reset: page 10;<br>}<br><br>* {<br>  margin: 0;<br>  padding: 0;<br>}<br><br>@page :first {<br>  /* FIXME: タイトルと目次のページから逆算してページカウンタを調整 */<br>  counter-reset: page +4;<br>}<br><br>@page {<br>  size: 105mm 148mm;<br>  width: 234pt;<br>  height: 349pt;<br>  font-size: 6pt;<br>  font-family: "游明朝", "YuMincho", serif;<br>  /*marks: crop cross;<br>  bleed: 3mm;*/<br>}<br><br><br>@page :left {<br>  margin-top: 16mm;<br>  margin-bottom: auto;<br>  margin-left: auto;<br>  margin-right: 10.2mm;<br>}<br>@page :right {<br>  margin-top: 16mm;<br>  margin-bottom: auto;<br>  margin-left: 10.2mm;<br>  margin-right: auto;<br>}<br><br><br><br>html {<br>  font-size: 8.5pt;<br>  font-family: "游明朝", "YuMincho", serif;<br>  text-align: justify;<br>  /* 約物の調整、和欧文間スペース */<br>  text-spacing: space-first allow-end ideograph-alpha ideograph-numeric;<br>  line-height: 2;<br>}<br><br>h1 {<br>  font-weight: bold;<br>  font-size: 1.35rem;<br>  break-after: avoid;<br>  line-height: 2rem;<br>  letter-spacing: 0.125em;<br>}<br><br>h2 {<br>  font-weight: normal;<br>  font-size: 1.18rem;<br>  text-indent: 3rem;<br>  break-after: avoid;<br>  line-height: 4rem;<br>}<br><br>ruby &gt; rt {<br>  font-size: 0.5rem;<br>}<br><br>p {<br>  text-indent: 1em;<br>  line-height: 1.8;<br>  /* 段落先頭約物の調整、行末句読点ぶら下げあり */<br>  hanging-punctuation: first allow-end;<br>}<br><br>/* 縦中横 */<br>.tcy {<br>  text-combine-upright: all;<br>}<br><br>.upright {<br>  text-orientation: upright;<br>}<br><br>/* 圏点（ゴマ） */<br>em.sesame_dot {<br>  font-style: normal;<br>  text-emphasis-style: sesame;<br>}<br><br>/* 著者 */<br>.author {<br>  text-align: end;<br>  font-size: 1rem;<br>  font-weight: bold;<br>  letter-spacing: 0.125em;<br>}<br><br>/* hrで改ページ */<br>hr.page-wrap {<br>  break-before: page;<br>  visibility: hidden;<br>  margin: 0px;<br>  padding: 0px;<br>  height: 1px;<br>}<br><br><br>/* and more... 🖋 */<br><br>/*# sourceMappingURL=theme_common.css.map */```<br>ご指摘ありがとうございます。このようにautoを入れるように修正しました。<br>しかし、これを使ってもなお2ページ目が不均衡で、センタリングされているように見えます。<br>どうすれば直りますでしょうか。<br>https://vivliostyle.slack.com/files/U05R53AJS3D/F05QXSZ6FTR/_________.pdf|
|14:08|![](https://avatars.slack-edge.com/2022-07-04/3777085476512_a8d3b37eee1f9c9519dc_72.png)|hidaruma|105mm - 10.2mm * 2 = 84.6mm で、82.55 (234pt)と不一致なのでその差でしょうか|
|14:16|![](https://avatars.slack-edge.com/2022-07-04/3777085476512_a8d3b37eee1f9c9519dc_72.png)|hidaruma|ノドと小口を揃えるのであれば、pageの `width` はそのまま、`margin-left`, `margin-right` は共に `auto`にするのがよいのではないでしょうか|
|15:14|![](https://avatars.slack-edge.com/2023-09-06/5867844158657_99e7476a506dc16e6401_72.png)|概念音声2|厚い本になる予定なので、ノドを広くしたいのです……|
|16:08|![](https://avatars.slack-edge.com/2018-04-27/354445776386_e258f5ed5ba887b08668_72.jpg)|shinyu|そのスタイルシートで、ページエリアが分かりやすいように、<br>```@page { outline: 1px solid cyan; }```<br>を入れて（outline は border と違ってレイアウトに影響はないので、このようにエリアを確認するのに便利です）、見開き表示にしたスクリーンショットを添付します。<br>これを見ると、ノド側のページマージンが指定された値（10.2mm）になって、ページエリアの幅も指定された値（234pt = 82.55mm）、小口側のページマージンはページサイズ幅 105mm からそれらを引いた 12.25mm になってます。指定通りです。<br><br>ただ気になるのは、本文の1ページの行数を数えると15行になってますが、ページエリアの幅が15行分よりも少し大きめなようでページエリア内で左側にアキができていることです。<br><br>スタイルシートを見ると、本文フォントサイズが 8.5pt で p 要素の line-height が 1.8 つまり計算すると 8.5pt * 1.8 = 15.3pt です。ページエリアの幅 234pt を 15.3pt で割って1ページの行数を計算すると 15.29 です。つまり 0.29 行分（4.4pt）だけページエリア幅が大きいのでページエリア内の左側にアキができています。<br>https://vivliostyle.slack.com/files/UAE8V83GA/F05QYQV5JTH/____________________________2023-09-08_0.41.41.png|
|16:13|![](https://avatars.slack-edge.com/2023-09-06/5867844158657_99e7476a506dc16e6401_72.png)|概念音声2|ページエリアを余分な4pt減らした230ptに修正したところきちんと均等に入るようになりました！<br>ご教示誠にありがとうございました。<br>これからwidthを使うときはフォントサイズと行間の幅に気を付けたいと思います。<br>https://vivliostyle.slack.com/files/U05R53AJS3D/F05RAKCCEHK/image.png|
