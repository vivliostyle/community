# 2020-10-19

|Time (UTC)|Icon|Name|Message|
|---|---|---|---|
|07:03|![](https://avatars.slack-edge.com/2019-05-15/624511073651_25909952cd7a069ceed2_72.png)|akabeko|vivliostyle-cli で以下をプレビューしたい場合、<br><br>vivliostyle_doc/ja/vivliostyle-user-group-vol4 at gh-pages · vivliostyle/vivliostyle_doc<br><https://github.com/vivliostyle/vivliostyle_doc/tree/gh-pages/ja/vivliostyle-user-group-vol4><br><br>コマンドを `vivliostyle preview -b ./vivliostyle/ja/vivliostyle-user-group-vol4/artifacts/content/index.html` とするとレイアウトが大きく崩れます。かわりに `vivliostyle preview -b ./vivliostyle/ja/vivliostyle-user-group-vol4/` とした場合は Viewer 左下の進捗が Rendering... のままになり DevTools で確認すると `Failed to load resource: the server responded with a status of 404 (Not Found)`  が 4 件でており `container.xml` などが見つからないようです。<br><br>以上を踏まえて質問です。<br><br>1. このリポジトリーのソースは vivliostyle-cli で直に preview/build 可能でしょうか？<br>2. 可能な場合は vivliostyle-cli へ指定すべきパラメーターを教えてください|
|07:03|![](https://avatars.slack-edge.com/2019-08-21/732685848020_f3f20736795184660348_72.png)|Kiara Translation|🇬🇧: If you want to preview the following in vivliostyle-cli<br><br>vivliostyle_doc / ja / vivliostyle-user-group-vol4 at gh-pages · vivliostyle / vivliostyle_doc<br><https://github.com/vivliostyle/vivliostyle_doc/tree/gh-pages/ja/vivliostyle-user-group-vol4><br><br>If you set the command to `vivliostyle preview -b ./vivliostyle/ja/vivliostyle-user-group-vol4/artifacts/content/index.html`, the layout will be greatly corrupted. If you set `vivliostyle preview -b ./vivliostyle/ja/vivliostyle-user-group-vol4/` instead, the progress at the bottom left of the Viewer will remain Rendering ... and you can check it with DevTools` Failed to load resource: the There are 4 server responded with a status of 404 (Not Found) `and it seems that` container.xml` etc. cannot be found.<br><br>Based on the above, I have a question.<br><br>1. Is the source of this repository available for preview / build directly with vivliostyle-cli?<br>2. What parameters should I specify for vivliostyle-cli if possible?|
|07:03|![](https://avatars.slack-edge.com/2019-08-21/732685848020_f3f20736795184660348_72.png)|Kiara Translation|🇬🇧: If you want to preview the following in vivliostyle-cli<br><br>vivliostyle_doc / ja / vivliostyle-user-group-vol4 at gh-pages · vivliostyle / vivliostyle_doc<br><https://github.com/vivliostyle/vivliostyle_doc/tree/gh-pages/ja/vivliostyle-user-group-vol4><br><br>If you set the command to `vivliostyle preview -b ./vivliostyle/ja/vivliostyle-user-group-vol4/artifacts/content/index.html`, the layout will be greatly corrupted. If you set `vivliostyle preview -b ./vivliostyle/ja/vivliostyle-user-group-vol4/` instead, the progress at the bottom left of the Viewer will remain Rendering ... and you can check it with DevTools` Failed to load resource: the There are 4 server responded with a status of 404 (Not Found) `and it seems that` container.xml` etc. cannot be found.<br><br>Based on the above, I have a question.<br><br>1. Is the source of this repository available for preview / build directly with vivliostyle-cli?<br>2. What parameters should I specify for vivliostyle-cli if possible?|
|07:19|![](https://avatars.slack-edge.com/2018-04-27/354445776386_e258f5ed5ba887b08668_72.jpg)|shinyu|<blockquote>コマンドを `vivliostyle preview -b ./vivliostyle/ja/vivliostyle-user-group-vol4/artifacts/content/index.html` とするとレイアウトが大きく崩れます。</blockquote>この理由は vivliostyle CLI の `--root` オプションのデフォルトが次のようになっているためです。<br>```  -r, --root &lt;root_directory&gt;   specify assets root path (default directory of input file)<pre>次のように指定するとよいです:</pre>vivliostyle preview -r . -b ./vivliostyle_doc/ja/vivliostyle-user-group-vol4/artifacts/content/index.html <pre>あるいは</pre>vivliostyle preview -b ./vivliostyle_doc/ja/vivliostyle-user-group-vol4/manifest.json```<br>でもよいです。<br>ファイル名（index.html や manifest.json）を指定していないと、bookModeの場合、EPUBだと仮定して、EPUBに必須のファイル "META-INF/container.xml" をロードしようとします。だから、"404 (Not Found)" になります。|
|07:19|![](https://avatars.slack-edge.com/2019-08-21/732685848020_f3f20736795184660348_72.png)|Kiara Translation|🇬🇧: If you set the &amp; gt; command to `vivliostyle preview -b ./vivliostyle/ja/vivliostyle-user-group-vol4/artifacts/content/index.html`, the layout will be greatly corrupted.<br>The reason for this is that the vivliostyle CLI's `--root` option defaults to:<br>`` `-r, --root &amp; lt; root_directory &amp; gt; specify assets root path (default directory of input file) ``` `<br>You can specify it as follows:<br>`` `vivliostyle preview -r. -b ./vivliostyle_doc/en/vivliostyle-user-group-vol4/artifacts/content/index.html` ``<br>Or<br>`` `vivliostyle preview -b ./vivliostyle_doc/ja/vivliostyle-user-group-vol4/manifest.json```<br>But it's okay.<br>If you don't specify a file name (index.html or manifest.json), bookMode will assume EPUB and try to load the required file "META-INF / container.xml" for EPUB. So it's a "404 (Not Found)".|
|07:23|![](https://avatars.slack-edge.com/2019-05-15/624511073651_25909952cd7a069ceed2_72.png)|akabeko|`@shinyu` ありがとうございます。提示された方法で正常に表示されることを確認できました。方法としては `manifest.json` を採用したいと思います。|
|07:23|![](https://avatars.slack-edge.com/2019-08-21/732685848020_f3f20736795184660348_72.png)|Kiara Translation|🇬🇧:  Thank you very much. I was able to confirm that it was displayed normally by the method presented. I would like to use `manifest.json` as the method.|
|07:23|![](https://avatars.slack-edge.com/2019-05-15/624511073651_25909952cd7a069ceed2_72.png)|akabeko|↑ファイル名を直に指定する方法、ですね。|
|07:23|![](https://avatars.slack-edge.com/2019-08-21/732685848020_f3f20736795184660348_72.png)|Kiara Translation|🇬🇧: ↑ How to specify the file name directly, isn't it?|
|07:32|![](https://avatars.slack-edge.com/2019-05-15/624511073651_25909952cd7a069ceed2_72.png)|akabeko|もう一つ質問です。vivliostyle-cli の `-b --book` パラメーターですが、これを単一 HTML で完結しているコンテンツに対して指定することは何か副作用がありますか？例えば <https://github.com/vivliostyle/vivliostyle_doc/tree/gh-pages/samples/gutenberg/Alice.html> に対してこのパラメーターの有無を比較したところ、特に動作の違いはなさそうです。<br><br>Viewer でこれは Book に対応しており未指定なら Document になると想定しているのですが、UI の補足説明で Document 側だけ XHTML 単体ファイルに言及しているので、この場合だけ Book だと動作に問題があったりするのでしょうか？|
|07:32|![](https://avatars.slack-edge.com/2019-08-21/732685848020_f3f20736795184660348_72.png)|Kiara Translation|🇬🇧: Another question. The `-b --book` parameter of vivliostyle-cli, is there any side effect of specifying this for content that is complete in a single HTML? For example, comparing the presence or absence of this parameter with <https://github.com/vivliostyle/vivliostyle_doc/tree/gh-pages/samples/gutenberg/Alice.html>, there seems to be no particular difference in behavior.<br><br>In Viewer, this corresponds to Book and it is assumed that it will be Document if it is not specified, but since the supplementary explanation of the UI mentions the XHTML single file only on the Document side, it works only in this case Is there a problem?|
|07:35|![](https://avatars.slack-edge.com/2018-04-27/354445776386_e258f5ed5ba887b08668_72.jpg)|shinyu|index.htmlが深い階層にできるのはVivliostyle CLI 3.0-pre.x で生成されるディレクトリ構造のためですが、それは直したいと思っています。<br><https://www.w3.org/TR/lpf/#sec-structure><br>これに準拠する形式にして index.html と publication.json が同じところにできるように。<br><blockquote>This section is non-normative.</blockquote>|
|07:35|![](https://avatars.slack-edge.com/2019-08-21/732685848020_f3f20736795184660348_72.png)|Kiara Translation|🇬🇧: The deep hierarchy of index.html is due to the directory structure generated by the Vivliostyle CLI 3.0-pre.x, which I would like to fix.<br><https://www.w3.org/TR/lpf/#sec-structure><br>Make index.html and publication.json the same place in a format that conforms to this.|
|07:43|![](https://avatars.slack-edge.com/2018-04-27/354445776386_e258f5ed5ba887b08668_72.jpg)|shinyu|単体HTML内でnav要素が使われていてその中に他のHTMLファイルへのリンクがある場合、bookModeだとそれらもロードします。単体HTMLだけをロードしたい場合は bookMode=false にする必要があります。<br><br>最新のvivliostyle coreではnavからのリンクが相対URLのみこの動作にするように修正したので改善したのですが、その修正の前は、外部サイトまでロードしようとしてたいていエラーになってました。|
|07:43|![](https://avatars.slack-edge.com/2019-08-21/732685848020_f3f20736795184660348_72.png)|Kiara Translation|🇬🇧: If nav elements are used in a single HTML and there are links to other HTML files in it, bookMode will also load them. If you want to load only plain HTML, you need to set bookMode = false.<br><br>In the latest vivliostyle core, I fixed it so that the link from nav only works with relative URL, so I improved it, but before that fix, I usually got an error when trying to load to an external site.|
|07:45|![](https://avatars.slack-edge.com/2019-05-15/624511073651_25909952cd7a069ceed2_72.png)|akabeko|ありがとうございます。cli は最新 (v2.1.0) なので修正反映されていそうですが、動作の違いについては意識しておきます。|
|07:45|![](https://avatars.slack-edge.com/2019-08-21/732685848020_f3f20736795184660348_72.png)|Kiara Translation|🇬🇧: Thank you very much. Since cli is the latest (v2.1.0), it seems that the correction is reflected, but be aware of the difference in operation.|
|07:51|![](https://avatars.slack-edge.com/2018-04-27/354445776386_e258f5ed5ba887b08668_72.jpg)|shinyu|<https://github.com/vivliostyle/vivliostyle.js/issues/657> の修正で core の 2.1.2-pre.1 (2020-09-24) から反映されてます。次のバージョンになってるならOKです:<br>```$ vivliostyle --version<br>cli: 2.1.0<br>core: 2.1.3```<br><blockquote>*Describe the bug*<br><br>With `bookMode=true`, when TOC (e.g., the `&lt;nav&gt;` element) has links to external site, the CORS error occurs:<br><br><blockquote>"Received an empty response for https://.... This may be caused by the server not allowing cross-origin resource sharing (CORS)."</blockquote>*To Reproduce*<br><br>Test Vivliostyle Viewer with  <br><https://vivliostyle.org/viewer/#src=https://vivliostyle.org/&amp;bookMode=true&amp;renderAllPages=false|https://vivliostyle.org/viewer/#src=https://vivliostyle.org/&amp;bookMode=true&amp;renderAllPages=false><br><br>*Expected behavior*<br><br>In the Book Mode, multiple web pages in a site are expected to be loaded consecutively by the links in the TOC, but external sites should be excluded.<br><br>*Screenshots*  <br><https://user-images.githubusercontent.com/3324737/94020073-77f76580-fded-11ea-9f0d-f740a41d7e63.png|Screen Shot 2020-09-23 22 10 41></blockquote>|
|07:51|![](https://avatars.slack-edge.com/2019-08-21/732685848020_f3f20736795184660348_72.png)|Kiara Translation|🇬🇧: It is reflected from 2.1.2-pre.1 (2020-09-24) of core by the modification of <https://github.com/vivliostyle/vivliostyle.js/issues/657>. OK if it's the next version:<br>`` `$ vivliostyle --version<br>cli: 2.1.0<br>core: 2.1.3```|
|07:57|![](https://avatars.slack-edge.com/2019-05-15/624511073651_25909952cd7a069ceed2_72.png)|akabeko|利用しているものをバージョン出力してみたら、↑でした。よって修正が反映されている版ですね。|
|07:57|![](https://avatars.slack-edge.com/2019-08-21/732685848020_f3f20736795184660348_72.png)|Kiara Translation|🇬🇧: When I tried to output the version of what I was using, it was ↑. Therefore, it is the version that reflects the correction.|
|08:01|![](https://avatars.slack-edge.com/2018-04-27/354445776386_e258f5ed5ba887b08668_72.jpg)|shinyu|```  "dependencies": {<br>    "@vivliostyle/core": "^2.1.1",```<br>なので、インストールしたときの2.x.x の最新になってるのでしょう|
|08:01|![](https://avatars.slack-edge.com/2019-08-21/732685848020_f3f20736795184660348_72.png)|Kiara Translation|🇬🇧: `` `" dependencies ": {<br>    "@ vivliostyle / core": "^ 2.1.1", `` `<br>So it's probably the latest version of 2.x.x when installed|
