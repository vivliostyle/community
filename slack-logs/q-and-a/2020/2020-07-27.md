# 2020-07-27

|Time (UTC)|Icon|Name|Message|
|---|---|---|---|
|07:29|![](https://secure.gravatar.com/avatar/698cc14290c3976fdd9f0a23494b87c1.jpg?s=72&d=https%3A%2F%2Fa.slack-edge.com%2Fdf10d%2Fimg%2Favatars%2Fava_0012-72.png)|田嶋　淳|どうもChromeの仕様変更の影響らしく、過去に公開したVivliostyleを使ってMacでEPUBを展開してChrome上に表示させるMac用スクリプトが動かなくなっていました。ローカルのファイルをコマンドラインで投げるのはセキュリティ的に問題があるというような話なのでしょうか。なお、表示させるブラウザをSafariに変更すれば問題なく表示されました。また、Safariで表示させたあとURLをコピーしてChromeにペーストすればChromeでの表示もOKでした。Vivliostyle側の問題ではないとは思いますが一応ご報告まで。<br><https://vivliostyle.github.io/vivliostyle_doc/ja/vivliostyle-user-group-vol2/JunTajima/index.html?fbclid=IwAR0m9Hj1768Nt9H-ZZUjHKoY_wZOknXmGTPSR4A9OJH41xd7rZJUrKuk3lM>|
|07:29|![](https://avatars.slack-edge.com/2019-08-21/732685848020_f3f20736795184660348_72.png)|Kiara Translation|🇬🇧: Apparently due to the change in Chrome specifications, the script for Mac that expands EPUB on Mac using Vivliostyle released in the past and displays it on Chrome stopped working. Is throwing a local file on the command line a security issue? If you change the browser to display to Safari, it was displayed without problems. Also, if you display it in Safari, copy the URL and paste it in Chrome, the display in Chrome was also OK. I don't think it's a problem on the Vivliostyle side, but I'll let you know.<br><https://vivliostyle.github.io/vivliostyle_doc/ja/vivliostyle-user-group-vol2/JunTajima/index.html?fbclid=IwAR0m9Hj1768Nt9H-ZZUjHKoY_wZOknXmGTPSR4A9OJH41xd7rZJUrKuk3lM>|
|10:07|![](https://avatars.slack-edge.com/2018-04-27/354445776386_e258f5ed5ba887b08668_72.jpg)|shinyu|こちらでそのperlスクリプトを試してみました。<br><https://github.com/JunTajima/epubVivliostylePreview.pl/blob/master/epubVivliostylePreview.pl><br><br>はじめうまく行かなかったのですが、このスクリプトの26行目<br><https://github.com/JunTajima/epubVivliostylePreview.pl/blob/5b1a9eecd20eb495993e691d7a6850fc35e3c3ac/epubVivliostylePreview.pl#L26><br><br>でdateコマンド実行の結果を変数 $datetimenow に入れるところで行末の改行文字が入ってしまい、それがVivliostyleのURLを作るところに入ってしまうために正常に動かなくなっていることが分かったので、次のようにchomp関数を使って変数 $datetimenow の末尾から改行文字を削除するようにしました：<br>```chomp(my $datetimenow = `$getDateTimeNowCommand`);```<br>この結果、Chromeで正常に動くようになりました。<br><br>なお、Vivliostyleのバージョンは 2019.8.101 で試しました。<br>v2.0.0以降（最新リリース版は v2.1.1）では、viewerのHTMLファイル名が、以前の “/viewer/vivliostyle-viewer.html” から “/viewer/index.html” （“index.html” は省略して “/viewer/” だけでOK）に変わったので、このperlスクリプトの43行目の修正が必要です。<br><blockquote>[JunTajima/epubVivliostylePreview.pl] epubVivliostylePreview.pl</blockquote><br><blockquote>[JunTajima/epubVivliostylePreview.pl] epubVivliostylePreview.pl:26</blockquote>|
|10:07|![](https://avatars.slack-edge.com/2019-08-21/732685848020_f3f20736795184660348_72.png)|Kiara Translation|🇬🇧: I tried the perl script here.<br><https://github.com/JunTajima/epubVivliostylePreview.pl/blob/master/epubVivliostylePreview.pl><br><br>It didn't work at first, but line 26 of this script<br><https://github.com/JunTajima/epubVivliostylePreview.pl/blob/5b1a9eecd20eb495993e691d7a6850fc35e3c3ac/epubVivliostylePreview.pl#L26><br><br>I found that when I put the result of executing the date command in the variable $datetimenow, there was a newline character at the end of the line, and it came into the place where the URL of Vivliostyle is made, so I found that it did not work properly, so the following I used the chomp function to remove the newline character from the end of the variable $datetimenow:<br>```chomp(my $datetimenow = `$getDateTimeNowCommand`);```<br>As a result, it works fine in Chrome.<br><br>I tried the version of Vivliostyle on 2019.8.101.<br>In v2.0.0 or later (v2.1.1 is the latest release version), the HTML file name of the viewer is changed from the previous “/viewer/vivliostyle-viewer.html” to “/viewer/index.html” (“index.html” is I omitted it and changed it to “/viewer/” only), so the line 43 of this perl script needs to be modified.|
