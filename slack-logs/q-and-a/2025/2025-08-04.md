# 2025-08-04

|Time (UTC)|Icon|Name|Message|
|---|---|---|---|
|07:01|![](https://avatars.slack-edge.com/2022-08-21/3992344751120_5c9be0c9169540de7e40_72.jpg)|信国幸彦|`@shinyu` さん、ありがとうございます。<br><br>orphans: 1, widows: 1; は設定してありました。<br><br>左右マージンの値を各0.0875mmずつ小さくしたら、どのページも19行入るようになりました。おかげさまで落着です。<br><br>ただ、<br>• 元のマージンの値のままでも19行入るページもあるのは不思議なことではないのか<br>• 各0.0875mmというのは「ほんの少し」という範囲だといっていいのだろうか<br>というのが若干ひっかかってます。|
|07:44|![](https://avatars.slack-edge.com/2018-04-27/354445776386_e258f5ed5ba887b08668_72.jpg)|shinyu|元のマージンの値で19行入る行と18行しか入らない行があってページエリアを約0.2mm広げたら全部19行入るようになったということは、0.1〜0.2mmくらい行送りを増やす要因が何かあると考えられますね。<br><br>添付されたPDFでは、18行しか入らなかったページp.8の次のページがないため、調べられません。p.9を見せていただけると何か分かるかもしれません。|
|08:00|![](https://avatars.slack-edge.com/2022-08-21/3992344751120_5c9be0c9169540de7e40_72.jpg)|信国幸彦|19行目に何か太る要因があるのかもしれないということですね。<br><br>p. 8に18行しか入らないときのpp. 8-9を貼り付けます。何かありそうでしょうか。<br>https://vivliostyle.slack.com/files/UAE8V83GA/F098UEJL11S/pp08-09.pdf|
|14:49|![](https://avatars.slack-edge.com/2018-04-27/354445776386_e258f5ed5ba887b08668_72.jpg)|shinyu|原因は以下です。<br>• Chromiumでは行送りの精度が(1/64)pxであり、Vivliostyle.jsでは8倍の精度にして処理しているので、line-heightに指定した値をpx単位にしたものを(1/512)pxの倍数になるように丸めた値が実際の行送りになる。line-height: 23.5Qの場合、23.5Qは22.2047pxだが、これを512倍にして四捨五入して512で割ると22.2051pxとなる。19行にすると421.8969px=111*.*6269mmです。これは誤差がない場合の23.5Q * 19 = 446.5Q = 111.625mm よりもほんの少し大きいです。<br>• 注番号の参照（「（25）」など）で、font-sizeを小さくしてます。line-heightは本文と同じ23.5Qのままの場合、行の前後に付く半行間が僅かに大きくなって行送り量が増える場合があります。font-sizeを変えているspanにはline-height:1を指定するなどするとこの問題を避けられます。<br>• いまのVivliostyle.jsのページ分割処理では、段落の途中で改ページするときは行間のアキの分が少しページエリアからはみだしても許容されます。しかし、段落と段落の間での場合は、完全にページエリア内に収まる必要があります。19行入る場合と18行しか入らない場合とが生じたのはこのためです。|
