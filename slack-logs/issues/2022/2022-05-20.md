# 2022-05-20

|Time (UTC)|Icon|Name|Message|
|---|---|---|---|
|02:49|![](https://avatars.slack-edge.com/2018-04-27/354445776386_e258f5ed5ba887b08668_72.jpg)|shinyu|だいたい問題が分かりました。今日中に修正できると思います。<br><https://github.com/vivliostyle/vivliostyle-cli/issues/285><br><blockquote>When 500 pages document processed on GitHub Actions instance, vivliostyle-cli crashes.  <br>Reproduce repository is following.  <br><https://github.com/ttrace/autobuild/runs/6481383049?check_suite_focus=true|https://github.com/ttrace/autobuild/runs/6481383049?check_suite_focus=true><br><br>Reproduction process<br><br>1. Clone repository<br>2. Add tag galley-[unique token]<br>3. GitHub Actions starts to produce PDF<br>4. vivliostyle-cli crashes with following error.<br><br>However project set -t as 600 seconds, but vivliostyle-cli returns timeout error as 30000ms (as error message).<br><br>Basically, the processing of vivliostyle-cli is further slower than expected.  <br>When the same html is processed with preview argument, user will see the first page in 10 seconds on Chromium and the processing time of saving whole pages in PDF is 30 seconds. But cli spends 10 minutes or longer.<br><br><pre>Run npx vivliostyle build -t 600 publish/buildHtml.html -o publish/refs/tags/galley-TEST.pdf<br>[4](<https://github.com/ttrace/Second-Opening/runs/6480736064?check_suite_focus=true#step:11:5>)<br>- Collecting build config<br>[5](<https://github.com/ttrace/Second-Opening/runs/6480736064?check_suite_focus=true#step:11:6>)<br>- Building PDF<br>[6](<https://github.com/ttrace/Second-Opening/runs/6480736064?check_suite_focus=true#step:11:7>)<br>TimeoutError: waiting for Page.printToPDF failed: timeout 30000ms exceeded<br>[7](<https://github.com/ttrace/Second-Opening/runs/6480736064?check_suite_focus=true#step:11:8>)<br><br>[8](<https://github.com/ttrace/Second-Opening/runs/6480736064?check_suite_focus=true#step:11:9>)<br>    at Object.waitWithTimeout (/Users/runner/work/Second-Opening/Second-Opening/node_modules/puppeteer-core/lib/cjs/puppeteer/common/helper.js:224:26)<br>[9](<https://github.com/ttrace/Second-Opening/runs/6480736064?check_suite_focus=true#step:11:10>)<br>If you think this is a bug, please report at <https://github.com/vivliostyle/vivliostyle-cli/issues><br>[10](<https://github.com/ttrace/Second-Opening/runs/6480736064?check_suite_focus=true#step:11:11>)<br>    at Page.createPDFStream (/Users/runner/work/Second-Opening/Second-Opening/node_modules/puppeteer-core/lib/cjs/puppeteer/common/Page.js:2091:49)<br>[11](<https://github.com/ttrace/Second-Opening/runs/6480736064?check_suite_focus=true#step:11:12>)<br>    at Page.pdf (/Users/runner/work/Second-Opening/Second-Opening/node_modules/puppeteer-core/lib/cjs/puppeteer/common/Page.js:2103:37)<br>[12](<https://github.com/ttrace/Second-Opening/runs/6480736064?check_suite_focus=true#step:11:13>)<br>    at Object.buildPDF (/Users/runner/work/Second-Opening/Second-Opening/node_modules/@vivliostyle/cli/dist/pdf.js:171:28)<br>[13](<https://github.com/ttrace/Second-Opening/runs/6480736064?check_suite_focus=true#step:11:14>)<br>    at runMicrotasks (&lt;anonymous&gt;)<br>[14](<https://github.com/ttrace/Second-Opening/runs/6480736064?check_suite_focus=true#step:11:15>)<br>    at processTicksAndRejections (internal/process/task_queues.js:97:5)<br>[15](<https://github.com/ttrace/Second-Opening/runs/6480736064?check_suite_focus=true#step:11:16>)<br>    at async build (/Users/runner/work/Second-Opening/Second-Opening/node_modules/@vivliostyle/cli/dist/commands/build.js:93:26)<br>[16](<https://github.com/ttrace/Second-Opening/runs/6480736064?check_suite_focus=true#step:11:17>)<br>Error: Process completed with exit code 1.<br></pre></blockquote>|
|02:49|![](https://avatars.slack-edge.com/2021-08-02/2324149410423_2aa7423c4133ecb9f168_72.png)|Kiara : Translation 100+ Languages|🇬🇧: I found the problem. I think we can fix it by the end of today.<br><https://github.com/vivliostyle/vivliostyle-cli/issues/285><br><blockquote>When 500 pages document processed on GitHub Actions instance, vivliostyle-cli crashes. Reproduce repository is following. <https://github.com/ttrace/autobuild/runs/6481383049?check_suite_focus=true> ...</blockquote>|
|06:15|![](https://secure.gravatar.com/avatar/071ca54af656223d6d39098e0598e777.jpg?s=72&d=https%3A%2F%2Fa.slack-edge.com%2Fdf10d%2Fimg%2Favatars%2Fava_0022-72.png)|藤井太洋|おおっ、ありがとうございます！|
|06:15|![](https://avatars.slack-edge.com/2021-08-02/2324149410423_2aa7423c4133ecb9f168_72.png)|Kiara : Translation 100+ Languages|🇬🇧: Oh, thank you!|
|17:29|![](https://avatars.slack-edge.com/2018-04-27/354445776386_e258f5ed5ba887b08668_72.jpg)|shinyu|修正できました。<br><https://github.com/vivliostyle/vivliostyle-cli/issues/285#issuecomment-1133143894><br><blockquote>Vivliostyle.js (core+viewer)側の修正：<br><br>• <https://github.com/vivliostyle/vivliostyle.js/pull/925|vivliostyle/vivliostyle.js#925><br><br>これを組み込んだVivliostyle CLI開発版をテストして、問題が解決したこと確認しました（いつまでも終了しなかったのが、2分半で正常に終了）：<br><br><pre>$ time dist/cli.js build ../ttrace/autobuild/publish/buildHtml.html -o output-fix924.pdf -t 600<br>⊙ Processing PDF<br>output-fix924.pdf has been created.<br>🎉 Built successfully.<br><br>real    2m32.956s<br>user    0m8.766s<br>sys     0m2.571s<br></pre><br><br>この修正を入れた Vivliostyle.js v2.15.2 ＋ Vivliostyle CLI v4.12.2 をこのあとリリースします。</blockquote>|
|17:29|![](https://avatars.slack-edge.com/2021-08-02/2324149410423_2aa7423c4133ecb9f168_72.png)|Kiara : Translation 100+ Languages|🇬🇧: I was able to fix it.<br><https://github.com/vivliostyle/vivliostyle-cli/issues/285#issuecomment-1133143894>|
