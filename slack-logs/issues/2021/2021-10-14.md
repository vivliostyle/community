# 2021-10-14

|Time (UTC)|Icon|Name|Message|
|---|---|---|---|
|06:52|![](https://avatars.slack-edge.com/2018-04-27/354445776386_e258f5ed5ba887b08668_72.jpg)|shinyu|<https://github.com/vivliostyle/vivliostyle.js/issues/791><br>この数日このバグを調べています。欧文でハイフネーションが有効の場合に、段落の途中での改ページ箇所で、ページの下に単語がひとつだけはみ出してしまうなど、困った問題です。さらに、Viewerでの表示では正常で、PDF出力するとこの問題が起きるという場合もあります。これでは組版ソフトとしてまともに使えないので、なんとかしたい。<br><blockquote>When hyphenation is enabled (`hyphens: auto`), text overflow occurs at bottom of page occasionally.<br><br>This problem is reproducible in Vivliostyle Viewer with Google Chrome or Chromium, but not with Safari or Firefox. Also the problem appears in the output PDF (print with Vivliostyle Viewer, or with Vivliostyle CLI), and in some cases, the results are different between the viewer (screen) and output PDF (see *Test case 2*).<br><br>*Test case 1:* <https://github.com/vivliostyle/vivliostyle_doc/blob/gh-pages/samples/gutenberg/Fang.html|https://github.com/vivliostyle/vivliostyle_doc/blob/gh-pages/samples/gutenberg/Fang.html><br><br>View with Vivliostyle Viewer, page size: a5: <https://vivliostyle.org/viewer/#src=https://vivliostyle.github.io/vivliostyle_doc/samples/gutenberg/Fang.html&amp;bookMode=true&amp;userStyle=data:,/*%3Cviewer%3E*/%0A@page%20%7B%20size:%20a5;%20%7D%0A/*%3C/viewer%3E*/|https://vivliostyle.org/viewer/#src=https://vivliostyle.github.io/vivliostyle_doc/samples/gutenberg/Fang.html&amp;bookMode=true&amp;userStyle=data:,/*%3Cviewer%3E*/%0A@page%20%7B%20size:%20a5;%20%7D%0A/*%3C/viewer%3E*/><br><br>Output PDF (with Vivliostyle CLI v4.3.0, core 2.11.1): <https://github.com/vivliostyle/vivliostyle.js/files/7331734/Fang-a5.pdf|Fang-a5.pdf><br><br>Problem:<br><br>• p.8, at bottom of page, "bodi-" (hyphenated as "bodies"→"bodi-es") should be at the end of the last line, but it overflows. (Same problem is found in pages 94, 182, 183, and 306.)<br>    <br>    <https://user-images.githubusercontent.com/3324737/137049506-d14986d3-d207-4e06-93d2-6f0b58576dfb.png|Screen Shot 2021-10-13 at 10 03 11><br><br>*Test case 2*: <https://github.com/vivliostyle/vivliostyle_doc/blob/gh-pages/samples/gutenberg/Alice.html|https://github.com/vivliostyle/vivliostyle_doc/blob/gh-pages/samples/gutenberg/Alice.html><br><br>View with Vivliostyle Viewer, page size: a5: <https://vivliostyle.org/viewer/#src=https://vivliostyle.github.io/vivliostyle_doc/samples/gutenberg/Alice.html&amp;bookMode=true&amp;userStyle=data:,/*%3Cviewer%3E*/%0A@page%20%7B%20size:%20a5;%20%7D%0A/*%3C/viewer%3E*/|https://vivliostyle.org/viewer/#src=https://vivliostyle.github.io/vivliostyle_doc/samples/gutenberg/Alice.html&amp;bookMode=true&amp;userStyle=data:,/*%3Cviewer%3E*/%0A@page%20%7B%20size:%20a5;%20%7D%0A/*%3C/viewer%3E*/><br><br>Output PDF (with Vivliostyle CLI v4.3.0, core 2.11.1): <https://github.com/vivliostyle/vivliostyle.js/files/7333997/Alice-a5.pdf|Alice-a5.pdf><br><br>Problem:<br><br>• p.33, the result in viewer is good, but the result in output PDF is different: the last word in this page "me," should be at the end of the last line, but it overflows. There is a difference in hyphenation in viewer and output PDF. (Similar problem is found in p.56.)<br>    <br>    <https://user-images.githubusercontent.com/3324737/137051777-020dc29f-32fa-4462-b7c7-6dbf1cda5f49.png|Screen Shot 2021-10-13 at 10 28 18><br><br>* * *<br><br>This problem was first reported as a Vivliostyle CLI issue <https://github.com/vivliostyle/vivliostyle-cli/issues/223|vivliostyle/vivliostyle-cli#223> by <https://github.com/Iacobus1983|@Iacobus1983>, thanks.</blockquote>|
|06:52|![](https://avatars.slack-edge.com/2021-08-02/2324149410423_2aa7423c4133ecb9f168_72.png)|Kiara : Translation 100+ Languages|🇬🇧: <https://github.com/vivliostyle/vivliostyle.js/issues/791><br>I've been investigating this bug for the last few days. When hyphenation is enabled in European languages, there is a problem that only one word extends out at the bottom of the page at the page break in the middle of the paragraph. In addition, the display in the Viewer is normal, and this problem may occur when outputting to PDF. This cannot be used properly as typesetting software, so I'd like to do something about it.|
|08:41|![](https://avatars.slack-edge.com/2020-10-24/1474758134528_58d03798bcb64d811fc4_72.jpg)|Ayumu Takai|Test Case2のほうだけ2値化してみたのですが、僅かにcu-の右端が他の行より右に出ているのですね。<br>アンチエイリアスで見えにくくなっているので、ここにも小数点以下のせめぎあいがありそうです。<br>https://vivliostyle.slack.com/files/U01D90BR491/F02HRPJHKGS/____________________________2021-10-14_17.38.50.png|
|08:41|![](https://avatars.slack-edge.com/2021-08-02/2324149410423_2aa7423c4133ecb9f168_72.png)|Kiara : Translation 100+ Languages|🇬🇧: I tried binarizing only Test Case2, but the right end of cu- is slightly to the right of the other lines, isn't it?<br>Since it is hard to see due to antialiasing, there seems to be a conflict after the decimal point here as well.|
|13:49|![](https://avatars.slack-edge.com/2018-04-27/354445776386_e258f5ed5ba887b08668_72.jpg)|shinyu|Case 1 と Case 2 をそれぞれ別のissueにしました<br><br><https://github.com/vivliostyle/vivliostyle.js/issues/792><br><https://github.com/vivliostyle/vivliostyle.js/issues/793><br><br>Case 1 (792) のほうのバグはすぐ直せそうです。Case 2はChromiumの画面表示と印刷のときとでハイフネーションが変わることがあるという問題のようです。Vivliostyleでのページ分割などレイアウト処理はブラウザの画面表示のレンダリングを利用しているので、印刷のときにハイフネーションでの行の折り返しの位置が変わってしまったりすると、印刷のときだけレイアウトが崩れることになります。（preview で確認してOKでもPDF出力すると崩れてしまう）<br><br>日本語の場合の <https://github.com/vivliostyle/vivliostyle.js/issues/758> の問題と似ています。|
|13:49|![](https://avatars.slack-edge.com/2021-08-02/2324149410423_2aa7423c4133ecb9f168_72.png)|Kiara : Translation 100+ Languages|🇬🇧: Made Case 1 and Case 2 separate issues<br><br><https://github.com/vivliostyle/vivliostyle.js/issues/792><br><https://github.com/vivliostyle/vivliostyle.js/issues/793><br><br>The bug in Case 1 (792) seems to be fixed soon. Case 2 seems to be a problem that hyphenation may change between Chromium screen display and printing. Layout processing such as page break in Vivliostyle uses rendering of the screen display of the browser, so if the position of line wrapping in hyphenation changes during printing, the layout will collapse only when printing. Become. (Even if you check with preview and OK, it will collapse if you output to PDF)<br><br>Similar to the <https://github.com/vivliostyle/vivliostyle.js/issues/758> issue in Japanese.|
